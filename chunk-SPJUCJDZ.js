import{a as G,b as H,c as Q}from"./chunk-66MR4OIR.js";import{a as le}from"./chunk-X2FLUBUD.js";import{a as ce,b as se}from"./chunk-SWAWC44T.js";import{a as q}from"./chunk-ZKCIQJRL.js";import{b as te,g as ie,h as ne,j as oe,k as ae,l as re,m as de}from"./chunk-QKM7KKRN.js";import{B as Z,D as ee,u as X,z as Y}from"./chunk-2N6EGSYQ.js";import{K as $,h as z}from"./chunk-N2EBPQD7.js";import{a as F,c as L,d as R}from"./chunk-7BHHVVNY.js";import{$a as p,Gd as A,Hb as o,Ib as u,Id as W,Jb as x,Kd as J,Lb as y,Ma as r,Mb as S,Md as K,Nb as w,Nd as U,Qa as f,Qb as M,Tb as b,Ub as k,Vb as E,Xa as O,gb as v,lb as c,nc as I,ob as P,pa as C,pb as D,qa as _,qb as n,rb as i,rc as T,sb as j,sc as V,tc as B,ub as h,uc as N,wb as g,xb as l}from"./chunk-ONE5RFGK.js";var pe=t=>["/identity",t],Ce=t=>({"expired-date":t}),_e=(t,a)=>a.key;function xe(t,a){if(t&1){let e=h();n(0,"button",34),g("click",function(){C(e);let d=l(2);return _(d.revokeCredential())}),n(1,"mat-icon"),o(2,"cancel"),i(),o(3," Revoke "),i()}}function ge(t,a){if(t&1&&(n(0,"h1"),o(1),i()),t&2){let e=l(2);r(),u(e.credential.name)}}function fe(t,a){if(t&1){let e=h();n(0,"mat-form-field",13)(1,"mat-label"),o(2,"Name"),i(),n(3,"input",35),w("ngModelChange",function(d){C(e);let m=l(2);return S(m.editedName,d)||(m.editedName=d),_(d)}),i()()}if(t&2){let e=l(2);r(3),y("ngModel",e.editedName)}}function ve(t,a){if(t&1&&(n(0,"p",22),o(1),i()),t&2){let e=l(2);r(),x(" ",e.credential.description||"No description provided"," ")}}function he(t,a){if(t&1){let e=h();n(0,"mat-form-field",23)(1,"mat-label"),o(2,"Description"),i(),n(3,"textarea",36),w("ngModelChange",function(d){C(e);let m=l(2);return S(m.editedDescription,d)||(m.editedDescription=d),_(d)}),i()()}if(t&2){let e=l(2);r(3),y("ngModel",e.editedDescription)}}function be(t,a){if(t&1&&(n(0,"div",24)(1,"mat-icon"),o(2,"account_circle"),i(),n(3,"span"),o(4),i()()),t&2){let e=l(2);v("routerLink",M(2,pe,e.credential.issuer)),r(4),u(e.issuer.name)}}function Me(t,a){if(t&1&&(n(0,"p",25),o(1),i()),t&2){let e=l(2);r(),x(" ",e.credential.issuer," ")}}function ye(t,a){if(t&1&&(n(0,"div",24)(1,"mat-icon"),o(2,"person"),i(),n(3,"span"),o(4),i()()),t&2){let e=l(3);v("routerLink",M(2,pe,e.credential.subject)),r(4),u(e.subject.name)}}function Se(t,a){if(t&1&&(n(0,"p",25),o(1),i()),t&2){let e=l(3);r(),x(" ",e.credential.subject," ")}}function we(t,a){if(t&1&&(n(0,"div",21)(1,"h3"),o(2,"Subject"),i(),p(3,ye,5,4,"div",24)(4,Se,2,1,"p",25),i()),t&2){let e=l(2);r(3),c(e.subject?3:4)}}function ke(t,a){if(t&1&&(n(0,"div",21)(1,"h3"),o(2,"Expiration Date"),i(),n(3,"p",37),o(4),b(5,"date"),i()()),t&2){let e=l(2);r(3),v("ngClass",M(5,Ce,e.getCredentialStatus()==="expired")),r(),x(" ",E(5,2,e.credential.expirationDate,"medium")," ")}}function Ee(t,a){if(t&1){let e=h();n(0,"div",26)(1,"button",38),g("click",function(){C(e);let d=l(2);return _(d.saveChanges())}),n(2,"mat-icon"),o(3,"save"),i(),o(4," Save Changes "),i()()}}function Oe(t,a){if(t&1&&(n(0,"div",41)(1,"div",42),o(2),i(),n(3,"div",43),o(4),i()()),t&2){let e=l().$implicit;r(2),u(e.key),r(2),u(e.value)}}function Pe(t,a){if(t&1&&p(0,Oe,5,2,"div",41),t&2){let e=a.$implicit;c(e.key!=="id"?0:-1)}}function De(t,a){t&1&&(n(0,"div",40),o(1," No additional credential data available "),i())}function je(t,a){if(t&1&&(n(0,"div",28)(1,"h3"),o(2,"Credential Subject Data"),i(),n(3,"div",39),P(4,Pe,1,1,null,null,_e),b(6,"keyvalue"),i(),p(7,De,2,0,"div",40),i()),t&2){let e=l(2);r(4),D(k(6,1,e.credential.credentialSubject)),r(3),c(e.objectKeys(e.credential.credentialSubject).length<=1?7:-1)}}function Ie(t,a){if(t&1){let e=h();n(0,"div",0)(1,"div",2)(2,"a",3)(3,"mat-icon"),o(4,"arrow_back"),i(),o(5," Back to Credentials "),i(),n(6,"div",4)(7,"button",5),g("click",function(){C(e);let d=l();return _(d.downloadCredential())}),n(8,"mat-icon"),o(9,"download"),i(),o(10," Download "),i(),n(11,"button",6),g("click",function(){C(e);let d=l();return _(d.toggleEditMode())}),n(12,"mat-icon"),o(13),i(),o(14),i(),n(15,"button",7),g("click",function(){C(e);let d=l();return _(d.deleteCredential())}),n(16,"mat-icon"),o(17,"delete"),i(),o(18," Delete "),i(),p(19,xe,4,0,"button",8),i()(),n(20,"div",9)(21,"div",10)(22,"div",11)(23,"mat-icon"),o(24),i()(),n(25,"div",12),p(26,ge,2,1,"h1")(27,fe,4,1,"mat-form-field",13),n(28,"div",14),o(29),i(),n(30,"div",15),o(31),b(32,"titlecase"),i()()(),j(33,"mat-divider",16),n(34,"div",17)(35,"mat-tab-group",18)(36,"mat-tab",19)(37,"div",20)(38,"div",21)(39,"h3"),o(40,"Description"),i(),p(41,ve,2,1,"p",22)(42,he,4,1,"mat-form-field",23),i(),n(43,"div",21)(44,"h3"),o(45,"Issuer"),i(),p(46,be,5,4,"div",24)(47,Me,2,1,"p",25),i(),p(48,we,5,1,"div",21),n(49,"div",21)(50,"h3"),o(51,"Issuance Date"),i(),n(52,"p"),o(53),b(54,"date"),i()(),p(55,ke,6,7,"div",21)(56,Ee,5,0,"div",26),i()(),n(57,"mat-tab",27)(58,"div",20),p(59,je,8,3,"div",28),i()(),n(60,"mat-tab",29)(61,"div",20)(62,"div",30)(63,"div",31)(64,"h3"),o(65,"Credential JSON"),i(),n(66,"button",32),g("click",function(){C(e);let d=l();return _(d.copyToClipboard(d.jsonView))}),n(67,"mat-icon"),o(68,"content_copy"),i()()(),n(69,"pre",33),o(70),i()()()()()()()()}if(t&2){let e=l();r(13),u(e.isEditMode?"close":"edit"),r(),x(" ",e.isEditMode?"Cancel":"Edit"," "),r(5),c(e.getCredentialStatus()==="valid"&&e.credential.issuer&&(e.issuer!=null&&e.issuer.privateKey)?19:-1),r(3),v("ngClass",e.getCredentialStatus()),r(2),x(" ",e.getCredentialStatus()==="valid"?"verified_user":e.getCredentialStatus()==="expired"?"schedule":"cancel"," "),r(2),c(e.isEditMode?27:26),r(3),u(e.credential.type),r(),v("ngClass",e.getCredentialStatus()),r(),x(" ",k(32,17,e.getCredentialStatus())," "),r(10),c(e.isEditMode?42:41),r(5),c(e.issuer?46:47),r(2),c(e.credential.subject?48:-1),r(5),u(E(54,19,e.credential.issuanceDate,"medium")),r(2),c(e.credential.expirationDate?55:-1),r(),c(e.isEditMode?56:-1),r(3),c(e.credential.credentialSubject?59:-1),r(11),u(e.jsonView)}}function Te(t,a){t&1&&(n(0,"div",1)(1,"mat-icon"),o(2,"error_outline"),i(),n(3,"h2"),o(4,"Credential Not Found"),i(),n(5,"p"),o(6,"The requested credential could not be found."),i(),n(7,"button",44),o(8," Back to Credentials "),i()())}var me=class t{constructor(a,e,s,d,m){this.route=a;this.router=e;this.credentialService=s;this.identityService=d;this.snackBar=m}credential;issuer;subject;isEditMode=!1;editedName="";editedDescription="";jsonView="";ngOnInit(){this.route.params.subscribe(a=>{let e=a.id;this.loadCredential(e)})}loadCredential(a){if(this.credential=this.credentialService.getCredentialById(a),!this.credential){this.showError("Credential not found"),this.router.navigate(["/credentials"]);return}this.editedName=this.credential.name||"",this.editedDescription=this.credential.description||"",this.jsonView=JSON.stringify(this.credential.rawCredential,null,2),this.credential.issuer&&(this.issuer=this.identityService.getIdentityById(this.credential.issuer)),this.credential.subject&&(this.subject=this.identityService.getIdentityById(this.credential.subject))}toggleEditMode(){this.isEditMode=!this.isEditMode,!this.isEditMode&&this.credential&&(this.editedName=this.credential.name||"",this.editedDescription=this.credential.description||"")}saveChanges(){if(this.credential)try{this.credentialService.updateCredential(this.credential.id,{name:this.editedName,description:this.editedDescription}),this.isEditMode=!1,this.credential=this.credentialService.getCredentialById(this.credential.id),this.showSuccess("Credential information updated")}catch{this.showError("Failed to update credential")}}deleteCredential(){this.credential&&confirm(`Are you sure you want to delete the credential "${this.credential.name}"?`)&&(this.credentialService.deleteCredential(this.credential.id),this.router.navigate(["/credentials"]),this.showSuccess("Credential deleted"))}revokeCredential(){this.credential&&confirm(`Are you sure you want to revoke the credential "${this.credential.name}"?`)&&(this.credentialService.revokeCredential(this.credential.id),this.credential=this.credentialService.getCredentialById(this.credential.id),this.showSuccess("Credential revoked"))}getCredentialStatus(){return this.credential?this.credential.revoked?"revoked":this.credential.expirationDate&&new Date(this.credential.expirationDate)<new Date?"expired":"valid":""}copyToClipboard(a){navigator.clipboard.writeText(a).then(()=>this.showSuccess("Copied to clipboard"),()=>this.showError("Failed to copy"))}objectKeys(a){return Object.keys(a)}downloadCredential(){if(this.credential)try{let a={vc:this.credential.rawCredential,decoded:this.credential.decodedJwt,jwt:this.credential.jwt},e=JSON.stringify(a,null,2),s=new Blob([e],{type:"application/json"}),d=URL.createObjectURL(s),m=document.createElement("a");m.href=d;let ue=`${this.credential.name||"credential"}-${this.credential.id}.json`;m.download=ue,document.body.appendChild(m),m.click(),window.setTimeout(()=>{document.body.removeChild(m),URL.revokeObjectURL(d)},0),this.showSuccess("Credential download started")}catch(a){this.showError("Failed to download credential"),console.error("Download error:",a)}}showSuccess(a){this.snackBar.open(a,"Close",{duration:3e3,panelClass:"success-snackbar"})}showError(a){this.snackBar.open(a,"Close",{duration:5e3,panelClass:"error-snackbar"})}static \u0275fac=function(e){return new(e||t)(f(F),f(L),f(q),f($),f(re))};static \u0275cmp=O({type:t,selectors:[["app-credential-detail"]],decls:2,vars:1,consts:[[1,"page-container"],[1,"not-found"],[1,"page-header"],["routerLink","/credentials",1,"back-link"],[1,"header-actions"],["mat-flat-button","",1,"download-button",3,"click"],["mat-button","",1,"edit-button",3,"click"],["mat-stroked-button","",1,"delete-button",3,"click"],["mat-stroked-button","",1,"revoke-button"],[1,"credential-container"],[1,"credential-header"],[1,"credential-icon",3,"ngClass"],[1,"credential-title"],["appearance","outline"],[1,"credential-type"],[1,"credential-status",3,"ngClass"],[1,"divider"],[1,"credential-content"],["dynamicHeight","","animationDuration","300ms"],["label","Details"],[1,"tab-content"],[1,"detail-section"],[1,"description"],["appearance","outline",1,"full-width"],[1,"identity-link",3,"routerLink"],[1,"identity-id"],[1,"action-buttons"],["label","Credential Data"],[1,"credential-subject"],["label","JSON"],[1,"json-container","neon-card"],[1,"json-header"],["mat-icon-button","",3,"click"],[1,"json-content"],["mat-stroked-button","",1,"revoke-button",3,"click"],["matInput","",3,"ngModelChange","ngModel"],["matInput","","rows","3",3,"ngModelChange","ngModel"],[3,"ngClass"],["mat-primary-button","","color","primary",3,"click"],[1,"subject-properties"],[1,"empty-subject"],[1,"subject-property"],[1,"property-key"],[1,"property-value"],["mat-raised-button","","color","primary","routerLink","/credentials"]],template:function(e,s){e&1&&p(0,Ie,71,22,"div",0)(1,Te,9,0,"div",1),e&2&&c(s.credential?0:1)},dependencies:[N,I,T,V,B,R,ee,X,Y,Z,z,J,A,W,U,K,Q,G,H,ne,ie,te,ae,oe,de,se,ce,le],styles:[".page-header[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;margin-bottom:20px;width:100%}.header-actions[_ngcontent-%COMP%]{display:flex;gap:10px;justify-content:flex-end;margin-left:auto}.credential-container[_ngcontent-%COMP%]{background-color:var(--card-bg);border-radius:4px;box-shadow:0 2px 4px #00000024;overflow:hidden}.credential-header[_ngcontent-%COMP%]{display:flex;align-items:center;padding:20px}.credential-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:60px;height:60px;border-radius:50%;margin-right:20px;background-color:#0078d41a}.credential-icon.valid[_ngcontent-%COMP%]{background-color:#107c101a}.credential-icon.expired[_ngcontent-%COMP%]{background-color:#ca50101a}.credential-icon.revoked[_ngcontent-%COMP%]{background-color:#d134381a}.credential-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:30px;height:30px;width:30px;color:var(--primary-color)}.credential-icon.valid[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--success-color)}.credential-icon.expired[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--warning-color)}.credential-icon.revoked[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--error-color)}.credential-title[_ngcontent-%COMP%]{flex:1}.credential-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 5px}.credential-type[_ngcontent-%COMP%]{font-size:1rem;color:var(--text-secondary);margin-bottom:8px}.credential-status[_ngcontent-%COMP%]{display:inline-block;padding:4px 10px;border-radius:16px;font-size:.8rem;text-transform:uppercase;letter-spacing:.5px}.credential-status.valid[_ngcontent-%COMP%]{background-color:#00e6761a;color:var(--success-color)}.credential-status.expired[_ngcontent-%COMP%]{background-color:#ffb3001a;color:var(--warning-color)}.credential-status.revoked[_ngcontent-%COMP%]{background-color:#ff40811a;color:var(--error-color)}.divider[_ngcontent-%COMP%]{margin:0;border-top-color:#00c3ff1a}.credential-content[_ngcontent-%COMP%]{padding:0}.tab-content[_ngcontent-%COMP%]{padding:20px}.detail-section[_ngcontent-%COMP%]{margin-bottom:25px}.detail-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:8px;color:var(--text-secondary);font-size:1rem;font-weight:500}.detail-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.expired-date[_ngcontent-%COMP%]{color:var(--warning-color)}.identity-link[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px;border-radius:4px;background-color:#0078d40d;cursor:pointer;transition:all .2s ease;max-width:fit-content}.identity-link[_ngcontent-%COMP%]:hover{background-color:#0078d41a}.identity-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--primary-color);font-size:20px;height:20px;width:20px}.identity-id[_ngcontent-%COMP%]{font-family:monospace;word-break:break-all;background-color:#0000000d;padding:8px;border-radius:4px}.description[_ngcontent-%COMP%]{color:var(--text-color);line-height:1.5}.action-buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:20px}.full-width[_ngcontent-%COMP%]{width:100%}.credential-subject[_ngcontent-%COMP%]{margin-top:10px}.subject-properties[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:10px;margin-top:15px}.subject-property[_ngcontent-%COMP%]{background-color:#0078d40d;border-radius:4px;padding:10px}.property-key[_ngcontent-%COMP%]{font-weight:500;font-size:.9rem;margin-bottom:5px;color:var(--primary-color)}.property-value[_ngcontent-%COMP%]{word-break:break-all}.empty-subject[_ngcontent-%COMP%]{margin-top:20px;color:var(--text-secondary);font-style:italic;text-align:center}.json-container[_ngcontent-%COMP%]{background-color:#0000000d;border-radius:4px;padding:0;overflow:hidden}.json-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:10px 15px;background-color:#0078d40d;border-bottom:1px solid rgba(0,0,0,.12)}.json-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0}.json-content[_ngcontent-%COMP%]{padding:15px;margin:0;white-space:pre-wrap;font-family:monospace;font-size:.9rem;color:var(--text-color);overflow-x:auto}.not-found[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:100px 0}.not-found[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:5rem;height:5rem;width:5rem;margin-bottom:20px;color:var(--error-color)}.download-button[_ngcontent-%COMP%]{background-color:var(--mat-sys-primary);color:#fff}@media (max-width: 768px){.header-actions[_ngcontent-%COMP%]{margin-top:15px}.credential-header[_ngcontent-%COMP%]{flex-direction:column;text-align:center}.credential-icon[_ngcontent-%COMP%]{margin-right:0;margin-bottom:15px}}"]})};export{me as CredentialDetailComponent};
