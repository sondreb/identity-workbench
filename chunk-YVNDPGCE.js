import{a as ue,b as Ce,c as F}from"./chunk-ZA65BCCN.js";import{a as xe,b as Me}from"./chunk-ZQ646CWT.js";import{a as _e}from"./chunk-HNBHWSKZ.js";import{a as D}from"./chunk-3GXUXVCL.js";import{b as L,c as fe,d as ge,g as A,h as W,j as R,k as J,l as z,m as H}from"./chunk-IMAXPIZZ.js";import{B,D as N,u as V,z as j}from"./chunk-YHCOEZBY.js";import{K as pe,a as ae,b as re,c as oe,d as le,e as ce,f as de,g as se,h as me}from"./chunk-6JUOHH4N.js";import{d as ie}from"./chunk-XEAJSTHP.js";import{Ad as ne,Fb as K,Fd as P,Gb as a,Hb as v,Ib as w,Id as O,Kb as h,Kd as k,La as l,Lb as y,Ld as T,Mb as S,Pa as C,Pb as Q,Rb as X,Sb as I,Tb as Z,Ub as q,Wa as b,_a as M,fb as x,kb as f,mc as $,nb as U,ob as Y,pa as s,pb as t,qa as m,qb as e,qc as ee,rc as te,tb as g,tc as E,vb as p,wb as u}from"./chunk-GFOZWZLX.js";var G=class o{constructor(n,i,r){this.dialogRef=n;this.credentialService=i;this.snackBar=r}jsonContent="";importCredential(){if(!this.jsonContent){this.showError("Please enter valid JSON content");return}try{let n=JSON.parse(this.jsonContent);this.credentialService.importCredential(n)?(this.showSuccess("Credential imported successfully"),this.dialogRef.close(!0)):this.showError("Failed to import credential. Invalid format.")}catch{this.showError("Invalid JSON format")}}onFileSelected(n){debugger;let i=n.target.files?.[0];if(!i)return;let r=new FileReader;r.onload=c=>{this.jsonContent=c.target?.result},r.readAsText(i)}closeDialog(){this.dialogRef.close(!1)}showSuccess(n){this.snackBar.open(n,"Close",{duration:3e3,panelClass:"success-snackbar"})}showError(n){this.snackBar.open(n,"Close",{duration:5e3,panelClass:"error-snackbar"})}static \u0275fac=function(i){return new(i||o)(C(ue),C(D),C(z))};static \u0275cmp=b({type:o,selectors:[["app-import-credential-dialog"]],decls:25,vars:2,consts:[["fileInput",""],[1,"import-dialog-container"],[1,"dialog-title"],[1,"dialog-description"],[1,"file-input-wrapper"],["mat-stroked-button","","color","primary",1,"upload-btn",3,"click"],["type","file","accept",".json",2,"display","none",3,"change"],["appearance","outline",1,"full-width"],["matInput","","rows","10","placeholder","Paste verifiable credential JSON here...",3,"ngModelChange","ngModel"],[1,"action-buttons"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click","disabled"]],template:function(i,r){if(i&1){let c=g();t(0,"div",1)(1,"h2",2),a(2,"Import Credential"),e(),t(3,"p",3),a(4," Import a Verifiable Credential from JSON data "),e(),t(5,"div",4)(6,"button",5),p("click",function(){s(c);let _=K(11);return m(_.click())}),t(7,"mat-icon"),a(8,"upload_file"),e(),a(9," Select JSON File "),e(),t(10,"input",6,0),p("change",function(_){return s(c),m(r.onFileSelected(_))}),e()(),t(12,"mat-form-field",7)(13,"mat-label"),a(14,"Credential JSON"),e(),t(15,"textarea",8),S("ngModelChange",function(_){return s(c),y(r.jsonContent,_)||(r.jsonContent=_),m(_)}),e(),t(16,"mat-hint"),a(17," The credential must be in valid Verifiable Credential JSON format "),e()(),t(18,"div",9)(19,"button",10),p("click",function(){return s(c),m(r.closeDialog())}),a(20,"Cancel"),e(),t(21,"button",11),p("click",function(){return s(c),m(r.importCredential())}),t(22,"mat-icon"),a(23,"file_download"),e(),a(24," Import Credential "),e()()()}i&2&&(l(15),h("ngModel",r.jsonContent),l(6),x("disabled",!r.jsonContent))},dependencies:[E,N,V,j,B,F,O,P,W,A,L,fe,J,R,T,k,H],styles:[".import-dialog-container[_ngcontent-%COMP%]{padding:16px;max-width:600px}.dialog-title[_ngcontent-%COMP%]{text-align:center;margin-bottom:10px;color:var(--primary-color)}.dialog-description[_ngcontent-%COMP%]{text-align:center;color:var(--text-secondary);margin-bottom:20px}.full-width[_ngcontent-%COMP%]{width:100%}.action-buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px;margin-top:20px}.file-input-wrapper[_ngcontent-%COMP%]{position:relative;margin-bottom:20px;overflow:hidden}.file-input-wrapper[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;cursor:pointer}.upload-btn[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:center;gap:8px;padding:10px;border:1px dashed var(--primary-color)}textarea[_ngcontent-%COMP%]:focus, input[_ngcontent-%COMP%]:focus{outline:1px solid var(--primary-color)}"]})};var De=(o,n,i)=>({valid:o,expired:n,revoked:i}),Fe=o=>["/credential",o],he=(o,n)=>n.id;function Ve(o,n){if(o&1&&(t(0,"mat-option",23),a(1),e()),o&2){let i=n.$implicit;x("value",i.id),l(),w(" ",i.name," ")}}function je(o,n){if(o&1){let i=g();t(0,"mat-form-field",8)(1,"mat-label"),a(2,"Issuer"),e(),t(3,"mat-select",12),S("ngModelChange",function(c){s(i);let d=u();return y(d.filterIssuer,c)||(d.filterIssuer=c),m(c)}),t(4,"mat-option",13),a(5,"All Issuers"),e(),U(6,Ve,2,2,"mat-option",23,he),e()()}if(o&2){let i=u();l(3),h("ngModel",i.filterIssuer),l(3),Y(i.identities)}}function Be(o,n){if(o&1){let i=g();t(0,"button",24),p("click",function(){s(i);let c=u();return m(c.clearFilters())}),t(1,"mat-icon"),a(2,"clear"),e(),a(3," Clear Filters "),e()}}function Ne(o,n){if(o&1){let i=g();t(0,"div",21)(1,"mat-icon"),a(2,"verified_user"),e(),t(3,"h2"),a(4,"No Credentials Found"),e(),t(5,"p"),a(6,"You haven't imported or issued any credentials yet."),e(),t(7,"div",25)(8,"button",4),a(9," Issue Credential "),e(),t(10,"button",5),p("click",function(){s(i);let c=u();return m(c.openImportDialog())}),a(11," Import Credential "),e(),t(12,"button",26),a(13," Verify Credential "),e()()()}}function Le(o,n){if(o&1){let i=g();t(0,"div",21)(1,"mat-icon"),a(2,"search_off"),e(),t(3,"h2"),a(4,"No Results Found"),e(),t(5,"p"),a(6,"No credentials match your search criteria."),e(),t(7,"button",24),p("click",function(){s(i);let c=u();return m(c.clearFilters())}),a(8," Clear Filters "),e()()}}function Ae(o,n){if(o&1&&(t(0,"p",30),a(1),e()),o&2){let i=u().$implicit;l(),w(" ",i.description," ")}}function We(o,n){if(o&1&&(t(0,"div",32)(1,"span",33),a(2,"Expires:"),e(),t(3,"span",34),a(4),I(5,"date"),e()()),o&2){let i=u().$implicit;l(4),v(q(5,1,i.expirationDate,"shortDate"))}}function Re(o,n){o&1&&(t(0,"mat-icon"),a(1,"check_circle"),e())}function Je(o,n){o&1&&(t(0,"mat-icon"),a(1,"schedule"),e())}function ze(o,n){o&1&&(t(0,"mat-icon"),a(1,"cancel"),e())}function He(o,n){if(o&1){let i=g();t(0,"mat-card",27)(1,"mat-card-header")(2,"div",28)(3,"mat-icon"),a(4,"verified_user"),e()(),t(5,"mat-card-title"),a(6),e(),t(7,"mat-card-subtitle")(8,"span",29),a(9),e()()(),t(10,"mat-card-content"),M(11,Ae,2,1,"p",30),t(12,"div",31)(13,"div",32)(14,"span",33),a(15,"Issuer:"),e(),t(16,"span",34),a(17),e()(),t(18,"div",32)(19,"span",33),a(20,"Issued:"),e(),t(21,"span",34),a(22),I(23,"date"),e()(),M(24,We,6,4,"div",32),e(),t(25,"div",35),M(26,Re,2,0,"mat-icon")(27,Je,2,0,"mat-icon")(28,ze,2,0,"mat-icon"),a(29),I(30,"titlecase"),e()(),t(31,"mat-card-actions")(32,"button",36),a(33," VIEW "),e(),t(34,"button",37),p("click",function(){let c=s(i).$implicit,d=u(2);return m(d.deleteCredential(c.id))}),a(35," DELETE "),e()()()}if(o&2){let i=n.$implicit,r=u(2);l(2),x("ngClass",X(16,De,r.getCredentialStatus(i)==="valid",r.getCredentialStatus(i)==="expired",r.getCredentialStatus(i)==="revoked")),l(4),v(i.name),l(3),v(i.type),l(2),f(i.description?11:-1),l(6),v(r.getIdentityName(i.issuer)),l(5),v(q(23,11,i.issuanceDate,"shortDate")),l(2),f(i.expirationDate?24:-1),l(),x("ngClass",r.getCredentialStatus(i)),l(),f(r.getCredentialStatus(i)==="valid"?26:r.getCredentialStatus(i)==="expired"?27:28),l(3),w(" ",Z(30,14,r.getCredentialStatus(i))," "),l(3),x("routerLink",Q(20,Fe,i.id))}}function Ge(o,n){if(o&1&&(t(0,"div",22),U(1,He,36,22,"mat-card",27,he),e()),o&2){let i=u();l(),Y(i.filteredCredentials)}}var ve=class o{constructor(n,i,r,c){this.credentialService=n;this.identityService=i;this.dialog=r;this.snackBar=c;this.loadCredentials(),this.loadIdentities()}credentials=[];identities=[];searchTerm="";filterType="all";filterIssuer="all";loadCredentials(){this.credentialService.getAllCredentials().subscribe(n=>{this.credentials=n})}loadIdentities(){this.identityService.getAllIdentities().subscribe(n=>{this.identities=n})}get filteredCredentials(){return this.credentials.filter(n=>{let i=!this.searchTerm||n.name?.toLowerCase().includes(this.searchTerm.toLowerCase())||n.description?.toLowerCase().includes(this.searchTerm.toLowerCase())||n.id.toLowerCase().includes(this.searchTerm.toLowerCase())||n.type.toLowerCase().includes(this.searchTerm.toLowerCase()),r=this.filterType==="all"||n.type===this.filterType,c=this.filterIssuer==="all"||n.issuer===this.filterIssuer;return i&&r&&c})}getIdentityName(n){return this.identities.find(r=>r.id===n)?.name||"Unknown"}getCredentialStatus(n){return n.revoked?"revoked":n.expirationDate&&new Date(n.expirationDate)<new Date?"expired":"valid"}truncateId(n){return n.length<=30?n:n.substring(0,15)+"..."+n.substring(n.length-10)}openImportDialog(){this.dialog.open(G,{width:"600px"}).afterClosed().subscribe(i=>{i&&this.loadCredentials()})}deleteCredential(n){confirm("Are you sure you want to delete this credential?")&&(this.credentialService.deleteCredential(n),this.snackBar.open("Credential deleted","Close",{duration:3e3,panelClass:"success-snackbar"}))}clearFilters(){this.searchTerm="",this.filterType="all",this.filterIssuer="all"}static \u0275fac=function(i){return new(i||o)(C(D),C(pe),C(Ce),C(z))};static \u0275cmp=b({type:o,selectors:[["app-credentials"]],decls:48,vars:7,consts:[[1,"page-container"],[1,"page-header"],[1,"title-section"],[1,"actions-section"],["mat-flat-button","","color","primary","routerLink","/issue"],["mat-raised-button","","color","accent",3,"click"],[1,"filters-container"],[1,"search-container"],["appearance","outline"],["matInput","","placeholder","Search credentials",3,"ngModelChange","ngModel"],["matSuffix",""],[1,"filter-container"],[3,"ngModelChange","ngModel"],["value","all"],["value","VerifiableCredential"],["value","IdentityCredential"],["value","ProofOfAgeCredential"],["value","AgreementCredential"],["value","DocumentCredential"],["value","ContractCredential"],["mat-button","","color","primary"],[1,"empty-state"],[1,"credential-grid"],[3,"value"],["mat-button","","color","primary",3,"click"],[1,"empty-state-actions"],["mat-raised-button","","routerLink","/verify"],[1,"credential-card","neon-card"],["mat-card-avatar","",1,"credential-avatar",3,"ngClass"],[1,"credential-type"],[1,"credential-description"],[1,"credential-meta"],[1,"meta-item"],[1,"meta-label"],[1,"meta-value"],[1,"credential-status",3,"ngClass"],["mat-button","","color","primary",3,"routerLink"],["mat-button","","color","warn",3,"click"]],template:function(i,r){i&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),a(4,"Credentials"),e(),t(5,"p"),a(6,"Manage your verifiable credentials"),e()(),t(7,"div",3)(8,"button",4)(9,"mat-icon"),a(10,"send"),e(),a(11," Issue Credential "),e(),t(12,"button",5),p("click",function(){return r.openImportDialog()}),t(13,"mat-icon"),a(14,"file_upload"),e(),a(15," Import "),e()()(),t(16,"div",6)(17,"div",7)(18,"mat-form-field",8)(19,"mat-label"),a(20,"Search"),e(),t(21,"input",9),S("ngModelChange",function(d){return y(r.searchTerm,d)||(r.searchTerm=d),d}),e(),t(22,"mat-icon",10),a(23,"search"),e()()(),t(24,"div",11)(25,"mat-form-field",8)(26,"mat-label"),a(27,"Type"),e(),t(28,"mat-select",12),S("ngModelChange",function(d){return y(r.filterType,d)||(r.filterType=d),d}),t(29,"mat-option",13),a(30,"All Types"),e(),t(31,"mat-option",14),a(32,"Generic"),e(),t(33,"mat-option",15),a(34,"Identity"),e(),t(35,"mat-option",16),a(36,"Proof of Age"),e(),t(37,"mat-option",17),a(38,"Agreement"),e(),t(39,"mat-option",18),a(40,"Document"),e(),t(41,"mat-option",19),a(42,"Contract"),e()()(),M(43,je,8,1,"mat-form-field",8)(44,Be,4,0,"button",20),e()(),M(45,Ne,14,0,"div",21)(46,Le,9,0,"div",21)(47,Ge,3,0,"div",22),e()),i&2&&(l(21),h("ngModel",r.searchTerm),l(7),h("ngModel",r.filterType),l(15),f(r.identities.length>0?43:-1),l(),f(r.searchTerm||r.filterType!=="all"||r.filterIssuer!=="all"?44:-1),l(),f(r.credentials.length===0?45:-1),l(),f(r.credentials.length>0&&r.filteredCredentials.length===0?46:-1),l(),f(r.filteredCredentials.length>0?47:-1))},dependencies:[E,$,ee,te,N,V,j,B,ie,me,ae,ce,se,oe,de,le,re,O,P,T,k,_e,J,R,A,L,ge,W,Me,xe,ne,F,H],styles:[".page-header[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;margin-bottom:20px;width:100%}.title-section[_ngcontent-%COMP%]{flex:1}.title-section[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:5px;color:var(--primary-color)}.title-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-secondary);margin:0}.actions-section[_ngcontent-%COMP%]{display:flex;gap:10px;justify-content:flex-end;margin-left:auto}.filters-container[_ngcontent-%COMP%]{margin-bottom:30px;display:flex;flex-direction:column;gap:15px}.search-container[_ngcontent-%COMP%]{width:100%}.filter-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:15px;align-items:center}.filter-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{flex:1;min-width:200px}.credential-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px}.credential-card[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.credential-avatar[_ngcontent-%COMP%]{background-color:#0078d41a;display:flex;align-items:center;justify-content:center}.credential-avatar.valid[_ngcontent-%COMP%]{background-color:#00e67633}.credential-avatar.expired[_ngcontent-%COMP%]{background-color:#ffb30033}.credential-avatar.revoked[_ngcontent-%COMP%]{background-color:#ff408133}.credential-avatar[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--primary-color)}.credential-avatar.valid[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--success-color)}.credential-avatar.expired[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--warning-color)}.credential-avatar.revoked[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--error-color)}.credential-type[_ngcontent-%COMP%]{font-size:.85rem;color:var(--text-secondary)}.credential-description[_ngcontent-%COMP%]{color:var(--text-secondary);margin-bottom:15px;min-height:20px}.credential-meta[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;margin-bottom:15px}.meta-item[_ngcontent-%COMP%]{display:flex;font-size:.9rem}.meta-label[_ngcontent-%COMP%]{width:60px;font-weight:500;color:var(--text-secondary)}.meta-value[_ngcontent-%COMP%]{flex:1}.credential-status[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:.9rem;padding:4px 10px;border-radius:16px;width:fit-content;margin-top:10px}.credential-status[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;height:16px;width:16px;margin-right:5px}.credential-status.valid[_ngcontent-%COMP%]{background-color:#00e6761a;color:var(--success-color)}.credential-status.expired[_ngcontent-%COMP%]{background-color:#ffb3001a;color:var(--warning-color)}.credential-status.revoked[_ngcontent-%COMP%]{background-color:#ff40811a;color:var(--error-color)}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 0;text-align:center}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:5rem;height:5rem;width:5rem;margin-bottom:20px;color:var(--text-secondary)}.empty-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:10px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:20px;color:var(--text-secondary)}.empty-state-actions[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;justify-content:center}@media (max-width: 768px){.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.actions-section[_ngcontent-%COMP%]{margin-top:15px;width:100%;justify-content:flex-start}.credential-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};export{ve as CredentialsComponent};
