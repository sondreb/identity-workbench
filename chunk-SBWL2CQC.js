import{Jd as Ae,a as L,b as q,ba as ve,d as X,e as Zt,f as E,ga as Se,m as we}from"./chunk-QGVK6STR.js";var Be=X(T=>{"use strict";var Bt=function(e,t){return t||(t={}),e.split("").forEach(function(n,r){n in t||(t[n]=r)}),t},ot={alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",charmap:{0:14,1:8}};ot.charmap=Bt(ot.alphabet,ot.charmap);var At={alphabet:"0123456789ABCDEFGHJKMNPQRSTVWXYZ",charmap:{O:0,I:1,L:1}};At.charmap=Bt(At.alphabet,At.charmap);var Et={alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",charmap:{}};Et.charmap=Bt(Et.alphabet,Et.charmap);function dt(e){if(this.buf=[],this.shift=8,this.carry=0,e){switch(e.type){case"rfc4648":this.charmap=T.rfc4648.charmap;break;case"crockford":this.charmap=T.crockford.charmap;break;case"base32hex":this.charmap=T.base32hex.charmap;break;default:throw new Error("invalid type")}e.charmap&&(this.charmap=e.charmap)}}dt.prototype.charmap=ot.charmap;dt.prototype.write=function(e){var t=this.charmap,n=this.buf,r=this.shift,o=this.carry;return e.toUpperCase().split("").forEach(function(s){if(s!="="){var i=t[s]&255;r-=5,r>0?o|=i<<r:r<0?(n.push(o|i>>-r),r+=8,o=i<<r&255):(n.push(o|i),r=8,o=0)}}),this.shift=r,this.carry=o,this};dt.prototype.finalize=function(e){return e&&this.write(e),this.shift!==8&&this.carry!==0&&(this.buf.push(this.carry),this.shift=8,this.carry=0),this.buf};function ft(e){if(this.buf="",this.shift=3,this.carry=0,e){switch(e.type){case"rfc4648":this.alphabet=T.rfc4648.alphabet;break;case"crockford":this.alphabet=T.crockford.alphabet;break;case"base32hex":this.alphabet=T.base32hex.alphabet;break;default:throw new Error("invalid type")}e.alphabet?this.alphabet=e.alphabet:e.lc&&(this.alphabet=this.alphabet.toLowerCase())}}ft.prototype.alphabet=ot.alphabet;ft.prototype.write=function(e){var t=this.shift,n=this.carry,r,o,s;for(s=0;s<e.length;s++)o=e[s],r=n|o>>t,this.buf+=this.alphabet[r&31],t>5&&(t-=5,r=o>>t,this.buf+=this.alphabet[r&31]),t=5-t,n=o<<t,t=8-t;return this.shift=t,this.carry=n,this};ft.prototype.finalize=function(e){return e&&this.write(e),this.shift!==3&&(this.buf+=this.alphabet[this.carry&31],this.shift=3,this.carry=0),this.buf};T.encode=function(e,t){return new ft(t).finalize(e)};T.decode=function(e,t){return new dt(t).finalize(e)};T.Decoder=dt;T.Encoder=ft;T.charmap=Bt;T.crockford=At;T.rfc4648=ot;T.base32hex=Et});var Ke=X((wo,Ue)=>{"use strict";function Ln(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var r=0;r<e.length;r++){var o=e.charAt(r),s=o.charCodeAt(0);if(t[s]!==255)throw new TypeError(o+" is ambiguous");t[s]=r}var i=e.length,c=e.charAt(0),a=Math.log(i)/Math.log(256),u=Math.log(256)/Math.log(i);function f(x){if(x instanceof Uint8Array||(ArrayBuffer.isView(x)?x=new Uint8Array(x.buffer,x.byteOffset,x.byteLength):Array.isArray(x)&&(x=Uint8Array.from(x))),!(x instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(x.length===0)return"";for(var y=0,w=0,m=0,S=x.length;m!==S&&x[m]===0;)m++,y++;for(var v=(S-m)*u+1>>>0,b=new Uint8Array(v);m!==S;){for(var A=x[m],B=0,U=v-1;(A!==0||B<w)&&U!==-1;U--,B++)A+=256*b[U]>>>0,b[U]=A%i>>>0,A=A/i>>>0;if(A!==0)throw new Error("Non-zero carry");w=B,m++}for(var R=v-w;R!==v&&b[R]===0;)R++;for(var H=c.repeat(y);R<v;++R)H+=e.charAt(b[R]);return H}function d(x){if(typeof x!="string")throw new TypeError("Expected String");if(x.length===0)return new Uint8Array;var y=0;if(x[y]!==" "){for(var w=0,m=0;x[y]===c;)w++,y++;for(var S=(x.length-y)*a+1>>>0,v=new Uint8Array(S);x[y];){var b=t[x.charCodeAt(y)];if(b===255)return;for(var A=0,B=S-1;(b!==0||A<m)&&B!==-1;B--,A++)b+=i*v[B]>>>0,v[B]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");m=A,y++}if(x[y]!==" "){for(var U=S-m;U!==S&&v[U]===0;)U++;for(var R=new Uint8Array(w+(S-U)),H=w;U!==S;)R[H++]=v[U++];return R}}}function h(x){var y=d(x);if(y)return y;throw new Error("Non-base"+i+" character")}return{encode:f,decodeUnsafe:d,decode:h}}Ue.exports=Ln});var Kt=X((vo,De)=>{"use strict";var Mn=new TextDecoder,Cn=e=>Mn.decode(e),$n=new TextEncoder,jn=e=>$n.encode(e);function On(e,t){let n=new Uint8Array(t),r=0;for(let o of e)n.set(o,r),r+=o.length;return n}De.exports={decodeText:Cn,encodeText:jn,concat:On}});var ke=X((So,Pe)=>{"use strict";var{encodeText:Vn}=Kt(),Wt=class{constructor(t,n,r,o){this.name=t,this.code=n,this.codeBuf=Vn(this.code),this.alphabet=o,this.codec=r(o)}encode(t){return this.codec.encode(t)}decode(t){for(let n of t)if(this.alphabet&&this.alphabet.indexOf(n)<0)throw new Error(`invalid character '${n}' in '${t}'`);return this.codec.decode(t)}};Pe.exports=Wt});var Te=X((Ao,Re)=>{"use strict";var Fn=(e,t,n)=>{let r={};for(let u=0;u<t.length;++u)r[t[u]]=u;let o=e.length;for(;e[o-1]==="=";)--o;let s=new Uint8Array(o*n/8|0),i=0,c=0,a=0;for(let u=0;u<o;++u){let f=r[e[u]];if(f===void 0)throw new SyntaxError("Invalid character "+e[u]);c=c<<n|f,i+=n,i>=8&&(i-=8,s[a++]=255&c>>i)}if(i>=n||255&c<<8-i)throw new SyntaxError("Unexpected end of data");return s},zn=(e,t,n)=>{let r=t[t.length-1]==="=",o=(1<<n)-1,s="",i=0,c=0;for(let a=0;a<e.length;++a)for(c=c<<8|e[a],i+=8;i>n;)i-=n,s+=t[o&c>>i];if(i&&(s+=t[o&c<<n-i]),r)for(;s.length*n&7;)s+="=";return s},_n=e=>t=>({encode(n){return zn(n,t,e)},decode(n){return Fn(n,t,e)}});Re.exports={rfc4648:_n}});var Ce=X((Eo,Me)=>{"use strict";var ut=Ke(),Gn=ke(),{rfc4648:D}=Te(),{decodeText:Nn,encodeText:Zn}=Kt(),qn=()=>({encode:Nn,decode:Zn}),He=[["identity","\0",qn,""],["base2","0",D(1),"01"],["base8","7",D(3),"01234567"],["base10","9",ut,"0123456789"],["base16","f",D(4),"0123456789abcdef"],["base16upper","F",D(4),"0123456789ABCDEF"],["base32hex","v",D(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",D(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",D(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",D(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",D(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",D(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",D(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",D(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",D(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",ut,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",ut,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",ut,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",ut,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",D(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",D(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",D(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",D(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],Le=He.reduce((e,t)=>(e[t[0]]=new Gn(t[0],t[1],t[2],t[3]),e),{}),Xn=He.reduce((e,t)=>(e[t[1]]=Le[t[0]],e),{});Me.exports={names:Le,codes:Xn}});var Jt=X(($,je)=>{"use strict";var st=Ce(),{encodeText:Yn,decodeText:Dt,concat:$e}=Kt();function Wn(e,t){if(!t)throw new Error("requires an encoded Uint8Array");let{name:n,codeBuf:r}=J(e);return er(n,t),$e([r,t],r.length+t.length)}function Jn(e,t){let n=J(e),r=Yn(n.encode(t));return $e([n.codeBuf,r],n.codeBuf.length+r.length)}function Qn(e){e instanceof Uint8Array&&(e=Dt(e));let t=e[0];return["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(t)&&(e=e.toLowerCase()),J(e[0]).decode(e.substring(1))}function tr(e){if(e instanceof Uint8Array&&(e=Dt(e)),Object.prototype.toString.call(e)!=="[object String]")return!1;try{return J(e[0]).name}catch{return!1}}function er(e,t){J(e).decode(Dt(t))}function J(e){if(Object.prototype.hasOwnProperty.call(st.names,e))return st.names[e];if(Object.prototype.hasOwnProperty.call(st.codes,e))return st.codes[e];throw new Error(`Unsupported encoding: ${e}`)}function nr(e){return e instanceof Uint8Array&&(e=Dt(e)),J(e[0])}$=je.exports=Wn;$.encode=Jn;$.decode=Qn;$.isEncoded=tr;$.encoding=J;$.encodingFromData=nr;var rr=Object.freeze(st.names),or=Object.freeze(st.codes);$.names=rr;$.codes=or});var Pn=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),qt={randomUUID:Pn};var St,kn=new Uint8Array(16);function Xt(){if(!St&&(St=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!St))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return St(kn)}var K=[];for(let e=0;e<256;++e)K.push((e+256).toString(16).slice(1));function Ee(e,t=0){return K[e[t+0]]+K[e[t+1]]+K[e[t+2]]+K[e[t+3]]+"-"+K[e[t+4]]+K[e[t+5]]+"-"+K[e[t+6]]+K[e[t+7]]+"-"+K[e[t+8]]+K[e[t+9]]+"-"+K[e[t+10]]+K[e[t+11]]+K[e[t+12]]+K[e[t+13]]+K[e[t+14]]+K[e[t+15]]}function Rn(e,t,n){if(qt.randomUUID&&!t&&!e)return qt.randomUUID();e=e||{};let r=e.random||(e.rng||Xt)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){n=n||0;for(let o=0;o<16;++o)t[n+o]=r[o];return t}return Ee(r)}var Yt=Rn;var It=Zt(Be(),1);function Tn(e,t){if(e.length!==t.length)return!1;if(e.length===0)return!0;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0}var Ut={ed25519PublicKey:48,ed25519SecretSeed:144,med25519PublicKey:96,preAuthTx:152,sha256Hash:184,signedPayload:120,contract:16},Hn={G:"ed25519PublicKey",S:"ed25519SecretSeed",M:"med25519PublicKey",T:"preAuthTx",X:"sha256Hash",P:"signedPayload",C:"contract"},W=class{static encodeEd25519PublicKey(t){return Y("ed25519PublicKey",t)}static decodeEd25519PublicKey(t){return _("ed25519PublicKey",t)}static isValidEd25519PublicKey(t){return lt("ed25519PublicKey",t)}static encodeEd25519SecretSeed(t){return Y("ed25519SecretSeed",t)}static decodeEd25519SecretSeed(t){return _("ed25519SecretSeed",t)}static isValidEd25519SecretSeed(t){return lt("ed25519SecretSeed",t)}static encodeMed25519PublicKey(t){return Y("med25519PublicKey",t)}static decodeMed25519PublicKey(t){return _("med25519PublicKey",t)}static isValidMed25519PublicKey(t){return lt("med25519PublicKey",t)}static encodePreAuthTx(t){return Y("preAuthTx",t)}static decodePreAuthTx(t){return _("preAuthTx",t)}static encodeSha256Hash(t){return Y("sha256Hash",t)}static decodeSha256Hash(t){return _("sha256Hash",t)}static encodeSignedPayload(t){return Y("signedPayload",t)}static decodeSignedPayload(t){return _("signedPayload",t)}static isValidSignedPayload(t){return lt("signedPayload",t)}static encodeContract(t){return Y("contract",t)}static decodeContract(t){return _("contract",t)}static isValidContract(t){return lt("contract",t)}static getVersionByteForPrefix(t){return Hn[t[0]]}};function lt(e,t){if(typeof t!="string")return!1;switch(e){case"ed25519PublicKey":case"ed25519SecretSeed":case"preAuthTx":case"sha256Hash":case"contract":if(t.length!==56)return!1;break;case"med25519PublicKey":if(t.length!==69)return!1;break;case"signedPayload":if(t.length<56||t.length>165)return!1;break;default:return!1}let n="";try{n=_(e,t)}catch{return!1}switch(e){case"ed25519PublicKey":case"ed25519SecretSeed":case"preAuthTx":case"sha256Hash":case"contract":return n.length===32;case"med25519PublicKey":return n.length===40;case"signedPayload":return n.length>=40&&n.length<=100;default:return!1}}function _(e,t){if(typeof t!="string")throw new TypeError("encoded argument must be of type String");let n=It.default.decode(t),r=n[0],o=n.slice(0,-2),s=o.slice(1),i=n.slice(-2);if(t!==It.default.encode(n))throw new Error("invalid encoded string");let c=Ut[e];if(c===void 0)throw new Error(`${e} is not a valid version byte name. Expected one of ${Object.keys(Ut).join(", ")}`);if(r!==c)throw new Error(`invalid version byte. expected ${c}, got ${r}`);let a=Ie(o);if(!Tn(a,i))throw new Error("invalid checksum");return new Uint8Array(s)}function Y(e,t){if(t==null)throw new Error("cannot encode null data");let n=Ut[e];if(n===void 0)throw new Error(`${e} is not a valid version byte name. Expected one of ${Object.keys(Ut).join(", ")}`);t=new Uint8Array(t);let r=new Uint8Array([n]),o=new Uint8Array(r.length+t.length);o.set(r,0),o.set(t,r.length);let s=new Uint8Array(Ie(o)),i=new Uint8Array(o.length+s.length);return i.set(o,0),i.set(s,o.length),It.default.encode(i)}function Ie(e){let t=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920],n=0;for(let o=0;o<e.length;o+=1){let s=e[o],i=n>>8^s;n=n<<8^t[i],n&=65535}let r=new Uint8Array(2);return r[0]=n&255,r[1]=n>>8&255,r}var rn=Zt(Jt(),1);var P=2n**255n-19n,xt=2n**252n+27742317777372353535851937790883648493n,Qt=0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51an,te=0x6666666666666666666666666666666666666666666666666666666666666658n,sr=37095705934669439343138083508754565189542113879843219016388785533085940283555n,Pt={a:-1n,d:sr,p:P,n:xt,h:8,Gx:Qt,Gy:te},k=(e="")=>{throw new Error(e)},Ne=e=>typeof e=="string",ir=e=>e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array",bt=(e,t)=>!ir(e)||typeof t=="number"&&t>0&&e.length!==t?k("Uint8Array of valid length expected"):e,it=e=>new Uint8Array(e),ee=(e,t)=>bt(Ne(e)?re(e):it(bt(e)),t),p=(e,t=P)=>{let n=e%t;return n>=0n?n:t+n},Oe=e=>e instanceof G?e:k("Point expected"),G=class e{constructor(t,n,r,o){this.ex=t,this.ey=n,this.ez=r,this.et=o}static fromAffine(t){return new e(t.x,t.y,1n,p(t.x*t.y))}static fromHex(t,n=!1){let{d:r}=Pt;t=ee(t,32);let o=t.slice(),s=t[31];o[31]=s&-129;let i=qe(o);n&&!(0n<=i&&i<2n**256n)&&k("bad y coord 1"),!n&&!(0n<=i&&i<P)&&k("bad y coord 2");let c=p(i*i),a=p(c-1n),u=p(r*c+1n),{isValid:f,value:d}=dr(a,u);f||k("bad y coordinate 3");let h=(d&1n)===1n,x=(s&128)!==0;return!n&&d===0n&&x&&k("bad y coord 3"),x!==h&&(d=p(-d)),new e(d,i,1n,p(d*i))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}equals(t){let{ex:n,ey:r,ez:o}=this,{ex:s,ey:i,ez:c}=Oe(t),a=p(n*c),u=p(s*o),f=p(r*c),d=p(i*o);return a===u&&f===d}is0(){return this.equals(ht)}negate(){return new e(p(-this.ex),this.ey,this.ez,p(-this.et))}double(){let{ex:t,ey:n,ez:r}=this,{a:o}=Pt,s=p(t*t),i=p(n*n),c=p(2n*p(r*r)),a=p(o*s),u=t+n,f=p(p(u*u)-s-i),d=a+i,h=d-c,x=a-i,y=p(f*h),w=p(d*x),m=p(f*x),S=p(h*d);return new e(y,w,S,m)}add(t){let{ex:n,ey:r,ez:o,et:s}=this,{ex:i,ey:c,ez:a,et:u}=Oe(t),{a:f,d}=Pt,h=p(n*i),x=p(r*c),y=p(s*d*u),w=p(o*a),m=p((n+r)*(i+c)-h-x),S=p(w-y),v=p(w+y),b=p(x-f*h),A=p(m*S),B=p(v*b),U=p(m*b),R=p(S*v);return new e(A,B,R,U)}mul(t,n=!0){if(t===0n)return n===!0?k("cannot multiply by 0"):ht;if(typeof t=="bigint"&&0n<t&&t<xt||k("invalid scalar, must be < L"),!n&&this.is0()||t===1n)return this;if(this.equals(ct))return pr(t).p;let r=ht,o=ct;for(let s=this;t>0n;s=s.double(),t>>=1n)t&1n?r=r.add(s):n&&(o=o.add(s));return r}multiply(t){return this.mul(t)}clearCofactor(){return this.mul(BigInt(Pt.h),!1)}isSmallOrder(){return this.clearCofactor().is0()}isTorsionFree(){let t=this.mul(xt/2n,!1).double();return xt%2n&&(t=t.add(this)),t.is0()}toAffine(){let{ex:t,ey:n,ez:r}=this;if(this.equals(ht))return{x:0n,y:1n};let o=Xe(r,P);return p(r*o)!==1n&&k("invalid inverse"),{x:p(t*o),y:p(n*o)}}toRawBytes(){let{x:t,y:n}=this.toAffine(),r=cr(n);return r[31]|=t&1n?128:0,r}toHex(){return ne(this.toRawBytes())}};G.BASE=new G(Qt,te,1n,p(Qt*te));G.ZERO=new G(0n,1n,1n,0n);var{BASE:ct,ZERO:ht}=G,Ze=(e,t)=>e.toString(16).padStart(t,"0"),ne=e=>Array.from(bt(e)).map(t=>Ze(t,2)).join(""),j={_0:48,_9:57,A:65,F:70,a:97,f:102},Ve=e=>{if(e>=j._0&&e<=j._9)return e-j._0;if(e>=j.A&&e<=j.F)return e-(j.A-10);if(e>=j.a&&e<=j.f)return e-(j.a-10)},re=e=>{let t="hex invalid";if(!Ne(e))return k(t);let n=e.length,r=n/2;if(n%2)return k(t);let o=it(r);for(let s=0,i=0;s<r;s++,i+=2){let c=Ve(e.charCodeAt(i)),a=Ve(e.charCodeAt(i+1));if(c===void 0||a===void 0)return k(t);o[s]=c*16+a}return o},cr=e=>re(Ze(e,32*2)).reverse(),qe=e=>BigInt("0x"+ne(it(bt(e)).reverse())),Fe=(...e)=>{let t=it(e.reduce((r,o)=>r+bt(o).length,0)),n=0;return e.forEach(r=>{t.set(r,n),n+=r.length}),t},Xe=(e,t)=>{(e===0n||t<=0n)&&k("no inverse n="+e+" mod="+t);let n=p(e,t),r=t,o=0n,s=1n,i=1n,c=0n;for(;n!==0n;){let a=r/n,u=r%n,f=o-i*a,d=s-c*a;r=n,n=u,o=i,s=c,i=f,c=d}return r===1n?p(o,t):k("no inverse")},M=(e,t)=>{let n=e;for(;t-- >0n;)n*=n,n%=P;return n},ar=e=>{let n=e*e%P*e%P,r=M(n,2n)*n%P,o=M(r,1n)*e%P,s=M(o,5n)*o%P,i=M(s,10n)*s%P,c=M(i,20n)*i%P,a=M(c,40n)*c%P,u=M(a,80n)*a%P,f=M(u,80n)*a%P,d=M(f,10n)*s%P;return{pow_p_5_8:M(d,2n)*e%P,b2:n}},ze=19681161376707505956807079304988542015446066515923890162744021073123829784752n,dr=(e,t)=>{let n=p(t*t*t),r=p(n*n*t),o=ar(e*r).pow_p_5_8,s=p(e*n*o),i=p(t*s*s),c=s,a=p(s*ze),u=i===e,f=i===p(-e),d=i===p(-e*ze);return u&&(s=c),(f||d)&&(s=a),(p(s)&1n)===1n&&(s=p(-s)),{isValid:u||f,value:s}},fr=e=>p(qe(e),xt),pt,lr=(...e)=>O.sha512Async(...e),ur=(...e)=>typeof pt=="function"?pt(...e):k("etc.sha512Sync not set"),Ye=e=>{let t=e.slice(0,32);t[0]&=248,t[31]&=127,t[31]|=64;let n=e.slice(32,64),r=fr(t),o=ct.mul(r),s=o.toRawBytes();return{head:t,prefix:n,scalar:r,point:o,pointBytes:s}},hr=e=>lr(ee(e,32)).then(Ye),We=e=>Ye(ur(ee(e,32)));var yt=e=>We(e).pointBytes;var _e=()=>typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0,O={bytesToHex:ne,hexToBytes:re,concatBytes:Fe,mod:p,invert:Xe,randomBytes:(e=32)=>{let t=_e();return(!t||!t.getRandomValues)&&k("crypto.getRandomValues must be defined"),t.getRandomValues(it(e))},sha512Async:(...e)=>E(void 0,null,function*(){let t=_e(),n=t&&t.subtle;n||k("etc.sha512Async or crypto.subtle must be defined");let r=Fe(...e);return it(yield n.digest("SHA-512",r.buffer))}),sha512Sync:void 0};Object.defineProperties(O,{sha512Sync:{configurable:!1,get(){return pt},set(e){pt||(pt=e)}}});var Je={getExtendedPublicKeyAsync:hr,getExtendedPublicKey:We,randomPrivateKey:()=>O.randomBytes(32),precompute:(e=8,t=ct)=>(t.multiply(3n),t)},Q=8,xr=()=>{let e=[],t=256/Q+1,n=ct,r=n;for(let o=0;o<t;o++){r=n,e.push(r);for(let s=1;s<2**(Q-1);s++)r=r.add(n),e.push(r);n=r.double()}return e},Ge,pr=e=>{let t=Ge||(Ge=xr()),n=(f,d)=>{let h=d.negate();return f?h:d},r=ht,o=ct,s=1+256/Q,i=2**(Q-1),c=BigInt(2**Q-1),a=2**Q,u=BigInt(Q);for(let f=0;f<s;f++){let d=f*i,h=Number(e&c);e>>=u,h>i&&(h-=a,e+=1n);let x=d,y=d+Math.abs(h)-1,w=f%2!==0,m=h<0;h===0?o=o.add(n(w,t[x])):r=r.add(n(m,t[y]))}return{p:r,f:o}};function br(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function oe(e,...t){if(!br(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function se(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function tn(e,t){oe(e);let n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function Rt(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function yr(e){if(typeof e!="string")throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}function ie(e){return typeof e=="string"&&(e=yr(e)),oe(e),e}var kt=class{clone(){return this._cloneInto()}};function en(e){let t=r=>e().update(ie(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function mr(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),c=Number(n&s),a=r?4:0,u=r?0:4;e.setUint32(t+a,i,r),e.setUint32(t+u,c,r)}var Tt=class extends kt{constructor(t,n,r,o){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Rt(this.buffer)}update(t){se(this);let{view:n,buffer:r,blockLen:o}=this;t=ie(t);let s=t.length;for(let i=0;i<s;){let c=Math.min(o-this.pos,s-i);if(c===o){let a=Rt(t);for(;o<=s-i;i+=o)this.process(a,i);continue}r.set(t.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){se(this),tn(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:o,isLE:s}=this,{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>o-i&&(this.process(r,0),i=0);for(let d=i;d<o;d++)n[d]=0;mr(r,o-8,BigInt(this.length*8),s),this.process(r,0);let c=Rt(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=a/4,f=this.get();if(u>f.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)c.setUint32(4*d,f[d],s)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:n,buffer:r,length:o,finished:s,destroyed:i,pos:c}=this;return t.length=o,t.pos=c,t.finished=s,t.destroyed=i,o%n&&t.buffer.set(r),t}};var Ht=BigInt(4294967295),ce=BigInt(32);function nn(e,t=!1){return t?{h:Number(e&Ht),l:Number(e>>ce&Ht)}:{h:Number(e>>ce&Ht)|0,l:Number(e&Ht)|0}}function gr(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let o=0;o<e.length;o++){let{h:s,l:i}=nn(e[o],t);[n[o],r[o]]=[s,i]}return[n,r]}var wr=(e,t)=>BigInt(e>>>0)<<ce|BigInt(t>>>0),vr=(e,t,n)=>e>>>n,Sr=(e,t,n)=>e<<32-n|t>>>n,Ar=(e,t,n)=>e>>>n|t<<32-n,Er=(e,t,n)=>e<<32-n|t>>>n,Br=(e,t,n)=>e<<64-n|t>>>n-32,Ir=(e,t,n)=>e>>>n-32|t<<64-n,Ur=(e,t)=>t,Kr=(e,t)=>e,Dr=(e,t,n)=>e<<n|t>>>32-n,Pr=(e,t,n)=>t<<n|e>>>32-n,kr=(e,t,n)=>t<<n-32|e>>>64-n,Rr=(e,t,n)=>e<<n-32|t>>>64-n;function Tr(e,t,n,r){let o=(t>>>0)+(r>>>0);return{h:e+n+(o/2**32|0)|0,l:o|0}}var Hr=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),Lr=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,Mr=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),Cr=(e,t,n,r,o)=>t+n+r+o+(e/2**32|0)|0,$r=(e,t,n,r,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(o>>>0),jr=(e,t,n,r,o,s)=>t+n+r+o+s+(e/2**32|0)|0;var Or={fromBig:nn,split:gr,toBig:wr,shrSH:vr,shrSL:Sr,rotrSH:Ar,rotrSL:Er,rotrBH:Br,rotrBL:Ir,rotr32H:Ur,rotr32L:Kr,rotlSH:Dr,rotlSL:Pr,rotlBH:kr,rotlBL:Rr,add:Tr,add3L:Hr,add3H:Lr,add4L:Mr,add4H:Cr,add5H:jr,add5L:$r},g=Or;var[Vr,Fr]=g.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),N=new Uint32Array(80),Z=new Uint32Array(80),ae=class extends Tt{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:n,Bh:r,Bl:o,Ch:s,Cl:i,Dh:c,Dl:a,Eh:u,El:f,Fh:d,Fl:h,Gh:x,Gl:y,Hh:w,Hl:m}=this;return[t,n,r,o,s,i,c,a,u,f,d,h,x,y,w,m]}set(t,n,r,o,s,i,c,a,u,f,d,h,x,y,w,m){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=o|0,this.Ch=s|0,this.Cl=i|0,this.Dh=c|0,this.Dl=a|0,this.Eh=u|0,this.El=f|0,this.Fh=d|0,this.Fl=h|0,this.Gh=x|0,this.Gl=y|0,this.Hh=w|0,this.Hl=m|0}process(t,n){for(let b=0;b<16;b++,n+=4)N[b]=t.getUint32(n),Z[b]=t.getUint32(n+=4);for(let b=16;b<80;b++){let A=N[b-15]|0,B=Z[b-15]|0,U=g.rotrSH(A,B,1)^g.rotrSH(A,B,8)^g.shrSH(A,B,7),R=g.rotrSL(A,B,1)^g.rotrSL(A,B,8)^g.shrSL(A,B,7),H=N[b-2]|0,C=Z[b-2]|0,wt=g.rotrSH(H,C,19)^g.rotrBH(H,C,61)^g.shrSH(H,C,6),Gt=g.rotrSL(H,C,19)^g.rotrBL(H,C,61)^g.shrSL(H,C,6),vt=g.add4L(R,Gt,Z[b-7],Z[b-16]),Nt=g.add4H(vt,U,wt,N[b-7],N[b-16]);N[b]=Nt|0,Z[b]=vt|0}let{Ah:r,Al:o,Bh:s,Bl:i,Ch:c,Cl:a,Dh:u,Dl:f,Eh:d,El:h,Fh:x,Fl:y,Gh:w,Gl:m,Hh:S,Hl:v}=this;for(let b=0;b<80;b++){let A=g.rotrSH(d,h,14)^g.rotrSH(d,h,18)^g.rotrBH(d,h,41),B=g.rotrSL(d,h,14)^g.rotrSL(d,h,18)^g.rotrBL(d,h,41),U=d&x^~d&w,R=h&y^~h&m,H=g.add5L(v,B,R,Fr[b],Z[b]),C=g.add5H(H,S,A,U,Vr[b],N[b]),wt=H|0,Gt=g.rotrSH(r,o,28)^g.rotrBH(r,o,34)^g.rotrBH(r,o,39),vt=g.rotrSL(r,o,28)^g.rotrBL(r,o,34)^g.rotrBL(r,o,39),Nt=r&s^r&c^s&c,Dn=o&i^o&a^i&a;S=w|0,v=m|0,w=x|0,m=y|0,x=d|0,y=h|0,{h:d,l:h}=g.add(u|0,f|0,C|0,wt|0),u=c|0,f=a|0,c=s|0,a=i|0,s=r|0,i=o|0;let ge=g.add3L(wt,vt,Dn);r=g.add3H(ge,C,Gt,Nt),o=ge|0}({h:r,l:o}=g.add(this.Ah|0,this.Al|0,r|0,o|0)),{h:s,l:i}=g.add(this.Bh|0,this.Bl|0,s|0,i|0),{h:c,l:a}=g.add(this.Ch|0,this.Cl|0,c|0,a|0),{h:u,l:f}=g.add(this.Dh|0,this.Dl|0,u|0,f|0),{h:d,l:h}=g.add(this.Eh|0,this.El|0,d|0,h|0),{h:x,l:y}=g.add(this.Fh|0,this.Fl|0,x|0,y|0),{h:w,l:m}=g.add(this.Gh|0,this.Gl|0,w|0,m|0),{h:S,l:v}=g.add(this.Hh|0,this.Hl|0,S|0,v|0),this.set(r,o,s,i,c,a,u,f,d,h,x,y,w,m,S,v)}roundClean(){N.fill(0),Z.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var Lt=en(()=>new ae);O.sha512Sync=(...e)=>Lt(O.concatBytes(...e));var tt=class e{static publicKeyToMultibase(t){let n=new Uint8Array([0,...t]),r=rn.encode("base58btc",n);return new TextDecoder().decode(r)}static resolve(t){let n=e.getDocument(t);return{didResolutionMetadata:{contentType:"application/did+ld+json",retrieved:new Date().toISOString()},didDocument:n,didDocumentMetadata:{}}}static fromPublicKey(t){let n=`did:stellar:${t}`;return e.getDocument(n)}static fromPrivateKey(t){let r=`did:stellar:${e.getPublicKey(t)}`;return e.getDocument(r)}static getPublicKey(t){let n=W.decodeEd25519SecretSeed(t),r=yt(n);return W.encodeEd25519PublicKey(r)}static getDocument(t){let n=`${t}#0`,r=t.split(":")[2],o=W.decodeEd25519PublicKey(r),s=e.publicKeyToMultibase(o),i=`{
            "@context": [
              "https://www.w3.org/ns/did/v1",
              "https://w3id.org/security/suites/ed25519-2020/v1"
            ],
            "id": "${t}",
            "verificationMethod": [
              {
                "id": "${n}",
                "type": "Ed25519VerificationKey2020",
                "controller": "${t}",
                "publicKeyMultibase": "${s}"
              }
            ],
            "authentication": [
              "${n}"
            ],
            "assertionMethod": [
              "${n}"
            ],
            "capabilityDelegation": [
              "${n}"
            ],
            "capabilityInvocation": [
              "${n}"
            ],
            "keyAgreement": [
              "${n}"
            ]
          }`;return JSON.parse(i)}};var An=Zt(Jt(),1);var le=2n**256n,nt=le-0x1000003d1n,ue=le-0x14551231950b75fc4402da1732fc9bebfn,hn=0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798n,xn=0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8n,pn={p:nt,n:ue,a:0n,b:7n,Gx:hn,Gy:xn},rt=32,on=e=>l(l(e*e)*e+pn.b),I=(e="")=>{throw new Error(e)},$t=e=>typeof e=="bigint",bn=e=>typeof e=="string",de=e=>$t(e)&&0n<e&&e<nt,yn=e=>$t(e)&&0n<e&&e<ue,zr=e=>e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array",Ct=(e,t)=>!zr(e)||typeof t=="number"&&t>0&&e.length!==t?I("Uint8Array expected"):e,gt=e=>new Uint8Array(e),he=(e,t)=>Ct(bn(e)?jt(e):gt(Ct(e)),t),l=(e,t=nt)=>{let n=e%t;return n>=0n?n:t+n},sn=e=>e instanceof F?e:I("Point expected"),F=class e{constructor(t,n,r){this.px=t,this.py=n,this.pz=r,Object.freeze(this)}static fromAffine(t){return t.x===0n&&t.y===0n?mt:new e(t.x,t.y,1n)}static fromHex(t){t=he(t);let n,r=t[0],o=t.subarray(1),s=an(o,0,rt),i=t.length;if(i===33&&[2,3].includes(r)){de(s)||I("Point hex invalid: x not FE");let c=_r(on(s)),a=(c&1n)===1n;(r&1)===1!==a&&(c=l(-c)),n=new e(s,c,1n)}return i===65&&r===4&&(n=new e(s,an(o,rt,2*rt),1n)),n?n.ok():I("Point invalid: not on curve")}static fromPrivateKey(t){return at.mul(fe(t))}get x(){return this.aff().x}get y(){return this.aff().y}equals(t){let{px:n,py:r,pz:o}=this,{px:s,py:i,pz:c}=sn(t),a=l(n*c),u=l(s*o),f=l(r*c),d=l(i*o);return a===u&&f===d}negate(){return new e(this.px,l(-this.py),this.pz)}double(){return this.add(this)}add(t){let{px:n,py:r,pz:o}=this,{px:s,py:i,pz:c}=sn(t),{a,b:u}=pn,f=0n,d=0n,h=0n,x=l(u*3n),y=l(n*s),w=l(r*i),m=l(o*c),S=l(n+r),v=l(s+i);S=l(S*v),v=l(y+w),S=l(S-v),v=l(n+o);let b=l(s+c);return v=l(v*b),b=l(y+m),v=l(v-b),b=l(r+o),f=l(i+c),b=l(b*f),f=l(w+m),b=l(b-f),h=l(a*v),f=l(x*m),h=l(f+h),f=l(w-h),h=l(w+h),d=l(f*h),w=l(y+y),w=l(w+y),m=l(a*m),v=l(x*v),w=l(w+m),m=l(y-m),m=l(a*m),v=l(v+m),y=l(w*v),d=l(d+y),y=l(b*v),f=l(S*f),f=l(f-y),y=l(S*w),h=l(b*h),h=l(h+y),new e(f,d,h)}mul(t,n=!0){if(!n&&t===0n)return mt;if(yn(t)||I("scalar invalid"),this.equals(at))return Nr(t).p;let r=mt,o=at;for(let s=this;t>0n;s=s.double(),t>>=1n)t&1n?r=r.add(s):n&&(o=o.add(s));return r}mulAddQUns(t,n,r){return this.mul(n,!1).add(t.mul(r,!1)).ok()}toAffine(){let{px:t,py:n,pz:r}=this;if(this.equals(mt))return{x:0n,y:0n};if(r===1n)return{x:t,y:n};let o=gn(r,nt);return l(r*o)!==1n&&I("inverse invalid"),{x:l(t*o),y:l(n*o)}}assertValidity(){let{x:t,y:n}=this.aff();return(!de(t)||!de(n))&&I("Point invalid: x or y"),l(n*n)===on(t)?this:I("Point invalid: not on curve")}multiply(t){return this.mul(t)}aff(){return this.toAffine()}ok(){return this.assertValidity()}toHex(t=!0){let{x:n,y:r}=this.aff();return(t?(r&1n)===0n?"02":"03":"04")+dn(n)+(t?"":dn(r))}toRawBytes(t=!0){return jt(this.toHex(t))}};F.BASE=new F(hn,xn,1n);F.ZERO=new F(0n,1n,0n);var{BASE:at,ZERO:mt}=F,mn=(e,t)=>e.toString(16).padStart(t,"0"),xe=e=>Array.from(Ct(e)).map(t=>mn(t,2)).join(""),V={_0:48,_9:57,A:65,F:70,a:97,f:102},cn=e=>{if(e>=V._0&&e<=V._9)return e-V._0;if(e>=V.A&&e<=V.F)return e-(V.A-10);if(e>=V.a&&e<=V.f)return e-(V.a-10)},jt=e=>{let t="hex invalid";if(!bn(e))return I(t);let n=e.length,r=n/2;if(n%2)return I(t);let o=gt(r);for(let s=0,i=0;s<r;s++,i+=2){let c=cn(e.charCodeAt(i)),a=cn(e.charCodeAt(i+1));if(c===void 0||a===void 0)return I(t);o[s]=c*16+a}return o},Ot=e=>BigInt("0x"+(xe(e)||"0")),an=(e,t,n)=>Ot(e.slice(t,n)),pe=e=>$t(e)&&e>=0n&&e<le?jt(mn(e,2*rt)):I("bigint expected"),dn=e=>xe(pe(e)),fn=(...e)=>{let t=gt(e.reduce((r,o)=>r+Ct(o).length,0)),n=0;return e.forEach(r=>{t.set(r,n),n+=r.length}),t},gn=(e,t)=>{(e===0n||t<=0n)&&I("no inverse n="+e+" mod="+t);let n=l(e,t),r=t,o=0n,s=1n,i=1n,c=0n;for(;n!==0n;){let a=r/n,u=r%n,f=o-i*a,d=s-c*a;r=n,n=u,o=i,s=c,i=f,c=d}return r===1n?l(o,t):I("no inverse")},_r=e=>{let t=1n;for(let n=e,r=(nt+1n)/4n;r>0n;r>>=1n)r&1n&&(t=t*n%nt),n=n*n%nt;return l(t*t)===e?t:I("sqrt invalid")},fe=e=>($t(e)||(e=Ot(he(e,rt))),yn(e)?e:I("private key invalid 3"));var be=(e,t=!0)=>F.fromPrivateKey(e).toRawBytes(t);var ln=()=>typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0,Mt;var wn=e=>{e=he(e),(e.length<rt+8||e.length>1024)&&I("expected 40-1024b");let t=l(Ot(e),ue-1n);return pe(t+1n)},vn={hexToBytes:jt,bytesToHex:xe,concatBytes:fn,bytesToNumberBE:Ot,numberToBytesBE:pe,mod:l,invert:gn,hmacSha256Async:(e,...t)=>E(void 0,null,function*(){let n=ln(),r=n&&n.subtle;if(!r)return I("etc.hmacSha256Async or crypto.subtle must be defined");let o=yield r.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);return gt(yield r.sign("HMAC",o,fn(...t)))}),hmacSha256Sync:Mt,hashToPrivateKey:wn,randomBytes:(e=32)=>{let t=ln();return(!t||!t.getRandomValues)&&I("crypto.getRandomValues must be defined"),t.getRandomValues(gt(e))}},Sn={normPrivateKeyToScalar:fe,isValidPrivateKey:e=>{try{return!!fe(e)}catch{return!1}},randomPrivateKey:()=>wn(vn.randomBytes(rt+16)),precompute:(e=8,t=at)=>(t.multiply(3n),t)};Object.defineProperties(vn,{hmacSha256Sync:{configurable:!1,get(){return Mt},set(e){Mt||(Mt=e)}}});var et=8,Gr=()=>{let e=[],t=256/et+1,n=at,r=n;for(let o=0;o<t;o++){r=n,e.push(r);for(let s=1;s<2**(et-1);s++)r=r.add(n),e.push(r);n=r.double()}return e},un,Nr=e=>{let t=un||(un=Gr()),n=(f,d)=>{let h=d.negate();return f?h:d},r=mt,o=at,s=1+256/et,i=2**(et-1),c=BigInt(2**et-1),a=2**et,u=BigInt(et);for(let f=0;f<s;f++){let d=f*i,h=Number(e&c);e>>=u,h>i&&(h-=a,e+=1n);let x=d,y=d+Math.abs(h)-1,w=f%2!==0,m=h<0;h===0?o=o.add(n(w,t[x])):r=r.add(n(m,t[y]))}return{p:r,f:o}};O.sha512Sync=(...e)=>Lt(O.concatBytes(...e));var ye=(()=>{class e{static MULTICODEC={ED25519_PUB:237,SECP256K1_PUB:231};static publicKeyToMultibase(n,r){let o,s;switch(r){case"ed25519":o=this.MULTICODEC.ED25519_PUB,s=32;break;case"secp256k1":o=this.MULTICODEC.SECP256K1_PUB,s=33;break;default:throw new Error(`Unsupported key type: ${r}`)}if(n.length!==s)throw new Error(`Invalid key length for ${r}. Expected ${s} bytes, got ${n.length}`);let i=new Uint8Array([o]),c=new Uint8Array([...i,1,...n]);return new TextDecoder().decode(An.encode("base58btc",c))}static resolve(n){let r=e.getDocument(n);return{didResolutionMetadata:{contentType:"application/did+ld+json",retrieved:new Date().toISOString()},didDocument:r,didDocumentMetadata:{}}}static generate(n){let r,o;return n==="secp256k1"&&(r=Sn.randomPrivateKey(),o=be(r)),n==="ed25519"&&(r=Je.randomPrivateKey(),o=yt(r)),{privateKey:r,publicKey:o,did:"did:key:"+e.publicKeyToMultibase(o,n)}}static fromPublicKey(n,r){let o=`did:key:${e.publicKeyToMultibase(n,r)}`;return e.getDocument(o)}static fromPrivateKey(n,r){let o;r==="secp256k1"&&(o=be(n)),r==="ed25519"&&(o=yt(n));let s=`did:key:${e.publicKeyToMultibase(o,r)}`;return e.getDocument(s)}static getDocument(n){let r=`${n}#0`,o=n.split(":")[2],s=o.startsWith("zQ3s")?"secp256k1":o.startsWith("z6Mk")?"ed25519":void 0;if(!s)throw new Error("Unsupported key type in DID");let a=`{
            "@context": [
              "https://www.w3.org/ns/did/v1"
            ],
            "id": "${n}",
            "verificationMethod": [
              {
                "id": "${r}",
                "type": "${s==="ed25519"?"Ed25519VerificationKey2020":"EcdsaSecp256k1VerificationKey2019"}",
                "controller": "${n}",
                "publicKeyMultibase": "${o}"
              }
            ],
            "authentication": [
              "${r}"
            ],
            "assertionMethod": [
              "${r}"
            ],
            "capabilityDelegation": [
              "${r}"
            ],
            "capabilityInvocation": [
              "${r}"
            ]
          }`;return JSON.parse(a)}}return e})();var z=class e{static fetchText(t){return E(this,null,function*(){return(yield e.fetchUrl(t)).text()})}static fetchJson(t){return E(this,null,function*(){return(yield e.fetchUrl(t)).json()})}static fetchUrl(t){return E(this,null,function*(){return yield fetch(t,{method:"GET",mode:"cors",cache:"no-cache",credentials:"omit",redirect:"follow",referrerPolicy:"no-referrer"})})}};var Vt=class{constructor(t){Object.defineProperty(this,"activeServer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.setActiveServer(t)}setActiveServer(t){this.activeServer=t}getServicesByType(t){return E(this,null,function*(){let n=`${this.activeServer}/api/dns/services/service/${t}`;try{return yield z.fetchJson(n)}catch(r){return console.warn(`No services found for ${n}`),console.error(r),[]}})}getServicesByTypeAndNetwork(t,n){return E(this,null,function*(){let r=`${this.activeServer}/api/dns/services/symbol/${n}/service/${t}`;try{return yield z.fetchJson(r)}catch(o){return console.warn(`No services found for ${r}`),console.error(o),[]}})}getServicesByNetwork(t){return E(this,null,function*(){let n=`${this.activeServer}/api/dns/services/symbol/${t}`;try{return yield z.fetchJson(n)}catch(r){return console.warn(`No services found for ${n}`),console.error(r),[]}})}getExternalIP(){return E(this,null,function*(){let t=`${this.activeServer}/api/dns/ipaddress`;try{return yield z.fetchText(t)}catch(n){return console.warn("Unable to find external IP."),console.error(n),""}})}};var Ft=class{constructor(){Object.defineProperty(this,"nameservers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"services",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.api=new Vt("")}getDnsServers(){return E(this,null,function*(){let t="https://chains.blockcore.net/services/DNS.json";try{return yield z.fetchJson(t)}catch(n){return console.warn(`Unable to retrieve DNS list, using fixed list instead. URL: ${t}`),console.error(n),[{url:"https://ns.blockcore.net",contact:"post@blockcore.net"},{url:"https://ns.coinvault.io",contact:"post@coinvault.io"},{url:"https://ns.seniorblockchain.io",contact:"post@seniorblockchain.io"}]}})}getNameServers(){return this.nameservers}getOnlineServicesByNetwork(t){return this.services.filter(n=>n.symbol===t&&n.online===!0)}getServices(){return this.services}load(t,n="Indexer"){return E(this,null,function*(){this.nameservers=t||(yield this.getDnsServers());let r=new Map;for(let s=0;s<this.nameservers.length;s++){let i=this.nameservers[s];i&&(this.api.setActiveServer(i.url),n&&(yield this.api.getServicesByType(n)).forEach(a=>r.set(a.domain,L(L({},r.get(a.domain)),a))))}this.services=Array.from(r.values());let o=this.getRandomInt(this.nameservers.length);this.api.setActiveServer(this.nameservers[o].url)})}getRandomInt(t){return Math.floor(Math.random()*t)}};function En(){return new me().build()}var me=class{identityServiceDomain="https://id.blockcore.net";resolve(t,n,r,o){return E(this,null,function*(){let s=`${this.identityServiceDomain}/1.0/identifiers/did:is:${n.id}`;return yield(yield fetch(s,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}})).json()})}load(){let t=new Ft;t.load(void 0,"Identity").then(()=>{let n=t.getServices().filter(o=>o.online);if(n.length===0)return;let r=this.getRandomInt(n.length);n[r]?.domain&&(this.identityServiceDomain="https://"+n[r]?.domain)})}getRandomInt(t){return Math.floor(Math.random()*t)}build(){return this.load(),{is:this.resolve.bind(this)}}};var Bn={getResolver:En};function qr(e,t){try{var n=e()}catch(r){return t(r)}return n&&n.then?n.then(void 0,t):n}function Xr(){let e=new Map;return function(t,n){try{let s=function(c){if(o)return c;let a=e.get(t.didUrl);return a!==void 0?a:Promise.resolve(n()).then(function(u){var f;return((f=u.didResolutionMetadata)==null?void 0:f.error)!=="notFound"&&e.set(t.didUrl,u),u})};var r=s;let o,i=function(){if(t.params&&t.params["no-cache"]==="true")return Promise.resolve(n()).then(function(c){return o=1,c})}();return Promise.resolve(i&&i.then?i.then(s):s(i))}catch(o){return Promise.reject(o)}}}function Yr(e,t){return t()}var Wr="(?:%[0-9a-fA-F]{2})",In=`(?:[a-zA-Z0-9._-]|${Wr})`,Jr="([a-z0-9]+)",Qr=`((?:${In}*:)*(${In}+))`,Un="[a-zA-Z0-9_.:%-]",to=`;${Un}+=${Un}*`,eo=`((${to})*)`,no="(/[^#?]*)?",ro="([?][^#]*)?",oo="(#.*)?",so=new RegExp(`^did:${Jr}:${Qr}${eo}${no}${ro}${oo}$`);function io(e){if(e===""||!e)return null;let t=e.match(so);if(t){let n={did:`did:${t[1]}:${t[2]}`,method:t[1],id:t[2],didUrl:e};if(t[4]){let r=t[4].slice(1).split(";");n.params={};for(let o of r){let s=o.split("=");n.params[s[0]]=s[1]}}return t[6]&&(n.path=t[6]),t[7]&&(n.query=t[7].slice(1)),t[8]&&(n.fragment=t[8].slice(1)),n}return null}var zt={didResolutionMetadata:{},didDocument:null,didDocumentMetadata:{}};function co(e){return function(t,n,r){try{return Promise.resolve(qr(function(){return Promise.resolve(e(t,n,r)).then(function(o){return q(L({},zt),{didResolutionMetadata:{contentType:"application/did+ld+json"},didDocument:o})})},function(o){return q(L({},zt),{didResolutionMetadata:{error:"notFound",message:o.toString()}})}))}catch(o){return Promise.reject(o)}}}var _t=class{constructor(t={},n={}){this.registry=void 0,this.cache=void 0,this.registry=t,this.cache=n.cache===!0?Xr():n.cache||Yr,n.legacyResolvers&&Object.keys(n.legacyResolvers).map(r=>{this.registry[r]||(this.registry[r]=co(n.legacyResolvers[r]))})}resolve(t,n={}){try{let r=this,o=io(t);if(o===null)return Promise.resolve(q(L({},zt),{didResolutionMetadata:{error:"invalidDid"}}));let s=r.registry[o.method];return s?Promise.resolve(r.cache(o,()=>s(o.did,o,r,n))):Promise.resolve(q(L({},zt),{didResolutionMetadata:{error:"unsupportedDidMethod"}}))}catch(r){return Promise.reject(r)}}};var Kn=class e{constructor(t){this.storageService=t;this.loadIdentities()}storageKey="identity-workbench-identities";identitiesSubject=new we([]);identities$=this.identitiesSubject.asObservable();loadIdentities(){let t=this.storageService.get(this.storageKey)||[];this.identitiesSubject.next(t)}saveIdentities(t){this.storageService.set(this.storageKey,t),this.identitiesSubject.next(t)}getAllIdentities(){return this.identities$}getIdentityById(t){return this.identitiesSubject.value.find(r=>r.id===t)}addIdentity(t){let n=new Date,r={id:t.id||`did:key:${Yt()}`,method:t.method||"key",publicKey:t.publicKey||"",privateKey:t.privateKey,name:t.name||`Identity ${this.identitiesSubject.value.length+1}`,description:t.description,created:n,updated:n,didDocument:t.didDocument},o=[...this.identitiesSubject.value,r];return this.saveIdentities(o),r}updateIdentity(t,n){let r=this.identitiesSubject.value,o=r.findIndex(c=>c.id===t);if(o===-1)throw new Error(`Identity with id ${t} not found`);let s=q(L(L({},r[o]),n),{updated:new Date}),i=[...r.slice(0,o),s,...r.slice(o+1)];return this.saveIdentities(i),s}deleteIdentity(t){let r=this.identitiesSubject.value.filter(o=>o.id!==t);this.saveIdentities(r)}importFromDIDString(t){return E(this,null,function*(){if(!t.startsWith("did:"))return null;try{let n=t.split(":");if(n.length<3)return null;let r=n[1];if(r==="key"){let o,s;return s=ye.resolve(t),o=s.didDocument,this.addIdentity({id:t,method:"key",publicKey:n[2],name:`Imported Key DID (${n[2].startsWith("z6Mk")?"Ed25519":"Secp256k1"})`,description:`Imported on ${new Date().toLocaleString()}`,didDocument:o})}if(r==="stellar"){let s=tt.resolve(t).didDocument;return this.addIdentity({id:t,method:"stellar",publicKey:n[2],name:"Imported Stellar DID",description:`Imported on ${new Date().toLocaleString()}`,didDocument:s})}if(r==="is"){let i=(yield new _t(Bn.getResolver()).resolve(t)).didDocument;return this.addIdentity({id:t,method:"is",publicKey:n[2],name:"Imported FreeID",description:`Imported on ${new Date().toLocaleString()}`,didDocument:i})}return this.addIdentity({id:t,method:r,publicKey:n.slice(2).join(":"),name:`Imported ${r.toUpperCase()} DID`,description:`Imported on ${new Date().toLocaleString()}`})}catch(n){return console.error("Error importing DID string:",n),null}})}importFromStellarKey(t,n=!1){try{if(!t||t.length<16)return null;let r,o,s,i;return n?(r=tt.fromPrivateKey(t),i=r.id,o=i.split(":")[2],s=t):(r=tt.fromPublicKey(t),i=r.id,o=t),this.addIdentity({id:i,method:"stellar",publicKey:o,privateKey:s,name:`Imported Stellar ${n?"Private":"Public"} Key`,description:`Imported on ${new Date().toLocaleString()}`,didDocument:r})}catch(r){return console.error("Error importing Stellar key:",r),null}}importFromJsonFile(t){if(!t||!t.id||!t.id.startsWith("did:"))return null;let n=t.id.split(":");if(n.length<3)return null;let r="";if(t.verificationMethod&&t.verificationMethod.length>0){for(let o of t.verificationMethod)if((o.type==="Ed25519VerificationKey2018"||o.type==="Ed25519VerificationKey2020")&&o.publicKeyBase58){r=o.publicKeyBase58;break}}return this.addIdentity({id:t.id,method:n[1],publicKey:r,name:`Imported ${n[1].toUpperCase()} DID Document`,description:`Imported on ${new Date().toLocaleString()}`,didDocument:t})}static \u0275fac=function(n){return new(n||e)(Se(Ae))};static \u0275prov=ve({token:e,factory:e.\u0275fac,providedIn:"root"})};export{Yt as a,Kn as b};
