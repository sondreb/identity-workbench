import{Od as Ls,Xa as Tr,Ya as ks,Za as Le,a as z,b as G,ca as Ss,d as ue,da as As,e as za,f as Br,fa as Bs,g as R,ha as Ts,ia as Is,ib as Ir,md as Ur,n as Es,qb as Us,rb as _s,yb as kr,zb as Ze}from"./chunk-ONE5RFGK.js";var Cs=ue(ft=>{"use strict";var mn=function(e,t){return t||(t={}),e.split("").forEach(function(n,r){n in t||(t[n]=r)}),t},Re={alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",charmap:{0:14,1:8}};Re.charmap=mn(Re.alphabet,Re.charmap);var yn={alphabet:"0123456789ABCDEFGHJKMNPQRSTVWXYZ",charmap:{O:0,I:1,L:1}};yn.charmap=mn(yn.alphabet,yn.charmap);var gn={alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",charmap:{}};gn.charmap=mn(gn.alphabet,gn.charmap);function Ge(e){if(this.buf=[],this.shift=8,this.carry=0,e){switch(e.type){case"rfc4648":this.charmap=ft.rfc4648.charmap;break;case"crockford":this.charmap=ft.crockford.charmap;break;case"base32hex":this.charmap=ft.base32hex.charmap;break;default:throw new Error("invalid type")}e.charmap&&(this.charmap=e.charmap)}}Ge.prototype.charmap=Re.charmap;Ge.prototype.write=function(e){var t=this.charmap,n=this.buf,r=this.shift,o=this.carry;return e.toUpperCase().split("").forEach(function(s){if(s!="="){var i=t[s]&255;r-=5,r>0?o|=i<<r:r<0?(n.push(o|i>>-r),r+=8,o=i<<r&255):(n.push(o|i),r=8,o=0)}}),this.shift=r,this.carry=o,this};Ge.prototype.finalize=function(e){return e&&this.write(e),this.shift!==8&&this.carry!==0&&(this.buf.push(this.carry),this.shift=8,this.carry=0),this.buf};function Fe(e){if(this.buf="",this.shift=3,this.carry=0,e){switch(e.type){case"rfc4648":this.alphabet=ft.rfc4648.alphabet;break;case"crockford":this.alphabet=ft.crockford.alphabet;break;case"base32hex":this.alphabet=ft.base32hex.alphabet;break;default:throw new Error("invalid type")}e.alphabet?this.alphabet=e.alphabet:e.lc&&(this.alphabet=this.alphabet.toLowerCase())}}Fe.prototype.alphabet=Re.alphabet;Fe.prototype.write=function(e){var t=this.shift,n=this.carry,r,o,s;for(s=0;s<e.length;s++)o=e[s],r=n|o>>t,this.buf+=this.alphabet[r&31],t>5&&(t-=5,r=o>>t,this.buf+=this.alphabet[r&31]),t=5-t,n=o<<t,t=8-t;return this.shift=t,this.carry=n,this};Fe.prototype.finalize=function(e){return e&&this.write(e),this.shift!==3&&(this.buf+=this.alphabet[this.carry&31],this.shift=3,this.carry=0),this.buf};ft.encode=function(e,t){return new Fe(t).finalize(e)};ft.decode=function(e,t){return new Ge(t).finalize(e)};ft.Decoder=Ge;ft.Encoder=Fe;ft.charmap=mn;ft.crockford=yn;ft.rfc4648=Re;ft.base32hex=gn});var Ps=ue((Zp,Ms)=>{"use strict";function el(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var r=0;r<e.length;r++){var o=e.charAt(r),s=o.charCodeAt(0);if(t[s]!==255)throw new TypeError(o+" is ambiguous");t[s]=r}var i=e.length,c=e.charAt(0),a=Math.log(i)/Math.log(256),l=Math.log(256)/Math.log(i);function u(y){if(y instanceof Uint8Array||(ArrayBuffer.isView(y)?y=new Uint8Array(y.buffer,y.byteOffset,y.byteLength):Array.isArray(y)&&(y=Uint8Array.from(y))),!(y instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(y.length===0)return"";for(var p=0,h=0,g=0,m=y.length;g!==m&&y[g]===0;)g++,p++;for(var b=(m-g)*l+1>>>0,x=new Uint8Array(b);g!==m;){for(var w=y[g],A=0,v=b-1;(w!==0||A<h)&&v!==-1;v--,A++)w+=256*x[v]>>>0,x[v]=w%i>>>0,w=w/i>>>0;if(w!==0)throw new Error("Non-zero carry");h=A,g++}for(var S=b-h;S!==b&&x[S]===0;)S++;for(var B=c.repeat(p);S<b;++S)B+=e.charAt(x[S]);return B}function f(y){if(typeof y!="string")throw new TypeError("Expected String");if(y.length===0)return new Uint8Array;var p=0;if(y[p]!==" "){for(var h=0,g=0;y[p]===c;)h++,p++;for(var m=(y.length-p)*a+1>>>0,b=new Uint8Array(m);y[p];){var x=t[y.charCodeAt(p)];if(x===255)return;for(var w=0,A=m-1;(x!==0||w<g)&&A!==-1;A--,w++)x+=i*b[A]>>>0,b[A]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");g=w,p++}if(y[p]!==" "){for(var v=m-g;v!==m&&b[v]===0;)v++;for(var S=new Uint8Array(h+(m-v)),B=h;v!==m;)S[B++]=b[v++];return S}}}function d(y){var p=f(y);if(p)return p;throw new Error("Non-base"+i+" character")}return{encode:u,decodeUnsafe:f,decode:d}}Ms.exports=el});var wn=ue((Gp,Ds)=>{"use strict";var nl=new TextDecoder,rl=e=>nl.decode(e),ol=new TextEncoder,sl=e=>ol.encode(e);function il(e,t){let n=new Uint8Array(t),r=0;for(let o of e)n.set(o,r),r+=o.length;return n}Ds.exports={decodeText:rl,encodeText:sl,concat:il}});var Ns=ue((Fp,Hs)=>{"use strict";var{encodeText:cl}=wn(),Cr=class{constructor(t,n,r,o){this.name=t,this.code=n,this.codeBuf=cl(this.code),this.alphabet=o,this.codec=r(o)}encode(t){return this.codec.encode(t)}decode(t){for(let n of t)if(this.alphabet&&this.alphabet.indexOf(n)<0)throw new Error(`invalid character '${n}' in '${t}'`);return this.codec.decode(t)}};Hs.exports=Cr});var Ks=ue((Jp,$s)=>{"use strict";var al=(e,t,n)=>{let r={};for(let l=0;l<t.length;++l)r[t[l]]=l;let o=e.length;for(;e[o-1]==="=";)--o;let s=new Uint8Array(o*n/8|0),i=0,c=0,a=0;for(let l=0;l<o;++l){let u=r[e[l]];if(u===void 0)throw new SyntaxError("Invalid character "+e[l]);c=c<<n|u,i+=n,i>=8&&(i-=8,s[a++]=255&c>>i)}if(i>=n||255&c<<8-i)throw new SyntaxError("Unexpected end of data");return s},ll=(e,t,n)=>{let r=t[t.length-1]==="=",o=(1<<n)-1,s="",i=0,c=0;for(let a=0;a<e.length;++a)for(c=c<<8|e[a],i+=8;i>n;)i-=n,s+=t[o&c>>i];if(i&&(s+=t[o&c<<n-i]),r)for(;s.length*n&7;)s+="=";return s},fl=e=>t=>({encode(n){return ll(n,t,e)},decode(n){return al(n,t,e)}});$s.exports={rfc4648:fl}});var Ws=ue((Xp,zs)=>{"use strict";var Xe=Ps(),ul=Ns(),{rfc4648:rt}=Ks(),{decodeText:dl,encodeText:hl}=wn(),pl=()=>({encode:dl,decode:hl}),js=[["identity","\0",pl,""],["base2","0",rt(1),"01"],["base8","7",rt(3),"01234567"],["base10","9",Xe,"0123456789"],["base16","f",rt(4),"0123456789abcdef"],["base16upper","F",rt(4),"0123456789ABCDEF"],["base32hex","v",rt(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",rt(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",rt(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",rt(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",rt(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",rt(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",rt(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",rt(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",rt(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",Xe,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",Xe,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",Xe,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",Xe,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",rt(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",rt(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",rt(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",rt(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],qs=js.reduce((e,t)=>(e[t[0]]=new ul(t[0],t[1],t[2],t[3]),e),{}),yl=js.reduce((e,t)=>(e[t[1]]=qs[t[0]],e),{});zs.exports={names:qs,codes:yl}});var Or=ue((Mt,Zs)=>{"use strict";var Ce=Ws(),{encodeText:gl,decodeText:vn,concat:Vs}=wn();function ml(e,t){if(!t)throw new Error("requires an encoded Uint8Array");let{name:n,codeBuf:r}=pe(e);return vl(n,t),Vs([r,t],r.length+t.length)}function bl(e,t){let n=pe(e),r=gl(n.encode(t));return Vs([n.codeBuf,r],n.codeBuf.length+r.length)}function xl(e){e instanceof Uint8Array&&(e=vn(e));let t=e[0];return["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(t)&&(e=e.toLowerCase()),pe(e[0]).decode(e.substring(1))}function wl(e){if(e instanceof Uint8Array&&(e=vn(e)),Object.prototype.toString.call(e)!=="[object String]")return!1;try{return pe(e[0]).name}catch{return!1}}function vl(e,t){pe(e).decode(vn(t))}function pe(e){if(Object.prototype.hasOwnProperty.call(Ce.names,e))return Ce.names[e];if(Object.prototype.hasOwnProperty.call(Ce.codes,e))return Ce.codes[e];throw new Error(`Unsupported encoding: ${e}`)}function El(e){return e instanceof Uint8Array&&(e=vn(e)),pe(e[0])}Mt=Zs.exports=ml;Mt.encode=bl;Mt.decode=xl;Mt.isEncoded=wl;Mt.encoding=pe;Mt.encodingFromData=El;var Sl=Object.freeze(Ce.names),Al=Object.freeze(Ce.codes);Mt.names=Sl;Mt.codes=Al});var Va=["*"];var Za=[[["","mat-card-avatar",""],["","matCardAvatar",""]],[["mat-card-title"],["mat-card-subtitle"],["","mat-card-title",""],["","mat-card-subtitle",""],["","matCardTitle",""],["","matCardSubtitle",""]],"*"],Ga=["[mat-card-avatar], [matCardAvatar]",`mat-card-title, mat-card-subtitle,
      [mat-card-title], [mat-card-subtitle],
      [matCardTitle], [matCardSubtitle]`,"*"],Fa=new Bs("MAT_CARD_CONFIG"),Ip=(()=>{class e{appearance;constructor(){let n=Is(Fa,{optional:!0});this.appearance=n?.appearance||"raised"}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Tr({type:e,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(r,o){r&2&&Ir("mat-mdc-card-outlined",o.appearance==="outlined")("mdc-card--outlined",o.appearance==="outlined")},inputs:{appearance:"appearance"},exportAs:["matCard"],ngContentSelectors:Va,decls:1,vars:0,template:function(r,o){r&1&&(kr(),Ze(0))},styles:['.mat-mdc-card{display:flex;flex-direction:column;box-sizing:border-box;position:relative;border-style:solid;border-width:0;background-color:var(--mdc-elevated-card-container-color, var(--mat-sys-surface-container-low));border-color:var(--mdc-elevated-card-container-color, var(--mat-sys-surface-container-low));border-radius:var(--mdc-elevated-card-container-shape, var(--mat-sys-corner-medium));box-shadow:var(--mdc-elevated-card-container-elevation, var(--mat-sys-level1))}.mat-mdc-card::after{position:absolute;top:0;left:0;width:100%;height:100%;border:solid 1px rgba(0,0,0,0);content:"";display:block;pointer-events:none;box-sizing:border-box;border-radius:var(--mdc-elevated-card-container-shape, var(--mat-sys-corner-medium))}.mat-mdc-card-outlined{background-color:var(--mdc-outlined-card-container-color, var(--mat-sys-surface));border-radius:var(--mdc-outlined-card-container-shape, var(--mat-sys-corner-medium));border-width:var(--mdc-outlined-card-outline-width, 1px);border-color:var(--mdc-outlined-card-outline-color, var(--mat-sys-outline-variant));box-shadow:var(--mdc-outlined-card-container-elevation, var(--mat-sys-level0))}.mat-mdc-card-outlined::after{border:none}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mat-mdc-card-actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mat-mdc-card-title{font-family:var(--mat-card-title-text-font, var(--mat-sys-title-large-font));line-height:var(--mat-card-title-text-line-height, var(--mat-sys-title-large-line-height));font-size:var(--mat-card-title-text-size, var(--mat-sys-title-large-size));letter-spacing:var(--mat-card-title-text-tracking, var(--mat-sys-title-large-tracking));font-weight:var(--mat-card-title-text-weight, var(--mat-sys-title-large-weight))}.mat-mdc-card-subtitle{color:var(--mat-card-subtitle-text-color, var(--mat-sys-on-surface));font-family:var(--mat-card-subtitle-text-font, var(--mat-sys-title-medium-font));line-height:var(--mat-card-subtitle-text-line-height, var(--mat-sys-title-medium-line-height));font-size:var(--mat-card-subtitle-text-size, var(--mat-sys-title-medium-size));letter-spacing:var(--mat-card-subtitle-text-tracking, var(--mat-sys-title-medium-tracking));font-weight:var(--mat-card-subtitle-text-weight, var(--mat-sys-title-medium-weight))}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}'],encapsulation:2,changeDetection:0})}return e})(),kp=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275dir=Le({type:e,selectors:[["mat-card-title"],["","mat-card-title",""],["","matCardTitle",""]],hostAttrs:[1,"mat-mdc-card-title"]})}return e})();var Up=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275dir=Le({type:e,selectors:[["mat-card-content"]],hostAttrs:[1,"mat-mdc-card-content"]})}return e})(),_p=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275dir=Le({type:e,selectors:[["mat-card-subtitle"],["","mat-card-subtitle",""],["","matCardSubtitle",""]],hostAttrs:[1,"mat-mdc-card-subtitle"]})}return e})(),Lp=(()=>{class e{align="start";static \u0275fac=function(r){return new(r||e)};static \u0275dir=Le({type:e,selectors:[["mat-card-actions"]],hostAttrs:[1,"mat-mdc-card-actions","mdc-card__actions"],hostVars:2,hostBindings:function(r,o){r&2&&Ir("mat-mdc-card-actions-align-end",o.align==="end")},inputs:{align:"align"},exportAs:["matCardActions"]})}return e})(),Rp=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Tr({type:e,selectors:[["mat-card-header"]],hostAttrs:[1,"mat-mdc-card-header"],ngContentSelectors:Ga,decls:4,vars:0,consts:[[1,"mat-mdc-card-header-text"]],template:function(r,o){r&1&&(kr(Za),Ze(0),Us(1,"div",0),Ze(2,1),_s(),Ze(3,2))},encapsulation:2,changeDetection:0})}return e})();var Cp=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275dir=Le({type:e,selectors:[["","mat-card-avatar",""],["","matCardAvatar",""]],hostAttrs:[1,"mat-mdc-card-avatar"]})}return e})();var Op=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=ks({type:e});static \u0275inj=As({imports:[Ur,Ur]})}return e})();var Ja=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),_r={randomUUID:Ja};var pn,Xa=new Uint8Array(16);function Lr(){if(!pn&&(pn=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!pn))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return pn(Xa)}var nt=[];for(let e=0;e<256;++e)nt.push((e+256).toString(16).slice(1));function Rs(e,t=0){return nt[e[t+0]]+nt[e[t+1]]+nt[e[t+2]]+nt[e[t+3]]+"-"+nt[e[t+4]]+nt[e[t+5]]+"-"+nt[e[t+6]]+nt[e[t+7]]+"-"+nt[e[t+8]]+nt[e[t+9]]+"-"+nt[e[t+10]]+nt[e[t+11]]+nt[e[t+12]]+nt[e[t+13]]+nt[e[t+14]]+nt[e[t+15]]}function Ya(e,t,n){if(_r.randomUUID&&!t&&!e)return _r.randomUUID();e=e||{};let r=e.random||(e.rng||Lr)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){n=n||0;for(let o=0;o<16;++o)t[n+o]=r[o];return t}return Rs(r)}var Rr=Ya;var bn=Br(Cs(),1);function Qa(e,t){if(e.length!==t.length)return!1;if(e.length===0)return!0;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0}var xn={ed25519PublicKey:48,ed25519SecretSeed:144,med25519PublicKey:96,preAuthTx:152,sha256Hash:184,signedPayload:120,contract:16},tl={G:"ed25519PublicKey",S:"ed25519SecretSeed",M:"med25519PublicKey",T:"preAuthTx",X:"sha256Hash",P:"signedPayload",C:"contract"},he=class{static encodeEd25519PublicKey(t){return de("ed25519PublicKey",t)}static decodeEd25519PublicKey(t){return Gt("ed25519PublicKey",t)}static isValidEd25519PublicKey(t){return Je("ed25519PublicKey",t)}static encodeEd25519SecretSeed(t){return de("ed25519SecretSeed",t)}static decodeEd25519SecretSeed(t){return Gt("ed25519SecretSeed",t)}static isValidEd25519SecretSeed(t){return Je("ed25519SecretSeed",t)}static encodeMed25519PublicKey(t){return de("med25519PublicKey",t)}static decodeMed25519PublicKey(t){return Gt("med25519PublicKey",t)}static isValidMed25519PublicKey(t){return Je("med25519PublicKey",t)}static encodePreAuthTx(t){return de("preAuthTx",t)}static decodePreAuthTx(t){return Gt("preAuthTx",t)}static encodeSha256Hash(t){return de("sha256Hash",t)}static decodeSha256Hash(t){return Gt("sha256Hash",t)}static encodeSignedPayload(t){return de("signedPayload",t)}static decodeSignedPayload(t){return Gt("signedPayload",t)}static isValidSignedPayload(t){return Je("signedPayload",t)}static encodeContract(t){return de("contract",t)}static decodeContract(t){return Gt("contract",t)}static isValidContract(t){return Je("contract",t)}static getVersionByteForPrefix(t){return tl[t[0]]}};function Je(e,t){if(typeof t!="string")return!1;switch(e){case"ed25519PublicKey":case"ed25519SecretSeed":case"preAuthTx":case"sha256Hash":case"contract":if(t.length!==56)return!1;break;case"med25519PublicKey":if(t.length!==69)return!1;break;case"signedPayload":if(t.length<56||t.length>165)return!1;break;default:return!1}let n="";try{n=Gt(e,t)}catch{return!1}switch(e){case"ed25519PublicKey":case"ed25519SecretSeed":case"preAuthTx":case"sha256Hash":case"contract":return n.length===32;case"med25519PublicKey":return n.length===40;case"signedPayload":return n.length>=40&&n.length<=100;default:return!1}}function Gt(e,t){if(typeof t!="string")throw new TypeError("encoded argument must be of type String");let n=bn.default.decode(t),r=n[0],o=n.slice(0,-2),s=o.slice(1),i=n.slice(-2);if(t!==bn.default.encode(n))throw new Error("invalid encoded string");let c=xn[e];if(c===void 0)throw new Error(`${e} is not a valid version byte name. Expected one of ${Object.keys(xn).join(", ")}`);if(r!==c)throw new Error(`invalid version byte. expected ${c}, got ${r}`);let a=Os(o);if(!Qa(a,i))throw new Error("invalid checksum");return new Uint8Array(s)}function de(e,t){if(t==null)throw new Error("cannot encode null data");let n=xn[e];if(n===void 0)throw new Error(`${e} is not a valid version byte name. Expected one of ${Object.keys(xn).join(", ")}`);t=new Uint8Array(t);let r=new Uint8Array([n]),o=new Uint8Array(r.length+t.length);o.set(r,0),o.set(t,r.length);let s=new Uint8Array(Os(o)),i=new Uint8Array(o.length+s.length);return i.set(o,0),i.set(s,o.length),bn.default.encode(i)}function Os(e){let t=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920],n=0;for(let o=0;o<e.length;o+=1){let s=e[o],i=n>>8^s;n=n<<8^t[i],n&=65535}let r=new Uint8Array(2);return r[0]=n&255,r[1]=n>>8&255,r}var di=Br(Or(),1);var ot=2n**255n-19n,Qe=2n**252n+27742317777372353535851937790883648493n,Mr=0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51an,Pr=0x6666666666666666666666666666666666666666666666666666666666666658n,Bl=37095705934669439343138083508754565189542113879843219016388785533085940283555n,En={a:-1n,d:Bl,p:ot,n:Qe,h:8,Gx:Mr,Gy:Pr},st=(e="")=>{throw new Error(e)},ti=e=>typeof e=="string",Tl=e=>e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array",en=(e,t)=>!Tl(e)||typeof t=="number"&&t>0&&e.length!==t?st("Uint8Array of valid length expected"):e,Oe=e=>new Uint8Array(e),Dr=(e,t)=>en(ti(e)?Nr(e):Oe(en(e)),t),M=(e,t=ot)=>{let n=e%t;return n>=0n?n:t+n},Gs=e=>e instanceof Ft?e:st("Point expected"),Ft=class e{constructor(t,n,r,o){this.ex=t,this.ey=n,this.ez=r,this.et=o}static fromAffine(t){return new e(t.x,t.y,1n,M(t.x*t.y))}static fromHex(t,n=!1){let{d:r}=En;t=Dr(t,32);let o=t.slice(),s=t[31];o[31]=s&-129;let i=ni(o);n&&!(0n<=i&&i<2n**256n)&&st("bad y coord 1"),!n&&!(0n<=i&&i<ot)&&st("bad y coord 2");let c=M(i*i),a=M(c-1n),l=M(r*c+1n),{isValid:u,value:f}=Ul(a,l);u||st("bad y coordinate 3");let d=(f&1n)===1n,y=(s&128)!==0;return!n&&f===0n&&y&&st("bad y coord 3"),y!==d&&(f=M(-f)),new e(f,i,1n,M(f*i))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}equals(t){let{ex:n,ey:r,ez:o}=this,{ex:s,ey:i,ez:c}=Gs(t),a=M(n*c),l=M(s*o),u=M(r*c),f=M(i*o);return a===l&&u===f}is0(){return this.equals(Ye)}negate(){return new e(M(-this.ex),this.ey,this.ez,M(-this.et))}double(){let{ex:t,ey:n,ez:r}=this,{a:o}=En,s=M(t*t),i=M(n*n),c=M(2n*M(r*r)),a=M(o*s),l=t+n,u=M(M(l*l)-s-i),f=a+i,d=f-c,y=a-i,p=M(u*d),h=M(f*y),g=M(u*y),m=M(d*f);return new e(p,h,m,g)}add(t){let{ex:n,ey:r,ez:o,et:s}=this,{ex:i,ey:c,ez:a,et:l}=Gs(t),{a:u,d:f}=En,d=M(n*i),y=M(r*c),p=M(s*f*l),h=M(o*a),g=M((n+r)*(i+c)-d-y),m=M(h-p),b=M(h+p),x=M(y-u*d),w=M(g*m),A=M(b*x),v=M(g*x),S=M(m*b);return new e(w,A,S,v)}mul(t,n=!0){if(t===0n)return n===!0?st("cannot multiply by 0"):Ye;if(typeof t=="bigint"&&0n<t&&t<Qe||st("invalid scalar, must be < L"),!n&&this.is0()||t===1n)return this;if(this.equals(Me))return Ml(t).p;let r=Ye,o=Me;for(let s=this;t>0n;s=s.double(),t>>=1n)t&1n?r=r.add(s):n&&(o=o.add(s));return r}multiply(t){return this.mul(t)}clearCofactor(){return this.mul(BigInt(En.h),!1)}isSmallOrder(){return this.clearCofactor().is0()}isTorsionFree(){let t=this.mul(Qe/2n,!1).double();return Qe%2n&&(t=t.add(this)),t.is0()}toAffine(){let{ex:t,ey:n,ez:r}=this;if(this.equals(Ye))return{x:0n,y:1n};let o=ri(r,ot);return M(r*o)!==1n&&st("invalid inverse"),{x:M(t*o),y:M(n*o)}}toRawBytes(){let{x:t,y:n}=this.toAffine(),r=Il(n);return r[31]|=t&1n?128:0,r}toHex(){return Hr(this.toRawBytes())}};Ft.BASE=new Ft(Mr,Pr,1n,M(Mr*Pr));Ft.ZERO=new Ft(0n,1n,1n,0n);var{BASE:Me,ZERO:Ye}=Ft,ei=(e,t)=>e.toString(16).padStart(t,"0"),Hr=e=>Array.from(en(e)).map(t=>ei(t,2)).join(""),Pt={_0:48,_9:57,A:65,F:70,a:97,f:102},Fs=e=>{if(e>=Pt._0&&e<=Pt._9)return e-Pt._0;if(e>=Pt.A&&e<=Pt.F)return e-(Pt.A-10);if(e>=Pt.a&&e<=Pt.f)return e-(Pt.a-10)},Nr=e=>{let t="hex invalid";if(!ti(e))return st(t);let n=e.length,r=n/2;if(n%2)return st(t);let o=Oe(r);for(let s=0,i=0;s<r;s++,i+=2){let c=Fs(e.charCodeAt(i)),a=Fs(e.charCodeAt(i+1));if(c===void 0||a===void 0)return st(t);o[s]=c*16+a}return o},Il=e=>Nr(ei(e,32*2)).reverse(),ni=e=>BigInt("0x"+Hr(Oe(en(e)).reverse())),Js=(...e)=>{let t=Oe(e.reduce((r,o)=>r+en(o).length,0)),n=0;return e.forEach(r=>{t.set(r,n),n+=r.length}),t},ri=(e,t)=>{(e===0n||t<=0n)&&st("no inverse n="+e+" mod="+t);let n=M(e,t),r=t,o=0n,s=1n,i=1n,c=0n;for(;n!==0n;){let a=r/n,l=r%n,u=o-i*a,f=s-c*a;r=n,n=l,o=i,s=c,i=u,c=f}return r===1n?M(o,t):st("no inverse")},Ut=(e,t)=>{let n=e;for(;t-- >0n;)n*=n,n%=ot;return n},kl=e=>{let n=e*e%ot*e%ot,r=Ut(n,2n)*n%ot,o=Ut(r,1n)*e%ot,s=Ut(o,5n)*o%ot,i=Ut(s,10n)*s%ot,c=Ut(i,20n)*i%ot,a=Ut(c,40n)*c%ot,l=Ut(a,80n)*a%ot,u=Ut(l,80n)*a%ot,f=Ut(u,10n)*s%ot;return{pow_p_5_8:Ut(f,2n)*e%ot,b2:n}},Xs=19681161376707505956807079304988542015446066515923890162744021073123829784752n,Ul=(e,t)=>{let n=M(t*t*t),r=M(n*n*t),o=kl(e*r).pow_p_5_8,s=M(e*n*o),i=M(t*s*s),c=s,a=M(s*Xs),l=i===e,u=i===M(-e),f=i===M(-e*Xs);return l&&(s=c),(u||f)&&(s=a),(M(s)&1n)===1n&&(s=M(-s)),{isValid:l||u,value:s}},_l=e=>M(ni(e),Qe),tn,Ll=(...e)=>Dt.sha512Async(...e),Rl=(...e)=>typeof tn=="function"?tn(...e):st("etc.sha512Sync not set"),oi=e=>{let t=e.slice(0,32);t[0]&=248,t[31]&=127,t[31]|=64;let n=e.slice(32,64),r=_l(t),o=Me.mul(r),s=o.toRawBytes();return{head:t,prefix:n,scalar:r,point:o,pointBytes:s}},Cl=e=>Ll(Dr(e,32)).then(oi),si=e=>oi(Rl(Dr(e,32)));var nn=e=>si(e).pointBytes;var Ys=()=>typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0,Dt={bytesToHex:Hr,hexToBytes:Nr,concatBytes:Js,mod:M,invert:ri,randomBytes:(e=32)=>{let t=Ys();return(!t||!t.getRandomValues)&&st("crypto.getRandomValues must be defined"),t.getRandomValues(Oe(e))},sha512Async:(...e)=>R(void 0,null,function*(){let t=Ys(),n=t&&t.subtle;n||st("etc.sha512Async or crypto.subtle must be defined");let r=Js(...e);return Oe(yield n.digest("SHA-512",r.buffer))}),sha512Sync:void 0};Object.defineProperties(Dt,{sha512Sync:{configurable:!1,get(){return tn},set(e){tn||(tn=e)}}});var ii={getExtendedPublicKeyAsync:Cl,getExtendedPublicKey:si,randomPrivateKey:()=>Dt.randomBytes(32),precompute:(e=8,t=Me)=>(t.multiply(3n),t)},ye=8,Ol=()=>{let e=[],t=256/ye+1,n=Me,r=n;for(let o=0;o<t;o++){r=n,e.push(r);for(let s=1;s<2**(ye-1);s++)r=r.add(n),e.push(r);n=r.double()}return e},Qs,Ml=e=>{let t=Qs||(Qs=Ol()),n=(u,f)=>{let d=f.negate();return u?d:f},r=Ye,o=Me,s=1+256/ye,i=2**(ye-1),c=BigInt(2**ye-1),a=2**ye,l=BigInt(ye);for(let u=0;u<s;u++){let f=u*i,d=Number(e&c);e>>=l,d>i&&(d-=a,e+=1n);let y=f,p=f+Math.abs(d)-1,h=u%2!==0,g=d<0;d===0?o=o.add(n(h,t[y])):r=r.add(n(g,t[p]))}return{p:r,f:o}};function ai(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Pl(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Sn(e,...t){if(!Pl(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Qp(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");ai(e.outputLen),ai(e.blockLen)}function $r(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function li(e,t){Sn(e);let n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}var ge=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function oy(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function Bn(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function sy(e,t){return e<<32-t|e>>>t}function iy(e,t){return e<<t|e>>>32-t>>>0}var cy=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Dl(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function ay(e){for(let t=0;t<e.length;t++)e[t]=Dl(e[t])}function Hl(e){if(typeof e!="string")throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}function Tn(e){return typeof e=="string"&&(e=Hl(e)),Sn(e),e}function ly(...e){let t=0;for(let r=0;r<e.length;r++){let o=e[r];Sn(o),t+=o.length}let n=new Uint8Array(t);for(let r=0,o=0;r<e.length;r++){let s=e[r];n.set(s,o),o+=s.length}return n}var An=class{clone(){return this._cloneInto()}};function fi(e){let t=r=>e().update(Tn(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function fy(e){let t=(r,o)=>e(o).update(Tn(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function uy(e=32){if(ge&&typeof ge.getRandomValues=="function")return ge.getRandomValues(new Uint8Array(e));if(ge&&typeof ge.randomBytes=="function")return ge.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}function Nl(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),c=Number(n&s),a=r?4:0,l=r?0:4;e.setUint32(t+a,i,r),e.setUint32(t+l,c,r)}function gy(e,t,n){return e&t^~e&n}function my(e,t,n){return e&t^e&n^t&n}var In=class extends An{constructor(t,n,r,o){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Bn(this.buffer)}update(t){$r(this);let{view:n,buffer:r,blockLen:o}=this;t=Tn(t);let s=t.length;for(let i=0;i<s;){let c=Math.min(o-this.pos,s-i);if(c===o){let a=Bn(t);for(;o<=s-i;i+=o)this.process(a,i);continue}r.set(t.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){$r(this),li(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:o,isLE:s}=this,{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>o-i&&(this.process(r,0),i=0);for(let f=i;f<o;f++)n[f]=0;Nl(r,o-8,BigInt(this.length*8),s),this.process(r,0);let c=Bn(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=a/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<l;f++)c.setUint32(4*f,u[f],s)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:n,buffer:r,length:o,finished:s,destroyed:i,pos:c}=this;return t.length=o,t.pos=c,t.finished=s,t.destroyed=i,o%n&&t.buffer.set(r),t}};var kn=BigInt(4294967295),Kr=BigInt(32);function ui(e,t=!1){return t?{h:Number(e&kn),l:Number(e>>Kr&kn)}:{h:Number(e>>Kr&kn)|0,l:Number(e&kn)|0}}function $l(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let o=0;o<e.length;o++){let{h:s,l:i}=ui(e[o],t);[n[o],r[o]]=[s,i]}return[n,r]}var Kl=(e,t)=>BigInt(e>>>0)<<Kr|BigInt(t>>>0),jl=(e,t,n)=>e>>>n,ql=(e,t,n)=>e<<32-n|t>>>n,zl=(e,t,n)=>e>>>n|t<<32-n,Wl=(e,t,n)=>e<<32-n|t>>>n,Vl=(e,t,n)=>e<<64-n|t>>>n-32,Zl=(e,t,n)=>e>>>n-32|t<<64-n,Gl=(e,t)=>t,Fl=(e,t)=>e,Jl=(e,t,n)=>e<<n|t>>>32-n,Xl=(e,t,n)=>t<<n|e>>>32-n,Yl=(e,t,n)=>t<<n-32|e>>>64-n,Ql=(e,t,n)=>e<<n-32|t>>>64-n;function tf(e,t,n,r){let o=(t>>>0)+(r>>>0);return{h:e+n+(o/2**32|0)|0,l:o|0}}var ef=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),nf=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,rf=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),of=(e,t,n,r,o)=>t+n+r+o+(e/2**32|0)|0,sf=(e,t,n,r,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(o>>>0),cf=(e,t,n,r,o,s)=>t+n+r+o+s+(e/2**32|0)|0;var af={fromBig:ui,split:$l,toBig:Kl,shrSH:jl,shrSL:ql,rotrSH:zl,rotrSL:Wl,rotrBH:Vl,rotrBL:Zl,rotr32H:Gl,rotr32L:Fl,rotlSH:Jl,rotlSL:Xl,rotlBH:Yl,rotlBL:Ql,add:tf,add3L:ef,add3H:nf,add4L:rf,add4H:of,add5H:cf,add5L:sf},$=af;var[lf,ff]=$.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),Jt=new Uint32Array(80),Xt=new Uint32Array(80),jr=class extends In{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:n,Bh:r,Bl:o,Ch:s,Cl:i,Dh:c,Dl:a,Eh:l,El:u,Fh:f,Fl:d,Gh:y,Gl:p,Hh:h,Hl:g}=this;return[t,n,r,o,s,i,c,a,l,u,f,d,y,p,h,g]}set(t,n,r,o,s,i,c,a,l,u,f,d,y,p,h,g){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=o|0,this.Ch=s|0,this.Cl=i|0,this.Dh=c|0,this.Dl=a|0,this.Eh=l|0,this.El=u|0,this.Fh=f|0,this.Fl=d|0,this.Gh=y|0,this.Gl=p|0,this.Hh=h|0,this.Hl=g|0}process(t,n){for(let x=0;x<16;x++,n+=4)Jt[x]=t.getUint32(n),Xt[x]=t.getUint32(n+=4);for(let x=16;x<80;x++){let w=Jt[x-15]|0,A=Xt[x-15]|0,v=$.rotrSH(w,A,1)^$.rotrSH(w,A,8)^$.shrSH(w,A,7),S=$.rotrSL(w,A,1)^$.rotrSL(w,A,8)^$.shrSL(w,A,7),B=Jt[x-2]|0,C=Xt[x-2]|0,O=$.rotrSH(B,C,19)^$.rotrBH(B,C,61)^$.shrSH(B,C,6),_=$.rotrSL(B,C,19)^$.rotrBL(B,C,61)^$.shrSL(B,C,6),D=$.add4L(S,_,Xt[x-7],Xt[x-16]),H=$.add4H(D,v,O,Jt[x-7],Jt[x-16]);Jt[x]=H|0,Xt[x]=D|0}let{Ah:r,Al:o,Bh:s,Bl:i,Ch:c,Cl:a,Dh:l,Dl:u,Eh:f,El:d,Fh:y,Fl:p,Gh:h,Gl:g,Hh:m,Hl:b}=this;for(let x=0;x<80;x++){let w=$.rotrSH(f,d,14)^$.rotrSH(f,d,18)^$.rotrBH(f,d,41),A=$.rotrSL(f,d,14)^$.rotrSL(f,d,18)^$.rotrBL(f,d,41),v=f&y^~f&h,S=d&p^~d&g,B=$.add5L(b,A,S,ff[x],Xt[x]),C=$.add5H(B,m,w,v,lf[x],Jt[x]),O=B|0,_=$.rotrSH(r,o,28)^$.rotrBH(r,o,34)^$.rotrBH(r,o,39),D=$.rotrSL(r,o,28)^$.rotrBL(r,o,34)^$.rotrBL(r,o,39),H=r&s^r&c^s&c,W=o&i^o&a^i&a;m=h|0,b=g|0,h=y|0,g=p|0,y=f|0,p=d|0,{h:f,l:d}=$.add(l|0,u|0,C|0,O|0),l=c|0,u=a|0,c=s|0,a=i|0,s=r|0,i=o|0;let E=$.add3L(O,D,W);r=$.add3H(E,C,_,H),o=E|0}({h:r,l:o}=$.add(this.Ah|0,this.Al|0,r|0,o|0)),{h:s,l:i}=$.add(this.Bh|0,this.Bl|0,s|0,i|0),{h:c,l:a}=$.add(this.Ch|0,this.Cl|0,c|0,a|0),{h:l,l:u}=$.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:f,l:d}=$.add(this.Eh|0,this.El|0,f|0,d|0),{h:y,l:p}=$.add(this.Fh|0,this.Fl|0,y|0,p|0),{h,l:g}=$.add(this.Gh|0,this.Gl|0,h|0,g|0),{h:m,l:b}=$.add(this.Hh|0,this.Hl|0,m|0,b|0),this.set(r,o,s,i,c,a,l,u,f,d,y,p,h,g,m,b)}roundClean(){Jt.fill(0),Xt.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var Un=fi(()=>new jr);Dt.sha512Sync=(...e)=>Un(Dt.concatBytes(...e));var me=class e{static publicKeyToMultibase(t){let n=new Uint8Array([0,...t]),r=di.encode("base58btc",n);return new TextDecoder().decode(r)}static resolve(t){let n=e.getDocument(t);return{didResolutionMetadata:{contentType:"application/did+ld+json",retrieved:new Date().toISOString()},didDocument:n,didDocumentMetadata:{}}}static fromPublicKey(t){let n=`did:stellar:${t}`;return e.getDocument(n)}static fromPrivateKey(t){let r=`did:stellar:${e.getPublicKey(t)}`;return e.getDocument(r)}static getPublicKey(t){let n=he.decodeEd25519SecretSeed(t),r=nn(n);return he.encodeEd25519PublicKey(r)}static getDocument(t){let n=`${t}#0`,r=t.split(":")[2],o=he.decodeEd25519PublicKey(r),s=e.publicKeyToMultibase(o),i=`{
            "@context": [
              "https://www.w3.org/ns/did/v1",
              "https://w3id.org/security/suites/ed25519-2020/v1"
            ],
            "id": "${t}",
            "verificationMethod": [
              {
                "id": "${n}",
                "type": "Ed25519VerificationKey2020",
                "controller": "${t}",
                "publicKeyMultibase": "${s}"
              }
            ],
            "authentication": [
              "${n}"
            ],
            "assertionMethod": [
              "${n}"
            ],
            "capabilityDelegation": [
              "${n}"
            ],
            "capabilityInvocation": [
              "${n}"
            ]
          }`;return JSON.parse(i)}};var Li=Br(Or(),1);var Wr=2n**256n,xe=Wr-0x1000003d1n,Vr=Wr-0x14551231950b75fc4402da1732fc9bebfn,vi=0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798n,Ei=0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8n,Si={p:xe,n:Vr,a:0n,b:7n,Gx:vi,Gy:Ei},we=32,hi=e=>L(L(e*e)*e+Si.b),X=(e="")=>{throw new Error(e)},Rn=e=>typeof e=="bigint",Ai=e=>typeof e=="string",qr=e=>Rn(e)&&0n<e&&e<xe,Bi=e=>Rn(e)&&0n<e&&e<Vr,uf=e=>e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array",Ln=(e,t)=>!uf(e)||typeof t=="number"&&t>0&&e.length!==t?X("Uint8Array expected"):e,on=e=>new Uint8Array(e),Zr=(e,t)=>Ln(Ai(e)?Cn(e):on(Ln(e)),t),L=(e,t=xe)=>{let n=e%t;return n>=0n?n:t+n},pi=e=>e instanceof Nt?e:X("Point expected"),Nt=class e{constructor(t,n,r){this.px=t,this.py=n,this.pz=r,Object.freeze(this)}static fromAffine(t){return t.x===0n&&t.y===0n?rn:new e(t.x,t.y,1n)}static fromHex(t){t=Zr(t);let n,r=t[0],o=t.subarray(1),s=gi(o,0,we),i=t.length;if(i===33&&[2,3].includes(r)){qr(s)||X("Point hex invalid: x not FE");let c=df(hi(s)),a=(c&1n)===1n;(r&1)===1!==a&&(c=L(-c)),n=new e(s,c,1n)}return i===65&&r===4&&(n=new e(s,gi(o,we,2*we),1n)),n?n.ok():X("Point invalid: not on curve")}static fromPrivateKey(t){return Pe.mul(zr(t))}get x(){return this.aff().x}get y(){return this.aff().y}equals(t){let{px:n,py:r,pz:o}=this,{px:s,py:i,pz:c}=pi(t),a=L(n*c),l=L(s*o),u=L(r*c),f=L(i*o);return a===l&&u===f}negate(){return new e(this.px,L(-this.py),this.pz)}double(){return this.add(this)}add(t){let{px:n,py:r,pz:o}=this,{px:s,py:i,pz:c}=pi(t),{a,b:l}=Si,u=0n,f=0n,d=0n,y=L(l*3n),p=L(n*s),h=L(r*i),g=L(o*c),m=L(n+r),b=L(s+i);m=L(m*b),b=L(p+h),m=L(m-b),b=L(n+o);let x=L(s+c);return b=L(b*x),x=L(p+g),b=L(b-x),x=L(r+o),u=L(i+c),x=L(x*u),u=L(h+g),x=L(x-u),d=L(a*b),u=L(y*g),d=L(u+d),u=L(h-d),d=L(h+d),f=L(u*d),h=L(p+p),h=L(h+p),g=L(a*g),b=L(y*b),h=L(h+g),g=L(p-g),g=L(a*g),b=L(b+g),p=L(h*b),f=L(f+p),p=L(x*b),u=L(m*u),u=L(u-p),p=L(m*h),d=L(x*d),d=L(d+p),new e(u,f,d)}mul(t,n=!0){if(!n&&t===0n)return rn;if(Bi(t)||X("scalar invalid"),this.equals(Pe))return pf(t).p;let r=rn,o=Pe;for(let s=this;t>0n;s=s.double(),t>>=1n)t&1n?r=r.add(s):n&&(o=o.add(s));return r}mulAddQUns(t,n,r){return this.mul(n,!1).add(t.mul(r,!1)).ok()}toAffine(){let{px:t,py:n,pz:r}=this;if(this.equals(rn))return{x:0n,y:0n};if(r===1n)return{x:t,y:n};let o=Ii(r,xe);return L(r*o)!==1n&&X("inverse invalid"),{x:L(t*o),y:L(n*o)}}assertValidity(){let{x:t,y:n}=this.aff();return(!qr(t)||!qr(n))&&X("Point invalid: x or y"),L(n*n)===hi(t)?this:X("Point invalid: not on curve")}multiply(t){return this.mul(t)}aff(){return this.toAffine()}ok(){return this.assertValidity()}toHex(t=!0){let{x:n,y:r}=this.aff();return(t?(r&1n)===0n?"02":"03":"04")+mi(n)+(t?"":mi(r))}toRawBytes(t=!0){return Cn(this.toHex(t))}};Nt.BASE=new Nt(vi,Ei,1n);Nt.ZERO=new Nt(0n,1n,0n);var{BASE:Pe,ZERO:rn}=Nt,Ti=(e,t)=>e.toString(16).padStart(t,"0"),Gr=e=>Array.from(Ln(e)).map(t=>Ti(t,2)).join(""),Ht={_0:48,_9:57,A:65,F:70,a:97,f:102},yi=e=>{if(e>=Ht._0&&e<=Ht._9)return e-Ht._0;if(e>=Ht.A&&e<=Ht.F)return e-(Ht.A-10);if(e>=Ht.a&&e<=Ht.f)return e-(Ht.a-10)},Cn=e=>{let t="hex invalid";if(!Ai(e))return X(t);let n=e.length,r=n/2;if(n%2)return X(t);let o=on(r);for(let s=0,i=0;s<r;s++,i+=2){let c=yi(e.charCodeAt(i)),a=yi(e.charCodeAt(i+1));if(c===void 0||a===void 0)return X(t);o[s]=c*16+a}return o},On=e=>BigInt("0x"+(Gr(e)||"0")),gi=(e,t,n)=>On(e.slice(t,n)),Fr=e=>Rn(e)&&e>=0n&&e<Wr?Cn(Ti(e,2*we)):X("bigint expected"),mi=e=>Gr(Fr(e)),bi=(...e)=>{let t=on(e.reduce((r,o)=>r+Ln(o).length,0)),n=0;return e.forEach(r=>{t.set(r,n),n+=r.length}),t},Ii=(e,t)=>{(e===0n||t<=0n)&&X("no inverse n="+e+" mod="+t);let n=L(e,t),r=t,o=0n,s=1n,i=1n,c=0n;for(;n!==0n;){let a=r/n,l=r%n,u=o-i*a,f=s-c*a;r=n,n=l,o=i,s=c,i=u,c=f}return r===1n?L(o,t):X("no inverse")},df=e=>{let t=1n;for(let n=e,r=(xe+1n)/4n;r>0n;r>>=1n)r&1n&&(t=t*n%xe),n=n*n%xe;return L(t*t)===e?t:X("sqrt invalid")},zr=e=>(Rn(e)||(e=On(Zr(e,we))),Bi(e)?e:X("private key invalid 3"));var Jr=(e,t=!0)=>Nt.fromPrivateKey(e).toRawBytes(t);var xi=()=>typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0,_n;var ki=e=>{e=Zr(e),(e.length<we+8||e.length>1024)&&X("expected 40-1024b");let t=L(On(e),Vr-1n);return Fr(t+1n)},Ui={hexToBytes:Cn,bytesToHex:Gr,concatBytes:bi,bytesToNumberBE:On,numberToBytesBE:Fr,mod:L,invert:Ii,hmacSha256Async:(e,...t)=>R(void 0,null,function*(){let n=xi(),r=n&&n.subtle;if(!r)return X("etc.hmacSha256Async or crypto.subtle must be defined");let o=yield r.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);return on(yield r.sign("HMAC",o,bi(...t)))}),hmacSha256Sync:_n,hashToPrivateKey:ki,randomBytes:(e=32)=>{let t=xi();return(!t||!t.getRandomValues)&&X("crypto.getRandomValues must be defined"),t.getRandomValues(on(e))}},_i={normPrivateKeyToScalar:zr,isValidPrivateKey:e=>{try{return!!zr(e)}catch{return!1}},randomPrivateKey:()=>ki(Ui.randomBytes(we+16)),precompute:(e=8,t=Pe)=>(t.multiply(3n),t)};Object.defineProperties(Ui,{hmacSha256Sync:{configurable:!1,get(){return _n},set(e){_n||(_n=e)}}});var be=8,hf=()=>{let e=[],t=256/be+1,n=Pe,r=n;for(let o=0;o<t;o++){r=n,e.push(r);for(let s=1;s<2**(be-1);s++)r=r.add(n),e.push(r);n=r.double()}return e},wi,pf=e=>{let t=wi||(wi=hf()),n=(u,f)=>{let d=f.negate();return u?d:f},r=rn,o=Pe,s=1+256/be,i=2**(be-1),c=BigInt(2**be-1),a=2**be,l=BigInt(be);for(let u=0;u<s;u++){let f=u*i,d=Number(e&c);e>>=l,d>i&&(d-=a,e+=1n);let y=f,p=f+Math.abs(d)-1,h=u%2!==0,g=d<0;d===0?o=o.add(n(h,t[y])):r=r.add(n(g,t[p]))}return{p:r,f:o}};Dt.sha512Sync=(...e)=>Un(Dt.concatBytes(...e));var Xr=(()=>{class e{static MULTICODEC={ED25519_PUB:237,SECP256K1_PUB:231};static publicKeyToMultibase(n,r){let o,s;switch(r){case"ed25519":o=this.MULTICODEC.ED25519_PUB,s=32;break;case"secp256k1":o=this.MULTICODEC.SECP256K1_PUB,s=33;break;default:throw new Error(`Unsupported key type: ${r}`)}if(n.length!==s)throw new Error(`Invalid key length for ${r}. Expected ${s} bytes, got ${n.length}`);let i=new Uint8Array([o]),c=new Uint8Array([...i,1,...n]);return new TextDecoder().decode(Li.encode("base58btc",c))}static resolve(n){let r=e.getDocument(n);return{didResolutionMetadata:{contentType:"application/did+ld+json",retrieved:new Date().toISOString()},didDocument:r,didDocumentMetadata:{}}}static generate(n){let r,o;return n==="secp256k1"&&(r=_i.randomPrivateKey(),o=Jr(r)),n==="ed25519"&&(r=ii.randomPrivateKey(),o=nn(r)),{privateKey:r,publicKey:o,did:"did:key:"+e.publicKeyToMultibase(o,n)}}static fromPublicKey(n,r){let o=`did:key:${e.publicKeyToMultibase(n,r)}`;return e.getDocument(o)}static fromPrivateKey(n,r){let o;r==="secp256k1"&&(o=Jr(n)),r==="ed25519"&&(o=nn(n));let s=`did:key:${e.publicKeyToMultibase(o,r)}`;return e.getDocument(s)}static getDocument(n){let r=`${n}#0`,o=n.split(":")[2],s=o.startsWith("zQ3s")?"secp256k1":o.startsWith("z6Mk")?"ed25519":void 0;if(!s)throw new Error("Unsupported key type in DID");let a=`{
            "@context": [
              "https://www.w3.org/ns/did/v1"
            ],
            "id": "${n}",
            "verificationMethod": [
              {
                "id": "${r}",
                "type": "${s==="ed25519"?"Ed25519VerificationKey2020":"EcdsaSecp256k1VerificationKey2019"}",
                "controller": "${n}",
                "publicKeyMultibase": "${o}"
              }
            ],
            "authentication": [
              "${r}"
            ],
            "assertionMethod": [
              "${r}"
            ],
            "capabilityDelegation": [
              "${r}"
            ],
            "capabilityInvocation": [
              "${r}"
            ]
          }`;return JSON.parse(a)}}return e})();var $t=class e{static fetchText(t){return R(this,null,function*(){return(yield e.fetchUrl(t)).text()})}static fetchJson(t){return R(this,null,function*(){return(yield e.fetchUrl(t)).json()})}static fetchUrl(t){return R(this,null,function*(){return yield fetch(t,{method:"GET",mode:"cors",cache:"no-cache",credentials:"omit",redirect:"follow",referrerPolicy:"no-referrer"})})}};var Mn=class{constructor(t){Object.defineProperty(this,"activeServer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.setActiveServer(t)}setActiveServer(t){this.activeServer=t}getServicesByType(t){return R(this,null,function*(){let n=`${this.activeServer}/api/dns/services/service/${t}`;try{return yield $t.fetchJson(n)}catch(r){return console.warn(`No services found for ${n}`),console.error(r),[]}})}getServicesByTypeAndNetwork(t,n){return R(this,null,function*(){let r=`${this.activeServer}/api/dns/services/symbol/${n}/service/${t}`;try{return yield $t.fetchJson(r)}catch(o){return console.warn(`No services found for ${r}`),console.error(o),[]}})}getServicesByNetwork(t){return R(this,null,function*(){let n=`${this.activeServer}/api/dns/services/symbol/${t}`;try{return yield $t.fetchJson(n)}catch(r){return console.warn(`No services found for ${n}`),console.error(r),[]}})}getExternalIP(){return R(this,null,function*(){let t=`${this.activeServer}/api/dns/ipaddress`;try{return yield $t.fetchText(t)}catch(n){return console.warn("Unable to find external IP."),console.error(n),""}})}};var Pn=class{constructor(){Object.defineProperty(this,"nameservers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"services",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.api=new Mn("")}getDnsServers(){return R(this,null,function*(){let t="https://chains.blockcore.net/services/DNS.json";try{return yield $t.fetchJson(t)}catch(n){return console.warn(`Unable to retrieve DNS list, using fixed list instead. URL: ${t}`),console.error(n),[{url:"https://ns.blockcore.net",contact:"post@blockcore.net"},{url:"https://ns.coinvault.io",contact:"post@coinvault.io"},{url:"https://ns.seniorblockchain.io",contact:"post@seniorblockchain.io"}]}})}getNameServers(){return this.nameservers}getOnlineServicesByNetwork(t){return this.services.filter(n=>n.symbol===t&&n.online===!0)}getServices(){return this.services}load(t,n="Indexer"){return R(this,null,function*(){this.nameservers=t||(yield this.getDnsServers());let r=new Map;for(let s=0;s<this.nameservers.length;s++){let i=this.nameservers[s];i&&(this.api.setActiveServer(i.url),n&&(yield this.api.getServicesByType(n)).forEach(a=>r.set(a.domain,z(z({},r.get(a.domain)),a))))}this.services=Array.from(r.values());let o=this.getRandomInt(this.nameservers.length);this.api.setActiveServer(this.nameservers[o].url)})}getRandomInt(t){return Math.floor(Math.random()*t)}};function Ri(){return new Yr().build()}var Yr=class{identityServiceDomain="https://id.blockcore.net";resolve(t,n,r,o){return R(this,null,function*(){let s=`${this.identityServiceDomain}/1.0/identifiers/did:is:${n.id}`;return yield(yield fetch(s,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}})).json()})}load(){let t=new Pn;t.load(void 0,"Identity").then(()=>{let n=t.getServices().filter(o=>o.online);if(n.length===0)return;let r=this.getRandomInt(n.length);n[r]?.domain&&(this.identityServiceDomain="https://"+n[r]?.domain)})}getRandomInt(t){return Math.floor(Math.random()*t)}build(){return this.load(),{is:this.resolve.bind(this)}}};var Ci={getResolver:Ri};function Oi(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function Qr(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function Mi(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Oi(e.outputLen),Oi(e.blockLen)}function De(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Pi(e,t){Qr(e);let n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}var Dn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var Di=e=>e instanceof Uint8Array;var Hn=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),St=(e,t)=>e<<32-t|e>>>t,gf=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!gf)throw new Error("Non little-endian hardware is not supported");function mf(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function sn(e){if(typeof e=="string"&&(e=mf(e)),!Di(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function Hi(...e){let t=new Uint8Array(e.reduce((r,o)=>r+o.length,0)),n=0;return e.forEach(r=>{if(!Di(r))throw new Error("Uint8Array expected");t.set(r,n),n+=r.length}),t}var He=class{clone(){return this._cloneInto()}},ng={}.toString;function Ni(e){let t=r=>e().update(sn(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Nn(e=32){if(Dn&&typeof Dn.getRandomValues=="function")return Dn.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function bf(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),c=Number(n&s),a=r?4:0,l=r?0:4;e.setUint32(t+a,i,r),e.setUint32(t+l,c,r)}var $n=class extends He{constructor(t,n,r,o){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Hn(this.buffer)}update(t){De(this);let{view:n,buffer:r,blockLen:o}=this;t=sn(t);let s=t.length;for(let i=0;i<s;){let c=Math.min(o-this.pos,s-i);if(c===o){let a=Hn(t);for(;o<=s-i;i+=o)this.process(a,i);continue}r.set(t.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){De(this),Pi(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:o,isLE:s}=this,{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>o-i&&(this.process(r,0),i=0);for(let f=i;f<o;f++)n[f]=0;bf(r,o-8,BigInt(this.length*8),s),this.process(r,0);let c=Hn(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=a/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<l;f++)c.setUint32(4*f,u[f],s)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:n,buffer:r,length:o,finished:s,destroyed:i,pos:c}=this;return t.length=o,t.pos=c,t.finished=s,t.destroyed=i,o%n&&t.buffer.set(r),t}};var xf=(e,t,n)=>e&t^~e&n,wf=(e,t,n)=>e&t^e&n^t&n,vf=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Yt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Qt=new Uint32Array(64),to=class extends $n{constructor(){super(64,32,8,!1),this.A=Yt[0]|0,this.B=Yt[1]|0,this.C=Yt[2]|0,this.D=Yt[3]|0,this.E=Yt[4]|0,this.F=Yt[5]|0,this.G=Yt[6]|0,this.H=Yt[7]|0}get(){let{A:t,B:n,C:r,D:o,E:s,F:i,G:c,H:a}=this;return[t,n,r,o,s,i,c,a]}set(t,n,r,o,s,i,c,a){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=c|0,this.H=a|0}process(t,n){for(let f=0;f<16;f++,n+=4)Qt[f]=t.getUint32(n,!1);for(let f=16;f<64;f++){let d=Qt[f-15],y=Qt[f-2],p=St(d,7)^St(d,18)^d>>>3,h=St(y,17)^St(y,19)^y>>>10;Qt[f]=h+Qt[f-7]+p+Qt[f-16]|0}let{A:r,B:o,C:s,D:i,E:c,F:a,G:l,H:u}=this;for(let f=0;f<64;f++){let d=St(c,6)^St(c,11)^St(c,25),y=u+d+xf(c,a,l)+vf[f]+Qt[f]|0,h=(St(r,2)^St(r,13)^St(r,22))+wf(r,o,s)|0;u=l,l=a,a=c,c=i+y|0,i=s,s=o,o=r,r=y+h|0}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,c=c+this.E|0,a=a+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,o,s,i,c,a,l,u)}roundClean(){Qt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var Kn=Ni(()=>new to);var oo={};za(oo,{bitGet:()=>kf,bitLen:()=>If,bitMask:()=>cn,bitSet:()=>Uf,bytesToHex:()=>ve,bytesToNumberBE:()=>it,bytesToNumberLE:()=>zn,concatBytes:()=>Kt,createHmacDrbg:()=>ro,ensureBytes:()=>Y,equalBytes:()=>Bf,hexToBytes:()=>Ee,hexToNumber:()=>no,numberToBytesBE:()=>At,numberToBytesLE:()=>Wn,numberToHexUnpadded:()=>ji,numberToVarBytesBE:()=>Af,utf8ToBytes:()=>Tf,validateObject:()=>te});var Ki=BigInt(0),jn=BigInt(1),Ef=BigInt(2),qn=e=>e instanceof Uint8Array,Sf=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function ve(e){if(!qn(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=Sf[e[n]];return t}function ji(e){let t=e.toString(16);return t.length&1?`0${t}`:t}function no(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}function Ee(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(t/2);for(let r=0;r<n.length;r++){let o=r*2,s=e.slice(o,o+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[r]=i}return n}function it(e){return no(ve(e))}function zn(e){if(!qn(e))throw new Error("Uint8Array expected");return no(ve(Uint8Array.from(e).reverse()))}function At(e,t){return Ee(e.toString(16).padStart(t*2,"0"))}function Wn(e,t){return At(e,t).reverse()}function Af(e){return Ee(ji(e))}function Y(e,t,n){let r;if(typeof t=="string")try{r=Ee(t)}catch(s){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${s}`)}else if(qn(t))r=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);let o=r.length;if(typeof n=="number"&&o!==n)throw new Error(`${e} expected ${n} bytes, got ${o}`);return r}function Kt(...e){let t=new Uint8Array(e.reduce((r,o)=>r+o.length,0)),n=0;return e.forEach(r=>{if(!qn(r))throw new Error("Uint8Array expected");t.set(r,n),n+=r.length}),t}function Bf(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Tf(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function If(e){let t;for(t=0;e>Ki;e>>=jn,t+=1);return t}function kf(e,t){return e>>BigInt(t)&jn}var Uf=(e,t,n)=>e|(n?jn:Ki)<<BigInt(t),cn=e=>(Ef<<BigInt(e-1))-jn,eo=e=>new Uint8Array(e),$i=e=>Uint8Array.from(e);function ro(e,t,n){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=eo(e),o=eo(e),s=0,i=()=>{r.fill(1),o.fill(0),s=0},c=(...f)=>n(o,r,...f),a=(f=eo())=>{o=c($i([0]),f),r=c(),f.length!==0&&(o=c($i([1]),f),r=c())},l=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let f=0,d=[];for(;f<t;){r=c();let y=r.slice();d.push(y),f+=r.length}return Kt(...d)};return(f,d)=>{i(),a(f);let y;for(;!(y=d(l()));)a();return i(),y}}var _f={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||e instanceof Uint8Array,isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function te(e,t,n={}){let r=(o,s,i)=>{let c=_f[s];if(typeof c!="function")throw new Error(`Invalid validator "${s}", expected function`);let a=e[o];if(!(i&&a===void 0)&&!c(a,e))throw new Error(`Invalid param ${String(o)}=${a} (${typeof a}), expected ${s}`)};for(let[o,s]of Object.entries(t))r(o,s,!1);for(let[o,s]of Object.entries(n))r(o,s,!0);return e}var tt=BigInt(0),J=BigInt(1),Se=BigInt(2),Lf=BigInt(3),so=BigInt(4),qi=BigInt(5),zi=BigInt(8),Rf=BigInt(9),Cf=BigInt(16);function Q(e,t){let n=e%t;return n>=tt?n:t+n}function Of(e,t,n){if(n<=tt||t<tt)throw new Error("Expected power/modulo > 0");if(n===J)return tt;let r=J;for(;t>tt;)t&J&&(r=r*e%n),e=e*e%n,t>>=J;return r}function pt(e,t,n){let r=e;for(;t-- >tt;)r*=r,r%=n;return r}function Vn(e,t){if(e===tt||t<=tt)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=Q(e,t),r=t,o=tt,s=J,i=J,c=tt;for(;n!==tt;){let l=r/n,u=r%n,f=o-i*l,d=s-c*l;r=n,n=u,o=i,s=c,i=f,c=d}if(r!==J)throw new Error("invert: does not exist");return Q(o,t)}function Mf(e){let t=(e-J)/Se,n,r,o;for(n=e-J,r=0;n%Se===tt;n/=Se,r++);for(o=Se;o<e&&Of(o,t,e)!==e-J;o++);if(r===1){let i=(e+J)/so;return function(a,l){let u=a.pow(l,i);if(!a.eql(a.sqr(u),l))throw new Error("Cannot find square root");return u}}let s=(n+J)/Se;return function(c,a){if(c.pow(a,t)===c.neg(c.ONE))throw new Error("Cannot find square root");let l=r,u=c.pow(c.mul(c.ONE,o),n),f=c.pow(a,s),d=c.pow(a,n);for(;!c.eql(d,c.ONE);){if(c.eql(d,c.ZERO))return c.ZERO;let y=1;for(let h=c.sqr(d);y<l&&!c.eql(h,c.ONE);y++)h=c.sqr(h);let p=c.pow(u,J<<BigInt(l-y-1));u=c.sqr(p),f=c.mul(f,p),d=c.mul(d,u),l=y}return f}}function Pf(e){if(e%so===Lf){let t=(e+J)/so;return function(r,o){let s=r.pow(o,t);if(!r.eql(r.sqr(s),o))throw new Error("Cannot find square root");return s}}if(e%zi===qi){let t=(e-qi)/zi;return function(r,o){let s=r.mul(o,Se),i=r.pow(s,t),c=r.mul(o,i),a=r.mul(r.mul(c,Se),i),l=r.mul(c,r.sub(a,r.ONE));if(!r.eql(r.sqr(l),o))throw new Error("Cannot find square root");return l}}return e%Cf,Mf(e)}var Df=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function io(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=Df.reduce((r,o)=>(r[o]="function",r),t);return te(e,n)}function Hf(e,t,n){if(n<tt)throw new Error("Expected power > 0");if(n===tt)return e.ONE;if(n===J)return t;let r=e.ONE,o=t;for(;n>tt;)n&J&&(r=e.mul(r,o)),o=e.sqr(o),n>>=J;return r}function Nf(e,t){let n=new Array(t.length),r=t.reduce((s,i,c)=>e.is0(i)?s:(n[c]=s,e.mul(s,i)),e.ONE),o=e.inv(r);return t.reduceRight((s,i,c)=>e.is0(i)?s:(n[c]=e.mul(s,n[c]),e.mul(s,i)),o),n}function co(e,t){let n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function Wi(e,t,n=!1,r={}){if(e<=tt)throw new Error(`Expected Field ORDER > 0, got ${e}`);let{nBitLength:o,nByteLength:s}=co(e,t);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");let i=Pf(e),c=Object.freeze({ORDER:e,BITS:o,BYTES:s,MASK:cn(o),ZERO:tt,ONE:J,create:a=>Q(a,e),isValid:a=>{if(typeof a!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof a}`);return tt<=a&&a<e},is0:a=>a===tt,isOdd:a=>(a&J)===J,neg:a=>Q(-a,e),eql:(a,l)=>a===l,sqr:a=>Q(a*a,e),add:(a,l)=>Q(a+l,e),sub:(a,l)=>Q(a-l,e),mul:(a,l)=>Q(a*l,e),pow:(a,l)=>Hf(c,a,l),div:(a,l)=>Q(a*Vn(l,e),e),sqrN:a=>a*a,addN:(a,l)=>a+l,subN:(a,l)=>a-l,mulN:(a,l)=>a*l,inv:a=>Vn(a,e),sqrt:r.sqrt||(a=>i(c,a)),invertBatch:a=>Nf(c,a),cmov:(a,l,u)=>u?l:a,toBytes:a=>n?Wn(a,s):At(a,s),fromBytes:a=>{if(a.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${a.length}`);return n?zn(a):it(a)}});return Object.freeze(c)}function Vi(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}function ao(e){let t=Vi(e);return t+Math.ceil(t/2)}function Zi(e,t,n=!1){let r=e.length,o=Vi(t),s=ao(t);if(r<16||r<s||r>1024)throw new Error(`expected ${s}-1024 bytes of input, got ${r}`);let i=n?it(e):zn(e),c=Q(i,t-J)+J;return n?Wn(c,o):At(c,o)}var Kf=BigInt(0),lo=BigInt(1);function Gi(e,t){let n=(o,s)=>{let i=s.negate();return o?i:s},r=o=>{let s=Math.ceil(t/o)+1,i=2**(o-1);return{windows:s,windowSize:i}};return{constTimeNegate:n,unsafeLadder(o,s){let i=e.ZERO,c=o;for(;s>Kf;)s&lo&&(i=i.add(c)),c=c.double(),s>>=lo;return i},precomputeWindow(o,s){let{windows:i,windowSize:c}=r(s),a=[],l=o,u=l;for(let f=0;f<i;f++){u=l,a.push(u);for(let d=1;d<c;d++)u=u.add(l),a.push(u);l=u.double()}return a},wNAF(o,s,i){let{windows:c,windowSize:a}=r(o),l=e.ZERO,u=e.BASE,f=BigInt(2**o-1),d=2**o,y=BigInt(o);for(let p=0;p<c;p++){let h=p*a,g=Number(i&f);i>>=y,g>a&&(g-=d,i+=lo);let m=h,b=h+Math.abs(g)-1,x=p%2!==0,w=g<0;g===0?u=u.add(n(x,s[m])):l=l.add(n(w,s[b]))}return{p:l,f:u}},wNAFCached(o,s,i,c){let a=o._WINDOW_SIZE||1,l=s.get(o);return l||(l=this.precomputeWindow(o,a),a!==1&&s.set(o,c(l))),this.wNAF(a,l,i)}}}function fo(e){return io(e.Fp),te(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze(G(z(z({},co(e.n,e.nBitLength)),e),{p:e.Fp.ORDER}))}function jf(e){let t=fo(e);te(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:n,Fp:r,a:o}=t;if(n){if(!r.eql(o,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze(z({},t))}var{bytesToNumberBE:qf,hexToBytes:zf}=oo,Ae={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(e){let{Err:t}=Ae;if(e.length<2||e[0]!==2)throw new t("Invalid signature integer tag");let n=e[1],r=e.subarray(2,n+2);if(!n||r.length!==n)throw new t("Invalid signature integer: wrong length");if(r[0]&128)throw new t("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:qf(r),l:e.subarray(n+2)}},toSig(e){let{Err:t}=Ae,n=typeof e=="string"?zf(e):e;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||n[0]!=48)throw new t("Invalid signature tag");if(n[1]!==r-2)throw new t("Invalid signature: incorrect length");let{d:o,l:s}=Ae._parseInt(n.subarray(2)),{d:i,l:c}=Ae._parseInt(s);if(c.length)throw new t("Invalid signature: left bytes after parsing");return{r:o,s:i}},hexFromSig(e){let t=l=>Number.parseInt(l[0],16)&8?"00"+l:l,n=l=>{let u=l.toString(16);return u.length&1?`0${u}`:u},r=t(n(e.s)),o=t(n(e.r)),s=r.length/2,i=o.length/2,c=n(s),a=n(i);return`30${n(i+s+4)}02${a}${o}02${c}${r}`}},jt=BigInt(0),mt=BigInt(1),xg=BigInt(2),Fi=BigInt(3),wg=BigInt(4);function Wf(e){let t=jf(e),{Fp:n}=t,r=t.toBytes||((p,h,g)=>{let m=h.toAffine();return Kt(Uint8Array.from([4]),n.toBytes(m.x),n.toBytes(m.y))}),o=t.fromBytes||(p=>{let h=p.subarray(1),g=n.fromBytes(h.subarray(0,n.BYTES)),m=n.fromBytes(h.subarray(n.BYTES,2*n.BYTES));return{x:g,y:m}});function s(p){let{a:h,b:g}=t,m=n.sqr(p),b=n.mul(m,p);return n.add(n.add(b,n.mul(p,h)),g)}if(!n.eql(n.sqr(t.Gy),s(t.Gx)))throw new Error("bad generator point: equation left != right");function i(p){return typeof p=="bigint"&&jt<p&&p<t.n}function c(p){if(!i(p))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function a(p){let{allowedPrivateKeyLengths:h,nByteLength:g,wrapPrivateKey:m,n:b}=t;if(h&&typeof p!="bigint"){if(p instanceof Uint8Array&&(p=ve(p)),typeof p!="string"||!h.includes(p.length))throw new Error("Invalid key");p=p.padStart(g*2,"0")}let x;try{x=typeof p=="bigint"?p:it(Y("private key",p,g))}catch{throw new Error(`private key must be ${g} bytes, hex or bigint, not ${typeof p}`)}return m&&(x=Q(x,b)),c(x),x}let l=new Map;function u(p){if(!(p instanceof f))throw new Error("ProjectivePoint expected")}class f{constructor(h,g,m){if(this.px=h,this.py=g,this.pz=m,h==null||!n.isValid(h))throw new Error("x required");if(g==null||!n.isValid(g))throw new Error("y required");if(m==null||!n.isValid(m))throw new Error("z required")}static fromAffine(h){let{x:g,y:m}=h||{};if(!h||!n.isValid(g)||!n.isValid(m))throw new Error("invalid affine point");if(h instanceof f)throw new Error("projective point not allowed");let b=x=>n.eql(x,n.ZERO);return b(g)&&b(m)?f.ZERO:new f(g,m,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(h){let g=n.invertBatch(h.map(m=>m.pz));return h.map((m,b)=>m.toAffine(g[b])).map(f.fromAffine)}static fromHex(h){let g=f.fromAffine(o(Y("pointHex",h)));return g.assertValidity(),g}static fromPrivateKey(h){return f.BASE.multiply(a(h))}_setWindowSize(h){this._WINDOW_SIZE=h,l.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}let{x:h,y:g}=this.toAffine();if(!n.isValid(h)||!n.isValid(g))throw new Error("bad point: x or y not FE");let m=n.sqr(g),b=s(h);if(!n.eql(m,b))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:h}=this.toAffine();if(n.isOdd)return!n.isOdd(h);throw new Error("Field doesn't support isOdd")}equals(h){u(h);let{px:g,py:m,pz:b}=this,{px:x,py:w,pz:A}=h,v=n.eql(n.mul(g,A),n.mul(x,b)),S=n.eql(n.mul(m,A),n.mul(w,b));return v&&S}negate(){return new f(this.px,n.neg(this.py),this.pz)}double(){let{a:h,b:g}=t,m=n.mul(g,Fi),{px:b,py:x,pz:w}=this,A=n.ZERO,v=n.ZERO,S=n.ZERO,B=n.mul(b,b),C=n.mul(x,x),O=n.mul(w,w),_=n.mul(b,x);return _=n.add(_,_),S=n.mul(b,w),S=n.add(S,S),A=n.mul(h,S),v=n.mul(m,O),v=n.add(A,v),A=n.sub(C,v),v=n.add(C,v),v=n.mul(A,v),A=n.mul(_,A),S=n.mul(m,S),O=n.mul(h,O),_=n.sub(B,O),_=n.mul(h,_),_=n.add(_,S),S=n.add(B,B),B=n.add(S,B),B=n.add(B,O),B=n.mul(B,_),v=n.add(v,B),O=n.mul(x,w),O=n.add(O,O),B=n.mul(O,_),A=n.sub(A,B),S=n.mul(O,C),S=n.add(S,S),S=n.add(S,S),new f(A,v,S)}add(h){u(h);let{px:g,py:m,pz:b}=this,{px:x,py:w,pz:A}=h,v=n.ZERO,S=n.ZERO,B=n.ZERO,C=t.a,O=n.mul(t.b,Fi),_=n.mul(g,x),D=n.mul(m,w),H=n.mul(b,A),W=n.add(g,m),E=n.add(x,w);W=n.mul(W,E),E=n.add(_,D),W=n.sub(W,E),E=n.add(g,b);let T=n.add(x,A);return E=n.mul(E,T),T=n.add(_,H),E=n.sub(E,T),T=n.add(m,b),v=n.add(w,A),T=n.mul(T,v),v=n.add(D,H),T=n.sub(T,v),B=n.mul(C,E),v=n.mul(O,H),B=n.add(v,B),v=n.sub(D,B),B=n.add(D,B),S=n.mul(v,B),D=n.add(_,_),D=n.add(D,_),H=n.mul(C,H),E=n.mul(O,E),D=n.add(D,H),H=n.sub(_,H),H=n.mul(C,H),E=n.add(E,H),_=n.mul(D,E),S=n.add(S,_),_=n.mul(T,E),v=n.mul(W,v),v=n.sub(v,_),_=n.mul(W,D),B=n.mul(T,B),B=n.add(B,_),new f(v,S,B)}subtract(h){return this.add(h.negate())}is0(){return this.equals(f.ZERO)}wNAF(h){return y.wNAFCached(this,l,h,g=>{let m=n.invertBatch(g.map(b=>b.pz));return g.map((b,x)=>b.toAffine(m[x])).map(f.fromAffine)})}multiplyUnsafe(h){let g=f.ZERO;if(h===jt)return g;if(c(h),h===mt)return this;let{endo:m}=t;if(!m)return y.unsafeLadder(this,h);let{k1neg:b,k1:x,k2neg:w,k2:A}=m.splitScalar(h),v=g,S=g,B=this;for(;x>jt||A>jt;)x&mt&&(v=v.add(B)),A&mt&&(S=S.add(B)),B=B.double(),x>>=mt,A>>=mt;return b&&(v=v.negate()),w&&(S=S.negate()),S=new f(n.mul(S.px,m.beta),S.py,S.pz),v.add(S)}multiply(h){c(h);let g=h,m,b,{endo:x}=t;if(x){let{k1neg:w,k1:A,k2neg:v,k2:S}=x.splitScalar(g),{p:B,f:C}=this.wNAF(A),{p:O,f:_}=this.wNAF(S);B=y.constTimeNegate(w,B),O=y.constTimeNegate(v,O),O=new f(n.mul(O.px,x.beta),O.py,O.pz),m=B.add(O),b=C.add(_)}else{let{p:w,f:A}=this.wNAF(g);m=w,b=A}return f.normalizeZ([m,b])[0]}multiplyAndAddUnsafe(h,g,m){let b=f.BASE,x=(A,v)=>v===jt||v===mt||!A.equals(b)?A.multiplyUnsafe(v):A.multiply(v),w=x(this,g).add(x(h,m));return w.is0()?void 0:w}toAffine(h){let{px:g,py:m,pz:b}=this,x=this.is0();h==null&&(h=x?n.ONE:n.inv(b));let w=n.mul(g,h),A=n.mul(m,h),v=n.mul(b,h);if(x)return{x:n.ZERO,y:n.ZERO};if(!n.eql(v,n.ONE))throw new Error("invZ was invalid");return{x:w,y:A}}isTorsionFree(){let{h,isTorsionFree:g}=t;if(h===mt)return!0;if(g)return g(f,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h,clearCofactor:g}=t;return h===mt?this:g?g(f,this):this.multiplyUnsafe(t.h)}toRawBytes(h=!0){return this.assertValidity(),r(f,this,h)}toHex(h=!0){return ve(this.toRawBytes(h))}}f.BASE=new f(t.Gx,t.Gy,n.ONE),f.ZERO=new f(n.ZERO,n.ONE,n.ZERO);let d=t.nBitLength,y=Gi(f,t.endo?Math.ceil(d/2):d);return{CURVE:t,ProjectivePoint:f,normPrivateKeyToScalar:a,weierstrassEquation:s,isWithinCurveOrder:i}}function Vf(e){let t=fo(e);return te(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze(z({lowS:!0},t))}function Ji(e){let t=Vf(e),{Fp:n,n:r}=t,o=n.BYTES+1,s=2*n.BYTES+1;function i(E){return jt<E&&E<n.ORDER}function c(E){return Q(E,r)}function a(E){return Vn(E,r)}let{ProjectivePoint:l,normPrivateKeyToScalar:u,weierstrassEquation:f,isWithinCurveOrder:d}=Wf(G(z({},t),{toBytes(E,T,U){let P=T.toAffine(),I=n.toBytes(P.x),N=Kt;return U?N(Uint8Array.from([T.hasEvenY()?2:3]),I):N(Uint8Array.from([4]),I,n.toBytes(P.y))},fromBytes(E){let T=E.length,U=E[0],P=E.subarray(1);if(T===o&&(U===2||U===3)){let I=it(P);if(!i(I))throw new Error("Point is not on curve");let N=f(I),V=n.sqrt(N),q=(V&mt)===mt;return(U&1)===1!==q&&(V=n.neg(V)),{x:I,y:V}}else if(T===s&&U===4){let I=n.fromBytes(P.subarray(0,n.BYTES)),N=n.fromBytes(P.subarray(n.BYTES,2*n.BYTES));return{x:I,y:N}}else throw new Error(`Point of length ${T} was invalid. Expected ${o} compressed bytes or ${s} uncompressed bytes`)}})),y=E=>ve(At(E,t.nByteLength));function p(E){let T=r>>mt;return E>T}function h(E){return p(E)?c(-E):E}let g=(E,T,U)=>it(E.slice(T,U));class m{constructor(T,U,P){this.r=T,this.s=U,this.recovery=P,this.assertValidity()}static fromCompact(T){let U=t.nByteLength;return T=Y("compactSignature",T,U*2),new m(g(T,0,U),g(T,U,2*U))}static fromDER(T){let{r:U,s:P}=Ae.toSig(Y("DER",T));return new m(U,P)}assertValidity(){if(!d(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!d(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(T){return new m(this.r,this.s,T)}recoverPublicKey(T){let{r:U,s:P,recovery:I}=this,N=S(Y("msgHash",T));if(I==null||![0,1,2,3].includes(I))throw new Error("recovery id invalid");let V=I===2||I===3?U+t.n:U;if(V>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");let q=(I&1)===0?"02":"03",et=l.fromHex(q+y(V)),at=a(V),ht=c(-N*at),gt=c(P*at),lt=l.BASE.multiplyAndAddUnsafe(et,ht,gt);if(!lt)throw new Error("point at infinify");return lt.assertValidity(),lt}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return Ee(this.toDERHex())}toDERHex(){return Ae.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Ee(this.toCompactHex())}toCompactHex(){return y(this.r)+y(this.s)}}let b={isValidPrivateKey(E){try{return u(E),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{let E=ao(t.n);return Zi(t.randomBytes(E),t.n)},precompute(E=8,T=l.BASE){return T._setWindowSize(E),T.multiply(BigInt(3)),T}};function x(E,T=!0){return l.fromPrivateKey(E).toRawBytes(T)}function w(E){let T=E instanceof Uint8Array,U=typeof E=="string",P=(T||U)&&E.length;return T?P===o||P===s:U?P===2*o||P===2*s:E instanceof l}function A(E,T,U=!0){if(w(E))throw new Error("first arg must be private key");if(!w(T))throw new Error("second arg must be public key");return l.fromHex(T).multiply(u(E)).toRawBytes(U)}let v=t.bits2int||function(E){let T=it(E),U=E.length*8-t.nBitLength;return U>0?T>>BigInt(U):T},S=t.bits2int_modN||function(E){return c(v(E))},B=cn(t.nBitLength);function C(E){if(typeof E!="bigint")throw new Error("bigint expected");if(!(jt<=E&&E<B))throw new Error(`bigint expected < 2^${t.nBitLength}`);return At(E,t.nByteLength)}function O(E,T,U=_){if(["recovered","canonical"].some(dt=>dt in U))throw new Error("sign() legacy options not supported");let{hash:P,randomBytes:I}=t,{lowS:N,prehash:V,extraEntropy:q}=U;N==null&&(N=!0),E=Y("msgHash",E),V&&(E=Y("prehashed msgHash",P(E)));let et=S(E),at=u(T),ht=[C(at),C(et)];if(q!=null){let dt=q===!0?I(n.BYTES):q;ht.push(Y("extraEntropy",dt))}let gt=Kt(...ht),lt=et;function It(dt){let Ue=v(dt);if(!d(Ue))return;let xs=a(Ue),kt=l.BASE.multiply(Ue).toAffine(),_e=c(kt.x);if(_e===jt)return;let hn=c(xs*c(lt+_e*at));if(hn===jt)return;let ws=(kt.x===_e?0:2)|Number(kt.y&mt),vs=hn;return N&&p(hn)&&(vs=h(hn),ws^=1),new m(_e,vs,ws)}return{seed:gt,k2sig:It}}let _={lowS:t.lowS,prehash:!1},D={lowS:t.lowS,prehash:!1};function H(E,T,U=_){let{seed:P,k2sig:I}=O(E,T,U),N=t;return ro(N.hash.outputLen,N.nByteLength,N.hmac)(P,I)}l.BASE._setWindowSize(8);function W(E,T,U,P=D){let I=E;if(T=Y("msgHash",T),U=Y("publicKey",U),"strict"in P)throw new Error("options.strict was renamed to lowS");let{lowS:N,prehash:V}=P,q,et;try{if(typeof I=="string"||I instanceof Uint8Array)try{q=m.fromDER(I)}catch(kt){if(!(kt instanceof Ae.Err))throw kt;q=m.fromCompact(I)}else if(typeof I=="object"&&typeof I.r=="bigint"&&typeof I.s=="bigint"){let{r:kt,s:_e}=I;q=new m(kt,_e)}else throw new Error("PARSE");et=l.fromHex(U)}catch(kt){if(kt.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(N&&q.hasHighS())return!1;V&&(T=t.hash(T));let{r:at,s:ht}=q,gt=S(T),lt=a(ht),It=c(gt*lt),dt=c(at*lt),Ue=l.BASE.multiplyAndAddUnsafe(et,It,dt)?.toAffine();return Ue?c(Ue.x)===at:!1}return{CURVE:t,getPublicKey:x,getSharedSecret:A,sign:H,verify:W,ProjectivePoint:l,Signature:m,utils:b}}var Zn=class extends He{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,Mi(t);let r=sn(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,s=new Uint8Array(o);s.set(r.length>o?t.create().update(r).digest():r);for(let i=0;i<s.length;i++)s[i]^=54;this.iHash.update(s),this.oHash=t.create();for(let i=0;i<s.length;i++)s[i]^=106;this.oHash.update(s),s.fill(0)}update(t){return De(this),this.iHash.update(t),this}digestInto(t){De(this),Qr(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:n,iHash:r,finished:o,destroyed:s,blockLen:i,outputLen:c}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=i,t.outputLen=c,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},uo=(e,t,n)=>new Zn(e,t).update(n).digest();uo.create=(e,t)=>new Zn(e,t);function Zf(e){return{hash:e,hmac:(t,...n)=>uo(e,t,Hi(...n)),randomBytes:Nn}}function Xi(e,t){let n=r=>Ji(z(z({},e),Zf(r)));return Object.freeze(G(z({},n(t)),{create:n}))}var Xn=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Gn=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),tc=BigInt(1),Fn=BigInt(2),Yi=(e,t)=>(e+t/Fn)/t;function ec(e){let t=Xn,n=BigInt(3),r=BigInt(6),o=BigInt(11),s=BigInt(22),i=BigInt(23),c=BigInt(44),a=BigInt(88),l=e*e*e%t,u=l*l*e%t,f=pt(u,n,t)*u%t,d=pt(f,n,t)*u%t,y=pt(d,Fn,t)*l%t,p=pt(y,o,t)*y%t,h=pt(p,s,t)*p%t,g=pt(h,c,t)*h%t,m=pt(g,a,t)*g%t,b=pt(m,c,t)*h%t,x=pt(b,n,t)*u%t,w=pt(x,i,t)*p%t,A=pt(w,r,t)*l%t,v=pt(A,Fn,t);if(!po.eql(po.sqr(v),e))throw new Error("Cannot find square root");return v}var po=Wi(Xn,void 0,void 0,{sqrt:ec}),ee=Xi({a:BigInt(0),b:BigInt(7),Fp:po,n:Gn,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=Gn,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-tc*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=n,i=BigInt("0x100000000000000000000000000000000"),c=Yi(s*e,t),a=Yi(-r*e,t),l=Q(e-c*n-a*o,t),u=Q(-c*r-a*s,t),f=l>i,d=u>i;if(f&&(l=t-l),d&&(u=t-u),l>i||u>i)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:f,k1:l,k2neg:d,k2:u}}}},Kn),Yn=BigInt(0),nc=e=>typeof e=="bigint"&&Yn<e&&e<Xn,Gf=e=>typeof e=="bigint"&&Yn<e&&e<Gn,Qi={};function Jn(e,...t){let n=Qi[e];if(n===void 0){let r=Kn(Uint8Array.from(e,o=>o.charCodeAt(0)));n=Kt(r,r),Qi[e]=n}return Kn(Kt(n,...t))}var mo=e=>e.toRawBytes(!0).slice(1),yo=e=>At(e,32),ho=e=>Q(e,Xn),an=e=>Q(e,Gn),bo=ee.ProjectivePoint,Ff=(e,t,n)=>bo.BASE.multiplyAndAddUnsafe(e,t,n);function go(e){let t=ee.utils.normPrivateKeyToScalar(e),n=bo.fromPrivateKey(t);return{scalar:n.hasEvenY()?t:an(-t),bytes:mo(n)}}function rc(e){if(!nc(e))throw new Error("bad x: need 0 < x < p");let t=ho(e*e),n=ho(t*e+BigInt(7)),r=ec(n);r%Fn!==Yn&&(r=ho(-r));let o=new bo(e,r,tc);return o.assertValidity(),o}function oc(...e){return an(it(Jn("BIP0340/challenge",...e)))}function Jf(e){return go(e).bytes}function Xf(e,t,n=Nn(32)){let r=Y("message",e),{bytes:o,scalar:s}=go(t),i=Y("auxRand",n,32),c=yo(s^it(Jn("BIP0340/aux",i))),a=Jn("BIP0340/nonce",c,o,r),l=an(it(a));if(l===Yn)throw new Error("sign failed: k is zero");let{bytes:u,scalar:f}=go(l),d=oc(u,o,r),y=new Uint8Array(64);if(y.set(u,0),y.set(yo(an(f+d*s)),32),!sc(y,r,o))throw new Error("sign: Invalid signature produced");return y}function sc(e,t,n){let r=Y("signature",e,64),o=Y("message",t),s=Y("publicKey",n,32);try{let i=rc(it(s)),c=it(r.subarray(0,32));if(!nc(c))return!1;let a=it(r.subarray(32,64));if(!Gf(a))return!1;let l=oc(yo(c),mo(i),o),u=Ff(i,a,an(-l));return!(!u||!u.hasEvenY()||u.toAffine().x!==c)}catch{return!1}}var bt={getPublicKey:Jf,sign:Xf,verify:sc,utils:{randomPrivateKey:ee.utils.randomPrivateKey,lift_x:rc,pointToBytes:mo,numberToBytesBE:At,bytesToNumberBE:it,taggedHash:Jn,mod:Q}};var Qn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var xo=e=>e instanceof Uint8Array;var tr=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),Bt=(e,t)=>e<<32-t|e>>>t,Yf=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Yf)throw new Error("Non little-endian hardware is not supported");var Qf=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Z(e){if(!xo(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=Qf[e[n]];return t}function Be(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(t/2);for(let r=0;r<n.length;r++){let o=r*2,s=e.slice(o,o+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[r]=i}return n}function tu(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function ne(e){if(typeof e=="string"&&(e=tu(e)),!xo(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function $e(...e){let t=new Uint8Array(e.reduce((r,o)=>r+o.length,0)),n=0;return e.forEach(r=>{if(!xo(r))throw new Error("Uint8Array expected");t.set(r,n),n+=r.length}),t}var Ne=class{clone(){return this._cloneInto()}};function wo(e){let t=r=>e().update(ne(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function er(e=32){if(Qn&&typeof Qn.getRandomValues=="function")return Qn.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function vo(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function eu(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}function ic(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function nu(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");vo(e.outputLen),vo(e.blockLen)}function ru(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function ou(e,t){ic(e);let n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}var su={number:vo,bool:eu,bytes:ic,hash:nu,exists:ru,output:ou},yt=su;function iu(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),c=Number(n&s),a=r?4:0,l=r?0:4;e.setUint32(t+a,i,r),e.setUint32(t+l,c,r)}var nr=class extends Ne{constructor(t,n,r,o){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=tr(this.buffer)}update(t){yt.exists(this);let{view:n,buffer:r,blockLen:o}=this;t=ne(t);let s=t.length;for(let i=0;i<s;){let c=Math.min(o-this.pos,s-i);if(c===o){let a=tr(t);for(;o<=s-i;i+=o)this.process(a,i);continue}r.set(t.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){yt.exists(this),yt.output(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:o,isLE:s}=this,{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>o-i&&(this.process(r,0),i=0);for(let f=i;f<o;f++)n[f]=0;iu(r,o-8,BigInt(this.length*8),s),this.process(r,0);let c=tr(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=a/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<l;f++)c.setUint32(4*f,u[f],s)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:n,buffer:r,length:o,finished:s,destroyed:i,pos:c}=this;return t.length=o,t.pos=c,t.finished=s,t.destroyed=i,o%n&&t.buffer.set(r),t}};var cu=(e,t,n)=>e&t^~e&n,au=(e,t,n)=>e&t^e&n^t&n,lu=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),re=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),oe=new Uint32Array(64),rr=class extends nr{constructor(){super(64,32,8,!1),this.A=re[0]|0,this.B=re[1]|0,this.C=re[2]|0,this.D=re[3]|0,this.E=re[4]|0,this.F=re[5]|0,this.G=re[6]|0,this.H=re[7]|0}get(){let{A:t,B:n,C:r,D:o,E:s,F:i,G:c,H:a}=this;return[t,n,r,o,s,i,c,a]}set(t,n,r,o,s,i,c,a){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=c|0,this.H=a|0}process(t,n){for(let f=0;f<16;f++,n+=4)oe[f]=t.getUint32(n,!1);for(let f=16;f<64;f++){let d=oe[f-15],y=oe[f-2],p=Bt(d,7)^Bt(d,18)^d>>>3,h=Bt(y,17)^Bt(y,19)^y>>>10;oe[f]=h+oe[f-7]+p+oe[f-16]|0}let{A:r,B:o,C:s,D:i,E:c,F:a,G:l,H:u}=this;for(let f=0;f<64;f++){let d=Bt(c,6)^Bt(c,11)^Bt(c,25),y=u+d+cu(c,a,l)+lu[f]+oe[f]|0,h=(Bt(r,2)^Bt(r,13)^Bt(r,22))+au(r,o,s)|0;u=l,l=a,a=c,c=i+y|0,i=s,s=o,o=r,r=y+h|0}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,c=c+this.E|0,a=a+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,o,s,i,c,a,l,u)}roundClean(){oe.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},Eo=class extends rr{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}},xt=wo(()=>new rr),Zg=wo(()=>new Eo);function Ke(e){if(!Number.isSafeInteger(e))throw new Error(`Wrong integer: ${e}`)}function qt(...e){let t=(o,s)=>i=>o(s(i)),n=Array.from(e).reverse().reduce((o,s)=>o?t(o,s.encode):s.encode,void 0),r=e.reduce((o,s)=>o?t(o,s.decode):s.decode,void 0);return{encode:n,decode:r}}function zt(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return t.map(n=>{if(Ke(n),n<0||n>=e.length)throw new Error(`Digit index outside alphabet: ${n} (alphabet: ${e.length})`);return e[n]})},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("alphabet.decode input should be array of strings");return t.map(n=>{if(typeof n!="string")throw new Error(`alphabet.decode: not string element=${n}`);let r=e.indexOf(n);if(r===-1)throw new Error(`Unknown letter: "${n}". Allowed: ${e}`);return r})}}}function Wt(e=""){if(typeof e!="string")throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("join.encode input should be array of strings");for(let n of t)if(typeof n!="string")throw new Error(`join.encode: non-string input=${n}`);return t.join(e)},decode:t=>{if(typeof t!="string")throw new Error("join.decode input should be string");return t.split(e)}}}function sr(e,t="="){if(Ke(e),typeof t!="string")throw new Error("padding chr should be string");return{encode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let r of n)if(typeof r!="string")throw new Error(`padding.encode: non-string input=${r}`);for(;n.length*e%8;)n.push(t);return n},decode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let o of n)if(typeof o!="string")throw new Error(`padding.decode: non-string input=${o}`);let r=n.length;if(r*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if(!((r-1)*e%8))throw new Error("Invalid padding: string has too much padding");return n.slice(0,r)}}}function dc(e){if(typeof e!="function")throw new Error("normalize fn should be function");return{encode:t=>t,decode:t=>e(t)}}function cc(e,t,n){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let r=0,o=[],s=Array.from(e);for(s.forEach(i=>{if(Ke(i),i<0||i>=t)throw new Error(`Wrong integer: ${i}`)});;){let i=0,c=!0;for(let a=r;a<s.length;a++){let l=s[a],u=t*i+l;if(!Number.isSafeInteger(u)||t*i/t!==i||u-l!==t*i)throw new Error("convertRadix: carry overflow");if(i=u%n,s[a]=Math.floor(u/n),!Number.isSafeInteger(s[a])||s[a]*n+i!==u)throw new Error("convertRadix: carry overflow");if(c)s[a]?c=!1:r=a;else continue}if(o.push(i),c)break}for(let i=0;i<e.length-1&&e[i]===0;i++)o.push(0);return o.reverse()}var hc=(e,t)=>t?hc(t,e%t):e,or=(e,t)=>e+(t-hc(e,t));function So(e,t,n,r){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(or(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${or(t,n)}`);let o=0,s=0,i=2**n-1,c=[];for(let a of e){if(Ke(a),a>=2**t)throw new Error(`convertRadix2: invalid data word=${a} from=${t}`);if(o=o<<t|a,s+t>32)throw new Error(`convertRadix2: carry overflow pos=${s} from=${t}`);for(s+=t;s>=n;s-=n)c.push((o>>s-n&i)>>>0);o&=2**s-1}if(o=o<<n-s&i,!r&&s>=t)throw new Error("Excess padding");if(!r&&o)throw new Error(`Non-zero padding: ${o}`);return r&&s>0&&c.push(o>>>0),c}function fu(e){return Ke(e),{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return cc(Array.from(t),2**8,e)},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(cc(t,e,2**8))}}}function se(e,t=!1){if(Ke(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(or(8,e)>32||or(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!(n instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return So(Array.from(n),8,e,!t)},decode:n=>{if(!Array.isArray(n)||n.length&&typeof n[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(So(n,e,8,t))}}}function ac(e){if(typeof e!="function")throw new Error("unsafeWrapper fn should be function");return function(...t){try{return e.apply(null,t)}catch{}}}var uu=qt(se(4),zt("0123456789ABCDEF"),Wt("")),du=qt(se(5),zt("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),sr(5),Wt("")),Fg=qt(se(5),zt("0123456789ABCDEFGHIJKLMNOPQRSTUV"),sr(5),Wt("")),Jg=qt(se(5),zt("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),Wt(""),dc(e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),wt=qt(se(6),zt("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),sr(6),Wt("")),hu=qt(se(6),zt("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),sr(6),Wt("")),To=e=>qt(fu(58),zt(e),Wt("")),Ao=To("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),Xg=To("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),Yg=To("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz"),lc=[0,2,3,5,6,7,9,10,11],pu={encode(e){let t="";for(let n=0;n<e.length;n+=8){let r=e.subarray(n,n+8);t+=Ao.encode(r).padStart(lc[r.length],"1")}return t},decode(e){let t=[];for(let n=0;n<e.length;n+=11){let r=e.slice(n,n+11),o=lc.indexOf(r.length),s=Ao.decode(r);for(let i=0;i<s.length-o;i++)if(s[i]!==0)throw new Error("base58xmr: wrong padding");t=t.concat(Array.from(s.slice(s.length-o)))}return Uint8Array.from(t)}};var Bo=qt(zt("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),Wt("")),fc=[996825010,642813549,513874426,1027748829,705979059];function ln(e){let t=e>>25,n=(e&33554431)<<5;for(let r=0;r<fc.length;r++)(t>>r&1)===1&&(n^=fc[r]);return n}function uc(e,t,n=1){let r=e.length,o=1;for(let s=0;s<r;s++){let i=e.charCodeAt(s);if(i<33||i>126)throw new Error(`Invalid prefix (${e})`);o=ln(o)^i>>5}o=ln(o);for(let s=0;s<r;s++)o=ln(o)^e.charCodeAt(s)&31;for(let s of t)o=ln(o)^s;for(let s=0;s<6;s++)o=ln(o);return o^=n,Bo.encode(So([o%2**30],30,5,!1))}function pc(e){let t=e==="bech32"?1:734539939,n=se(5),r=n.decode,o=n.encode,s=ac(r);function i(u,f,d=90){if(typeof u!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof u}`);if(!Array.isArray(f)||f.length&&typeof f[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof f}`);let y=u.length+7+f.length;if(d!==!1&&y>d)throw new TypeError(`Length ${y} exceeds limit ${d}`);return u=u.toLowerCase(),`${u}1${Bo.encode(f)}${uc(u,f,t)}`}function c(u,f=90){if(typeof u!="string")throw new Error(`bech32.decode input should be string, not ${typeof u}`);if(u.length<8||f!==!1&&u.length>f)throw new TypeError(`Wrong string length: ${u.length} (${u}). Expected (8..${f})`);let d=u.toLowerCase();if(u!==d&&u!==u.toUpperCase())throw new Error("String must be lowercase or uppercase");u=d;let y=u.lastIndexOf("1");if(y===0||y===-1)throw new Error('Letter "1" must be present between prefix and data only');let p=u.slice(0,y),h=u.slice(y+1);if(h.length<6)throw new Error("Data must be at least 6 characters long");let g=Bo.decode(h).slice(0,-6),m=uc(p,g,t);if(!h.endsWith(m))throw new Error(`Invalid checksum in ${u}: expected "${m}"`);return{prefix:p,words:g}}let a=ac(c);function l(u){let{prefix:f,words:d}=c(u,!1);return{prefix:f,words:d,bytes:r(d)}}return{encode:i,decode:c,decodeToBytes:l,decodeUnsafe:a,fromWords:r,fromWordsUnsafe:s,toWords:o}}var ie=pc("bech32"),Qg=pc("bech32m"),yu={encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)},gu=qt(se(4),zt("0123456789abcdef"),Wt(""),dc(e=>{if(typeof e!="string"||e.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()})),mu={utf8:yu,hex:gu,base16:uu,base32:du,base64:wt,base64url:hu,base58:Ao,base58xmr:pu},tm=`Invalid encoding type. Available types: ${Object.keys(mu).join(", ")}`;function ir(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}function Io(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function ko(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function K(e,...t){if(!ko(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function ce(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function fn(e,t){K(e);let n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}var cr=e=>new Uint8Array(e.buffer,e.byteOffset,e.byteLength);var j=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),ae=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),bu=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!bu)throw new Error("Non little-endian hardware is not supported");function xu(e){if(typeof e!="string")throw new Error(`string expected, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function _t(e){if(typeof e=="string")e=xu(e);else if(ko(e))e=e.slice();else throw new Error(`Uint8Array expected, got ${typeof e}`);return e}function yc(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function Te(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}var Lt=(e,t)=>(Object.assign(t,e),t);function Ie(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),c=Number(n&s),a=r?4:0,l=r?0:4;e.setUint32(t+a,i,r),e.setUint32(t+l,c,r)}var Vt=16,_o=new Uint8Array(16),Rt=j(_o),wu=225,vu=(e,t,n,r)=>{let o=r&1;return{s3:n<<31|r>>>1,s2:t<<31|n>>>1,s1:e<<31|t>>>1,s0:e>>>1^wu<<24&-(o&1)}},vt=e=>(e>>>0&255)<<24|(e>>>8&255)<<16|(e>>>16&255)<<8|e>>>24&255|0;function Eu(e){e.reverse();let t=e[15]&1,n=0;for(let r=0;r<e.length;r++){let o=e[r];e[r]=o>>>1|n,n=(o&1)<<7}return e[0]^=-t&225,e}var Su=e=>e>64*1024?8:e>1024?4:2,ar=class{constructor(t,n){this.blockLen=Vt,this.outputLen=Vt,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,t=_t(t),K(t,16);let r=ae(t),o=r.getUint32(0,!1),s=r.getUint32(4,!1),i=r.getUint32(8,!1),c=r.getUint32(12,!1),a=[];for(let p=0;p<128;p++)a.push({s0:vt(o),s1:vt(s),s2:vt(i),s3:vt(c)}),{s0:o,s1:s,s2:i,s3:c}=vu(o,s,i,c);let l=Su(n||1024);if(![1,2,4,8].includes(l))throw new Error(`ghash: wrong window size=${l}, should be 2, 4 or 8`);this.W=l;let f=128/l,d=this.windowSize=2**l,y=[];for(let p=0;p<f;p++)for(let h=0;h<d;h++){let g=0,m=0,b=0,x=0;for(let w=0;w<l;w++){if(!(h>>>l-w-1&1))continue;let{s0:v,s1:S,s2:B,s3:C}=a[l*p+w];g^=v,m^=S,b^=B,x^=C}y.push({s0:g,s1:m,s2:b,s3:x})}this.t=y}_updateBlock(t,n,r,o){t^=this.s0,n^=this.s1,r^=this.s2,o^=this.s3;let{W:s,t:i,windowSize:c}=this,a=0,l=0,u=0,f=0,d=(1<<s)-1,y=0;for(let p of[t,n,r,o])for(let h=0;h<4;h++){let g=p>>>8*h&255;for(let m=8/s-1;m>=0;m--){let b=g>>>s*m&d,{s0:x,s1:w,s2:A,s3:v}=i[y*c+b];a^=x,l^=w,u^=A,f^=v,y+=1}}this.s0=a,this.s1=l,this.s2=u,this.s3=f}update(t){t=_t(t),ce(this);let n=j(t),r=Math.floor(t.length/Vt),o=t.length%Vt;for(let s=0;s<r;s++)this._updateBlock(n[s*4+0],n[s*4+1],n[s*4+2],n[s*4+3]);return o&&(_o.set(t.subarray(r*Vt)),this._updateBlock(Rt[0],Rt[1],Rt[2],Rt[3]),Rt.fill(0)),this}destroy(){let{t}=this;for(let n of t)n.s0=0,n.s1=0,n.s2=0,n.s3=0}digestInto(t){ce(this),fn(t,this),this.finished=!0;let{s0:n,s1:r,s2:o,s3:s}=this,i=j(t);return i[0]=n,i[1]=r,i[2]=o,i[3]=s,t}digest(){let t=new Uint8Array(Vt);return this.digestInto(t),this.destroy(),t}},Uo=class extends ar{constructor(t,n){t=_t(t);let r=Eu(t.slice());super(r,n),r.fill(0)}update(t){t=_t(t),ce(this);let n=j(t),r=t.length%Vt,o=Math.floor(t.length/Vt);for(let s=0;s<o;s++)this._updateBlock(vt(n[s*4+3]),vt(n[s*4+2]),vt(n[s*4+1]),vt(n[s*4+0]));return r&&(_o.set(t.subarray(o*Vt)),this._updateBlock(vt(Rt[3]),vt(Rt[2]),vt(Rt[1]),vt(Rt[0])),Rt.fill(0)),this}digestInto(t){ce(this),fn(t,this),this.finished=!0;let{s0:n,s1:r,s2:o,s3:s}=this,i=j(t);return i[0]=n,i[1]=r,i[2]=o,i[3]=s,t.reverse()}};function gc(e){let t=(r,o)=>e(o,r.length).update(_t(r)).digest(),n=e(new Uint8Array(16),0);return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=(r,o)=>e(r,o),t}var Lo=gc((e,t)=>new ar(e,t)),mc=gc((e,t)=>new Uo(e,t));var ut=16,Oo=4,lr=new Uint8Array(ut),Au=283;function Mo(e){return e<<1^Au&-(e>>7)}function je(e,t){let n=0;for(;t>0;t>>=1)n^=e&-(t&1),e=Mo(e);return n}var Co=(()=>{let e=new Uint8Array(256);for(let n=0,r=1;n<256;n++,r^=Mo(r))e[n]=r;let t=new Uint8Array(256);t[0]=99;for(let n=0;n<255;n++){let r=e[255-n];r|=r<<8,t[e[n]]=(r^r>>4^r>>5^r>>6^r>>7^99)&255}return t})(),Bu=Co.map((e,t)=>Co.indexOf(t)),Tu=e=>e<<24|e>>>8,Ro=e=>e<<8|e>>>24;function bc(e,t){if(e.length!==256)throw new Error("Wrong sbox length");let n=new Uint32Array(256).map((l,u)=>t(e[u])),r=n.map(Ro),o=r.map(Ro),s=o.map(Ro),i=new Uint32Array(256*256),c=new Uint32Array(256*256),a=new Uint16Array(256*256);for(let l=0;l<256;l++)for(let u=0;u<256;u++){let f=l*256+u;i[f]=n[l]^r[u],c[f]=o[l]^s[u],a[f]=e[l]<<8|e[u]}return{sbox:e,sbox2:a,T0:n,T1:r,T2:o,T3:s,T01:i,T23:c}}var Po=bc(Co,e=>je(e,3)<<24|e<<16|e<<8|je(e,2)),xc=bc(Bu,e=>je(e,11)<<24|je(e,13)<<16|je(e,9)<<8|je(e,14)),Iu=(()=>{let e=new Uint8Array(16);for(let t=0,n=1;t<16;t++,n=Mo(n))e[t]=n;return e})();function fe(e){K(e);let t=e.length;if(![16,24,32].includes(t))throw new Error(`aes: wrong key size: should be 16, 24 or 32, got: ${t}`);let{sbox2:n}=Po,r=j(e),o=r.length,s=c=>Ct(n,c,c,c,c),i=new Uint32Array(t+28);i.set(r);for(let c=o;c<i.length;c++){let a=i[c-1];c%o===0?a=s(Tu(a))^Iu[c/o-1]:o>6&&c%o===4&&(a=s(a)),i[c]=i[c-o]^a}return i}function wc(e){let t=fe(e),n=t.slice(),r=t.length,{sbox2:o}=Po,{T0:s,T1:i,T2:c,T3:a}=xc;for(let l=0;l<r;l+=4)for(let u=0;u<4;u++)n[l+u]=t[r-l-4+u];t.fill(0);for(let l=4;l<r-4;l++){let u=n[l],f=Ct(o,u,u,u,u);n[l]=s[f&255]^i[f>>>8&255]^c[f>>>16&255]^a[f>>>24]}return n}function le(e,t,n,r,o,s){return e[n<<8&65280|r>>>8&255]^t[o>>>8&65280|s>>>24&255]}function Ct(e,t,n,r,o){return e[t&255|n&65280]|e[r>>>16&255|o>>>16&65280]<<16}function Et(e,t,n,r,o){let{sbox2:s,T01:i,T23:c}=Po,a=0;t^=e[a++],n^=e[a++],r^=e[a++],o^=e[a++];let l=e.length/4-2;for(let p=0;p<l;p++){let h=e[a++]^le(i,c,t,n,r,o),g=e[a++]^le(i,c,n,r,o,t),m=e[a++]^le(i,c,r,o,t,n),b=e[a++]^le(i,c,o,t,n,r);t=h,n=g,r=m,o=b}let u=e[a++]^Ct(s,t,n,r,o),f=e[a++]^Ct(s,n,r,o,t),d=e[a++]^Ct(s,r,o,t,n),y=e[a++]^Ct(s,o,t,n,r);return{s0:u,s1:f,s2:d,s3:y}}function vc(e,t,n,r,o){let{sbox2:s,T01:i,T23:c}=xc,a=0;t^=e[a++],n^=e[a++],r^=e[a++],o^=e[a++];let l=e.length/4-2;for(let p=0;p<l;p++){let h=e[a++]^le(i,c,t,o,r,n),g=e[a++]^le(i,c,n,t,o,r),m=e[a++]^le(i,c,r,n,t,o),b=e[a++]^le(i,c,o,r,n,t);t=h,n=g,r=m,o=b}let u=e[a++]^Ct(s,t,o,r,n),f=e[a++]^Ct(s,n,t,o,r),d=e[a++]^Ct(s,r,n,t,o),y=e[a++]^Ct(s,o,r,n,t);return{s0:u,s1:f,s2:d,s3:y}}function qe(e,t){if(!t)return new Uint8Array(e);if(K(t),t.length<e)throw new Error(`aes: wrong destination length, expected at least ${e}, got: ${t.length}`);return t}function ku(e,t,n,r){K(t,ut),K(n);let o=n.length;r=qe(o,r);let s=t,i=j(s),{s0:c,s1:a,s2:l,s3:u}=Et(e,i[0],i[1],i[2],i[3]),f=j(n),d=j(r);for(let p=0;p+4<=f.length;p+=4){d[p+0]=f[p+0]^c,d[p+1]=f[p+1]^a,d[p+2]=f[p+2]^l,d[p+3]=f[p+3]^u;let h=1;for(let g=s.length-1;g>=0;g--)h=h+(s[g]&255)|0,s[g]=h&255,h>>>=8;({s0:c,s1:a,s2:l,s3:u}=Et(e,i[0],i[1],i[2],i[3]))}let y=ut*Math.floor(f.length/Oo);if(y<o){let p=new Uint32Array([c,a,l,u]),h=cr(p);for(let g=y,m=0;g<o;g++,m++)r[g]=n[g]^h[m]}return r}function un(e,t,n,r,o){K(n,ut),K(r),o=qe(r.length,o);let s=n,i=j(s),c=ae(s),a=j(r),l=j(o),u=t?0:12,f=r.length,d=c.getUint32(u,t),{s0:y,s1:p,s2:h,s3:g}=Et(e,i[0],i[1],i[2],i[3]);for(let b=0;b+4<=a.length;b+=4)l[b+0]=a[b+0]^y,l[b+1]=a[b+1]^p,l[b+2]=a[b+2]^h,l[b+3]=a[b+3]^g,d=d+1>>>0,c.setUint32(u,d,t),{s0:y,s1:p,s2:h,s3:g}=Et(e,i[0],i[1],i[2],i[3]);let m=ut*Math.floor(a.length/Oo);if(m<f){let b=new Uint32Array([y,p,h,g]),x=cr(b);for(let w=m,A=0;w<f;w++,A++)o[w]=r[w]^x[A]}return o}var dm=Lt({blockSize:16,nonceLength:16},function(t,n){K(t),K(n,ut);function r(o,s){let i=fe(t),c=n.slice(),a=ku(i,c,o,s);return i.fill(0),c.fill(0),a}return{encrypt:(o,s)=>r(o,s),decrypt:(o,s)=>r(o,s)}});function Ec(e){if(K(e),e.length%ut!==0)throw new Error(`aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size ${ut}`)}function Sc(e,t,n){let r=e.length,o=r%ut;if(!t&&o!==0)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");let s=j(e);if(t){let a=ut-o;a||(a=ut),r=r+a}let i=qe(r,n),c=j(i);return{b:s,o:c,out:i}}function Ac(e,t){if(!t)return e;let n=e.length;if(!n)throw new Error("aes/pcks5: empty ciphertext not allowed");let r=e[n-1];if(r<=0||r>16)throw new Error(`aes/pcks5: wrong padding byte: ${r}`);let o=e.subarray(0,-r);for(let s=0;s<r;s++)if(e[n-s-1]!==r)throw new Error("aes/pcks5: wrong padding");return o}function Bc(e){let t=new Uint8Array(16),n=j(t);t.set(e);let r=ut-e.length;for(let o=ut-r;o<ut;o++)t[o]=r;return n}var hm=Lt({blockSize:16},function(t,n={}){K(t);let r=!n.disablePadding;return{encrypt:(o,s)=>{K(o);let{b:i,o:c,out:a}=Sc(o,r,s),l=fe(t),u=0;for(;u+4<=i.length;){let{s0:f,s1:d,s2:y,s3:p}=Et(l,i[u+0],i[u+1],i[u+2],i[u+3]);c[u++]=f,c[u++]=d,c[u++]=y,c[u++]=p}if(r){let f=Bc(o.subarray(u*4)),{s0:d,s1:y,s2:p,s3:h}=Et(l,f[0],f[1],f[2],f[3]);c[u++]=d,c[u++]=y,c[u++]=p,c[u++]=h}return l.fill(0),a},decrypt:(o,s)=>{Ec(o);let i=wc(t),c=qe(o.length,s),a=j(o),l=j(c);for(let u=0;u+4<=a.length;){let{s0:f,s1:d,s2:y,s3:p}=vc(i,a[u+0],a[u+1],a[u+2],a[u+3]);l[u++]=f,l[u++]=d,l[u++]=y,l[u++]=p}return i.fill(0),Ac(c,r)}}}),Do=Lt({blockSize:16,nonceLength:16},function(t,n,r={}){K(t),K(n,16);let o=!r.disablePadding;return{encrypt:(s,i)=>{let c=fe(t),{b:a,o:l,out:u}=Sc(s,o,i),f=j(n),d=f[0],y=f[1],p=f[2],h=f[3],g=0;for(;g+4<=a.length;)d^=a[g+0],y^=a[g+1],p^=a[g+2],h^=a[g+3],{s0:d,s1:y,s2:p,s3:h}=Et(c,d,y,p,h),l[g++]=d,l[g++]=y,l[g++]=p,l[g++]=h;if(o){let m=Bc(s.subarray(g*4));d^=m[0],y^=m[1],p^=m[2],h^=m[3],{s0:d,s1:y,s2:p,s3:h}=Et(c,d,y,p,h),l[g++]=d,l[g++]=y,l[g++]=p,l[g++]=h}return c.fill(0),u},decrypt:(s,i)=>{Ec(s);let c=wc(t),a=j(n),l=qe(s.length,i),u=j(s),f=j(l),d=a[0],y=a[1],p=a[2],h=a[3];for(let g=0;g+4<=u.length;){let m=d,b=y,x=p,w=h;d=u[g+0],y=u[g+1],p=u[g+2],h=u[g+3];let{s0:A,s1:v,s2:S,s3:B}=vc(c,d,y,p,h);f[g++]=A^m,f[g++]=v^b,f[g++]=S^x,f[g++]=B^w}return c.fill(0),Ac(l,o)}}}),pm=Lt({blockSize:16,nonceLength:16},function(t,n){K(t),K(n,16);function r(o,s,i){let c=fe(t),a=o.length;i=qe(a,i);let l=j(o),u=j(i),f=s?u:l,d=j(n),y=d[0],p=d[1],h=d[2],g=d[3];for(let b=0;b+4<=l.length;){let{s0:x,s1:w,s2:A,s3:v}=Et(c,y,p,h,g);u[b+0]=l[b+0]^x,u[b+1]=l[b+1]^w,u[b+2]=l[b+2]^A,u[b+3]=l[b+3]^v,y=f[b++],p=f[b++],h=f[b++],g=f[b++]}let m=ut*Math.floor(l.length/Oo);if(m<a){({s0:y,s1:p,s2:h,s3:g}=Et(c,y,p,h,g));let b=cr(new Uint32Array([y,p,h,g]));for(let x=m,w=0;x<a;x++,w++)i[x]=o[x]^b[w];b.fill(0)}return c.fill(0),i}return{encrypt:(o,s)=>r(o,!0,s),decrypt:(o,s)=>r(o,!1,s)}});function Tc(e,t,n,r,o){let s=e.create(n,r.length+(o?.length||0));o&&s.update(o),s.update(r);let i=new Uint8Array(16),c=ae(i);return o&&Ie(c,0,BigInt(o.length*8),t),Ie(c,8,BigInt(r.length*8),t),s.update(i),s.digest()}var ym=Lt({blockSize:16,nonceLength:12,tagLength:16},function(t,n,r){if(K(n),n.length===0)throw new Error("aes/gcm: empty nonce");let o=16;function s(c,a,l){let u=Tc(Lo,!1,c,l,r);for(let f=0;f<a.length;f++)u[f]^=a[f];return u}function i(){let c=fe(t),a=lr.slice(),l=lr.slice();if(un(c,!1,l,l,a),n.length===12)l.set(n);else{let f=lr.slice(),d=ae(f);Ie(d,8,BigInt(n.length*8),!1),Lo.create(a).update(n).update(f).digestInto(l)}let u=un(c,!1,l,lr);return{xk:c,authKey:a,counter:l,tagMask:u}}return{encrypt:c=>{K(c);let{xk:a,authKey:l,counter:u,tagMask:f}=i(),d=new Uint8Array(c.length+o);un(a,!1,u,c,d);let y=s(l,f,d.subarray(0,d.length-o));return d.set(y,c.length),a.fill(0),d},decrypt:c=>{if(K(c),c.length<o)throw new Error(`aes/gcm: ciphertext less than tagLen (${o})`);let{xk:a,authKey:l,counter:u,tagMask:f}=i(),d=c.subarray(0,-o),y=c.subarray(-o),p=s(l,f,d);if(!Te(p,y))throw new Error("aes/gcm: invalid ghash tag");let h=un(a,!1,u,d);return l.fill(0),f.fill(0),a.fill(0),h}}}),fr=(e,t,n)=>r=>{if(!Number.isSafeInteger(r)||t>r||r>n)throw new Error(`${e}: invalid value=${r}, must be [${t}..${n}]`)},gm=Lt({blockSize:16,nonceLength:12,tagLength:16},function(t,n,r){let s=fr("AAD",0,68719476736),i=fr("plaintext",0,2**36),c=fr("nonce",12,12),a=fr("ciphertext",16,2**36+16);K(n),c(n.length),r&&(K(r),s(r.length));function l(){let d=t.length;if(d!==16&&d!==24&&d!==32)throw new Error(`key length must be 16, 24 or 32 bytes, got: ${d} bytes`);let y=fe(t),p=new Uint8Array(d),h=new Uint8Array(16),g=j(n),m=0,b=g[0],x=g[1],w=g[2],A=0;for(let v of[h,p].map(j)){let S=j(v);for(let B=0;B<S.length;B+=2){let{s0:C,s1:O}=Et(y,m,b,x,w);S[B+0]=C,S[B+1]=O,m=++A}}return y.fill(0),{authKey:h,encKey:fe(p)}}function u(d,y,p){let h=Tc(mc,!0,y,p,r);for(let A=0;A<12;A++)h[A]^=n[A];h[15]&=127;let g=j(h),m=g[0],b=g[1],x=g[2],w=g[3];return{s0:m,s1:b,s2:x,s3:w}=Et(d,m,b,x,w),g[0]=m,g[1]=b,g[2]=x,g[3]=w,h}function f(d,y,p){let h=y.slice();return h[15]|=128,un(d,!0,h,p)}return{encrypt:d=>{K(d),i(d.length);let{encKey:y,authKey:p}=l(),h=u(y,p,d),g=new Uint8Array(d.length+16);return g.set(h,d.length),g.set(f(y,h,d)),y.fill(0),p.fill(0),g},decrypt:d=>{K(d),a(d.length);let y=d.subarray(-16),{encKey:p,authKey:h}=l(),g=f(p,y,d.subarray(0,-16)),m=u(p,h,g);if(p.fill(0),h.fill(0),!Te(y,m))throw new Error("invalid polyval tag");return g}}});var ct=(e,t)=>e[t++]&255|(e[t++]&255)<<8,Ho=class{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=_t(t),K(t,32);let n=ct(t,0),r=ct(t,2),o=ct(t,4),s=ct(t,6),i=ct(t,8),c=ct(t,10),a=ct(t,12),l=ct(t,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|o<<6)&7939,this.r[3]=(o>>>7|s<<9)&8191,this.r[4]=(s>>>4|i<<12)&255,this.r[5]=i>>>1&8190,this.r[6]=(i>>>14|c<<2)&8191,this.r[7]=(c>>>11|a<<5)&8065,this.r[8]=(a>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=ct(t,16+2*u)}process(t,n,r=!1){let o=r?0:2048,{h:s,r:i}=this,c=i[0],a=i[1],l=i[2],u=i[3],f=i[4],d=i[5],y=i[6],p=i[7],h=i[8],g=i[9],m=ct(t,n+0),b=ct(t,n+2),x=ct(t,n+4),w=ct(t,n+6),A=ct(t,n+8),v=ct(t,n+10),S=ct(t,n+12),B=ct(t,n+14),C=s[0]+(m&8191),O=s[1]+((m>>>13|b<<3)&8191),_=s[2]+((b>>>10|x<<6)&8191),D=s[3]+((x>>>7|w<<9)&8191),H=s[4]+((w>>>4|A<<12)&8191),W=s[5]+(A>>>1&8191),E=s[6]+((A>>>14|v<<2)&8191),T=s[7]+((v>>>11|S<<5)&8191),U=s[8]+((S>>>8|B<<8)&8191),P=s[9]+(B>>>5|o),I=0,N=I+C*c+O*(5*g)+_*(5*h)+D*(5*p)+H*(5*y);I=N>>>13,N&=8191,N+=W*(5*d)+E*(5*f)+T*(5*u)+U*(5*l)+P*(5*a),I+=N>>>13,N&=8191;let V=I+C*a+O*c+_*(5*g)+D*(5*h)+H*(5*p);I=V>>>13,V&=8191,V+=W*(5*y)+E*(5*d)+T*(5*f)+U*(5*u)+P*(5*l),I+=V>>>13,V&=8191;let q=I+C*l+O*a+_*c+D*(5*g)+H*(5*h);I=q>>>13,q&=8191,q+=W*(5*p)+E*(5*y)+T*(5*d)+U*(5*f)+P*(5*u),I+=q>>>13,q&=8191;let et=I+C*u+O*l+_*a+D*c+H*(5*g);I=et>>>13,et&=8191,et+=W*(5*h)+E*(5*p)+T*(5*y)+U*(5*d)+P*(5*f),I+=et>>>13,et&=8191;let at=I+C*f+O*u+_*l+D*a+H*c;I=at>>>13,at&=8191,at+=W*(5*g)+E*(5*h)+T*(5*p)+U*(5*y)+P*(5*d),I+=at>>>13,at&=8191;let ht=I+C*d+O*f+_*u+D*l+H*a;I=ht>>>13,ht&=8191,ht+=W*c+E*(5*g)+T*(5*h)+U*(5*p)+P*(5*y),I+=ht>>>13,ht&=8191;let gt=I+C*y+O*d+_*f+D*u+H*l;I=gt>>>13,gt&=8191,gt+=W*a+E*c+T*(5*g)+U*(5*h)+P*(5*p),I+=gt>>>13,gt&=8191;let lt=I+C*p+O*y+_*d+D*f+H*u;I=lt>>>13,lt&=8191,lt+=W*l+E*a+T*c+U*(5*g)+P*(5*h),I+=lt>>>13,lt&=8191;let It=I+C*h+O*p+_*y+D*d+H*f;I=It>>>13,It&=8191,It+=W*u+E*l+T*a+U*c+P*(5*g),I+=It>>>13,It&=8191;let dt=I+C*g+O*h+_*p+D*y+H*d;I=dt>>>13,dt&=8191,dt+=W*f+E*u+T*l+U*a+P*c,I+=dt>>>13,dt&=8191,I=(I<<2)+I|0,I=I+N|0,N=I&8191,I=I>>>13,V+=I,s[0]=N,s[1]=V,s[2]=q,s[3]=et,s[4]=at,s[5]=ht,s[6]=gt,s[7]=lt,s[8]=It,s[9]=dt}finalize(){let{h:t,pad:n}=this,r=new Uint16Array(10),o=t[1]>>>13;t[1]&=8191;for(let c=2;c<10;c++)t[c]+=o,o=t[c]>>>13,t[c]&=8191;t[0]+=o*5,o=t[0]>>>13,t[0]&=8191,t[1]+=o,o=t[1]>>>13,t[1]&=8191,t[2]+=o,r[0]=t[0]+5,o=r[0]>>>13,r[0]&=8191;for(let c=1;c<10;c++)r[c]=t[c]+o,o=r[c]>>>13,r[c]&=8191;r[9]-=8192;let s=(o^1)-1;for(let c=0;c<10;c++)r[c]&=s;s=~s;for(let c=0;c<10;c++)t[c]=t[c]&s|r[c];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let i=t[0]+n[0];t[0]=i&65535;for(let c=1;c<8;c++)i=(t[c]+n[c]|0)+(i>>>16)|0,t[c]=i&65535}update(t){ce(this);let{buffer:n,blockLen:r}=this;t=_t(t);let o=t.length;for(let s=0;s<o;){let i=Math.min(r-this.pos,o-s);if(i===r){for(;r<=o-s;s+=r)this.process(t,s);continue}n.set(t.subarray(s,s+i),this.pos),this.pos+=i,s+=i,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(t){ce(this),fn(t,this),this.finished=!0;let{buffer:n,h:r}=this,{pos:o}=this;if(o){for(n[o++]=1;o<16;o++)n[o]=0;this.process(n,0,!0)}this.finalize();let s=0;for(let i=0;i<8;i++)t[s++]=r[i]>>>0,t[s++]=r[i]>>>8;return t}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}};function Uu(e){let t=(r,o)=>e(o).update(_t(r)).digest(),n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}var Ic=Uu(e=>new Ho(e));var Uc=e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),_u=Uc("expand 16-byte k"),Lu=Uc("expand 32-byte k"),Ru=j(_u),_c=j(Lu),Sm=_c.slice();function k(e,t){return e<<t|e>>>32-t}function No(e){return e.byteOffset%4===0}var ur=64,Cu=16,Lc=2**32-1,kc=new Uint32Array;function Ou(e,t,n,r,o,s,i,c){let a=o.length,l=new Uint8Array(ur),u=j(l),f=No(o)&&No(s),d=f?j(o):kc,y=f?j(s):kc;for(let p=0;p<a;i++){if(e(t,n,r,u,i,c),i>=Lc)throw new Error("arx: counter overflow");let h=Math.min(ur,a-p);if(f&&h===ur){let g=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let m=0,b;m<Cu;m++)b=g+m,y[b]=d[b]^u[m];p+=ur;continue}for(let g=0,m;g<h;g++)m=p+g,s[m]=o[m]^l[g];p+=h}}function $o(e,t){let{allowShortKeys:n,extendNonceFn:r,counterLength:o,counterRight:s,rounds:i}=yc({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return ir(o),ir(i),Io(s),Io(n),(c,a,l,u,f=0)=>{K(c),K(a),K(l);let d=l.length;if(u||(u=new Uint8Array(d)),K(u),ir(f),f<0||f>=Lc)throw new Error("arx: counter overflow");if(u.length<d)throw new Error(`arx: output (${u.length}) is shorter than data (${d})`);let y=[],p=c.length,h,g;if(p===32)h=c.slice(),y.push(h),g=_c;else if(p===16&&n)h=new Uint8Array(32),h.set(c),h.set(c,16),g=Ru,y.push(h);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);No(a)||(a=a.slice(),y.push(a));let m=j(h);if(r){if(a.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(g,m,j(a.subarray(0,16)),m),a=a.subarray(16)}let b=16-o;if(b!==a.length)throw new Error(`arx: nonce must be ${b} or 16 bytes`);if(b!==12){let w=new Uint8Array(12);w.set(a,s?0:12-a.length),a=w,y.push(a)}let x=j(a);for(Ou(e,g,m,x,l,u,f,i);y.length>0;)y.pop().fill(0);return u}}function Oc(e,t,n,r,o,s=20){let i=e[0],c=e[1],a=e[2],l=e[3],u=t[0],f=t[1],d=t[2],y=t[3],p=t[4],h=t[5],g=t[6],m=t[7],b=o,x=n[0],w=n[1],A=n[2],v=i,S=c,B=a,C=l,O=u,_=f,D=d,H=y,W=p,E=h,T=g,U=m,P=b,I=x,N=w,V=A;for(let et=0;et<s;et+=2)v=v+O|0,P=k(P^v,16),W=W+P|0,O=k(O^W,12),v=v+O|0,P=k(P^v,8),W=W+P|0,O=k(O^W,7),S=S+_|0,I=k(I^S,16),E=E+I|0,_=k(_^E,12),S=S+_|0,I=k(I^S,8),E=E+I|0,_=k(_^E,7),B=B+D|0,N=k(N^B,16),T=T+N|0,D=k(D^T,12),B=B+D|0,N=k(N^B,8),T=T+N|0,D=k(D^T,7),C=C+H|0,V=k(V^C,16),U=U+V|0,H=k(H^U,12),C=C+H|0,V=k(V^C,8),U=U+V|0,H=k(H^U,7),v=v+_|0,V=k(V^v,16),T=T+V|0,_=k(_^T,12),v=v+_|0,V=k(V^v,8),T=T+V|0,_=k(_^T,7),S=S+D|0,P=k(P^S,16),U=U+P|0,D=k(D^U,12),S=S+D|0,P=k(P^S,8),U=U+P|0,D=k(D^U,7),B=B+H|0,I=k(I^B,16),W=W+I|0,H=k(H^W,12),B=B+H|0,I=k(I^B,8),W=W+I|0,H=k(H^W,7),C=C+O|0,N=k(N^C,16),E=E+N|0,O=k(O^E,12),C=C+O|0,N=k(N^C,8),E=E+N|0,O=k(O^E,7);let q=0;r[q++]=i+v|0,r[q++]=c+S|0,r[q++]=a+B|0,r[q++]=l+C|0,r[q++]=u+O|0,r[q++]=f+_|0,r[q++]=d+D|0,r[q++]=y+H|0,r[q++]=p+W|0,r[q++]=h+E|0,r[q++]=g+T|0,r[q++]=m+U|0,r[q++]=b+P|0,r[q++]=x+I|0,r[q++]=w+N|0,r[q++]=A+V|0}function Mu(e,t,n,r){let o=e[0],s=e[1],i=e[2],c=e[3],a=t[0],l=t[1],u=t[2],f=t[3],d=t[4],y=t[5],p=t[6],h=t[7],g=n[0],m=n[1],b=n[2],x=n[3];for(let A=0;A<20;A+=2)o=o+a|0,g=k(g^o,16),d=d+g|0,a=k(a^d,12),o=o+a|0,g=k(g^o,8),d=d+g|0,a=k(a^d,7),s=s+l|0,m=k(m^s,16),y=y+m|0,l=k(l^y,12),s=s+l|0,m=k(m^s,8),y=y+m|0,l=k(l^y,7),i=i+u|0,b=k(b^i,16),p=p+b|0,u=k(u^p,12),i=i+u|0,b=k(b^i,8),p=p+b|0,u=k(u^p,7),c=c+f|0,x=k(x^c,16),h=h+x|0,f=k(f^h,12),c=c+f|0,x=k(x^c,8),h=h+x|0,f=k(f^h,7),o=o+l|0,x=k(x^o,16),p=p+x|0,l=k(l^p,12),o=o+l|0,x=k(x^o,8),p=p+x|0,l=k(l^p,7),s=s+u|0,g=k(g^s,16),h=h+g|0,u=k(u^h,12),s=s+u|0,g=k(g^s,8),h=h+g|0,u=k(u^h,7),i=i+f|0,m=k(m^i,16),d=d+m|0,f=k(f^d,12),i=i+f|0,m=k(m^i,8),d=d+m|0,f=k(f^d,7),c=c+a|0,b=k(b^c,16),y=y+b|0,a=k(a^y,12),c=c+a|0,b=k(b^c,8),y=y+b|0,a=k(a^y,7);let w=0;r[w++]=o,r[w++]=s,r[w++]=i,r[w++]=c,r[w++]=g,r[w++]=m,r[w++]=b,r[w++]=x}var dr=$o(Oc,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Pu=$o(Oc,{counterRight:!1,counterLength:8,extendNonceFn:Mu,allowShortKeys:!1});var Du=new Uint8Array(16),Rc=(e,t)=>{e.update(t);let n=t.length%16;n&&e.update(Du.subarray(n))},Hu=new Uint8Array(32);function Cc(e,t,n,r,o){let s=e(t,n,Hu),i=Ic.create(s);o&&Rc(i,o),Rc(i,r);let c=new Uint8Array(16),a=ae(c);Ie(a,0,BigInt(o?o.length:0),!0),Ie(a,8,BigInt(r.length),!0),i.update(c);let l=i.digest();return s.fill(0),l}var Mc=e=>(t,n,r)=>(K(t,32),K(n),{encrypt:(s,i)=>{let c=s.length,a=c+16;i?K(i,a):i=new Uint8Array(a),e(t,n,s,i,1);let l=Cc(e,t,n,i.subarray(0,-16),r);return i.set(l,c),i},decrypt:(s,i)=>{let c=s.length,a=c-16;if(c<16)throw new Error("encrypted data must be at least 16 bytes");i?K(i,a):i=new Uint8Array(a);let l=s.subarray(0,-16),u=s.subarray(-16),f=Cc(e,t,n,l,r);if(!Te(u,f))throw new Error("invalid tag");return e(t,n,l,i,1),i}}),Um=Lt({blockSize:64,nonceLength:12,tagLength:16},Mc(dr)),_m=Lt({blockSize:64,nonceLength:24,tagLength:16},Mc(Pu));var hr=class extends Ne{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,yt.hash(t);let r=ne(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,s=new Uint8Array(o);s.set(r.length>o?t.create().update(r).digest():r);for(let i=0;i<s.length;i++)s[i]^=54;this.iHash.update(s),this.oHash=t.create();for(let i=0;i<s.length;i++)s[i]^=106;this.oHash.update(s),s.fill(0)}update(t){return yt.exists(this),this.iHash.update(t),this}digestInto(t){yt.exists(this),yt.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:n,iHash:r,finished:o,destroyed:s,blockLen:i,outputLen:c}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=i,t.outputLen=c,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},ze=(e,t,n)=>new hr(e,t).update(n).digest();ze.create=(e,t)=>new hr(e,t);function Dc(e,t,n){return yt.hash(e),n===void 0&&(n=new Uint8Array(e.outputLen)),ze(e,ne(n),ne(t))}var Ko=new Uint8Array([0]),Pc=new Uint8Array;function Hc(e,t,n,r=32){if(yt.hash(e),yt.number(r),r>255*e.outputLen)throw new Error("Length should be <= 255*HashLen");let o=Math.ceil(r/e.outputLen);n===void 0&&(n=Pc);let s=new Uint8Array(o*e.outputLen),i=ze.create(e,t),c=i._cloneInto(),a=new Uint8Array(i.outputLen);for(let l=0;l<o;l++)Ko[0]=l+1,c.update(l===0?Pc:a).update(n).update(Ko).digestInto(a),s.set(a,e.outputLen*l),i._cloneInto(c);return i.destroy(),c.destroy(),a.fill(0),Ko.fill(0),s.slice(0,r)}var Nu=Object.defineProperty,F=(e,t)=>{for(var n in t)Nu(e,n,{get:t[n],enumerable:!0})},We=Symbol("verified"),$u=e=>e instanceof Object;function qo(e){if(!$u(e)||typeof e.kind!="number"||typeof e.content!="string"||typeof e.created_at!="number"||typeof e.pubkey!="string"||!e.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(e.tags))return!1;for(let t=0;t<e.tags.length;t++){let n=e.tags[t];if(!Array.isArray(n))return!1;for(let r=0;r<n.length;r++)if(typeof n[r]=="object")return!1}return!0}var Ku={};F(Ku,{Queue:()=>Wu,QueueNode:()=>Kc,binarySearch:()=>zo,insertEventIntoAscendingList:()=>zu,insertEventIntoDescendingList:()=>qu,normalizeURL:()=>ju,utf8Decoder:()=>Zt,utf8Encoder:()=>Tt});var Zt=new TextDecoder("utf-8"),Tt=new TextEncoder;function ju(e){e.indexOf("://")===-1&&(e="wss://"+e);let t=new URL(e);return t.pathname=t.pathname.replace(/\/+/g,"/"),t.pathname.endsWith("/")&&(t.pathname=t.pathname.slice(0,-1)),(t.port==="80"&&t.protocol==="ws:"||t.port==="443"&&t.protocol==="wss:")&&(t.port=""),t.searchParams.sort(),t.hash="",t.toString()}function qu(e,t){let[n,r]=zo(e,o=>t.id===o.id?0:t.created_at===o.created_at?-1:o.created_at-t.created_at);return r||e.splice(n,0,t),e}function zu(e,t){let[n,r]=zo(e,o=>t.id===o.id?0:t.created_at===o.created_at?-1:t.created_at-o.created_at);return r||e.splice(n,0,t),e}function zo(e,t){let n=0,r=e.length-1;for(;n<=r;){let o=Math.floor((n+r)/2),s=t(e[o]);if(s===0)return[o,!0];s<0?r=o-1:n=o+1}return[n,!1]}var Kc=class{value;next=null;prev=null;constructor(e){this.value=e}},Wu=class{first;last;constructor(){this.first=null,this.last=null}enqueue(e){let t=new Kc(e);return this.last?this.last===this.first?(this.last=t,this.last.prev=this.first,this.first.next=t):(t.prev=this.last,this.last.next=t,this.last=t):(this.first=t,this.last=t),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){let t=this.first;return this.first=null,this.last=null,t.value}let e=this.first;return this.first=e.next,e.value}},Vu=class{generateSecretKey(){return bt.utils.randomPrivateKey()}getPublicKey(e){return Z(bt.getPublicKey(e))}finalizeEvent(e,t){let n=e;return n.pubkey=Z(bt.getPublicKey(t)),n.id=pr(n),n.sig=Z(bt.sign(pr(n),t)),n[We]=!0,n}verifyEvent(e){if(typeof e[We]=="boolean")return e[We];let t=pr(e);if(t!==e.id)return e[We]=!1,!1;try{let n=bt.verify(e.sig,t,e.pubkey);return e[We]=n,n}catch{return e[We]=!1,!1}}};function Zu(e){if(!qo(e))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content])}function pr(e){let t=xt(Tt.encode(Zu(e)));return Z(t)}var gr=new Vu,Gu=gr.generateSecretKey,Wo=gr.getPublicKey,Ot=gr.finalizeEvent,Vo=gr.verifyEvent,mr={};F(mr,{Application:()=>Gd,BadgeAward:()=>rd,BadgeDefinition:()=>Kd,BlockedRelaysList:()=>Bd,BookmarkList:()=>Ed,Bookmarksets:()=>Hd,Calendar:()=>eh,CalendarEventRSVP:()=>nh,ChannelCreation:()=>Zc,ChannelHideMessage:()=>Jc,ChannelMessage:()=>Fc,ChannelMetadata:()=>Gc,ChannelMuteUser:()=>Xc,ClassifiedListing:()=>Xd,ClientAuth:()=>Qc,CommunitiesList:()=>Sd,CommunityDefinition:()=>sh,CommunityPostApproval:()=>ud,Contacts:()=>td,CreateOrUpdateProduct:()=>zd,CreateOrUpdateStall:()=>qd,Curationsets:()=>Nd,Date:()=>Qd,DirectMessageRelaysList:()=>Ud,DraftClassifiedListing:()=>Yd,DraftLong:()=>Vd,Emojisets:()=>Zd,EncryptedDirectMessage:()=>ed,EventDeletion:()=>nd,FileMetadata:()=>sd,FileServerPreference:()=>_d,Followsets:()=>Md,GenericRepost:()=>Jo,Genericlists:()=>Pd,GiftWrap:()=>Yc,HTTPAuth:()=>Xo,Handlerinformation:()=>oh,Handlerrecommendation:()=>rh,Highlights:()=>bd,InterestsList:()=>Id,Interestsets:()=>jd,JobFeedback:()=>pd,JobRequest:()=>dd,JobResult:()=>hd,Label:()=>fd,LightningPubRPC:()=>Rd,LiveChatMessage:()=>id,LiveEvent:()=>Fd,LongFormArticle:()=>Wd,Metadata:()=>Yu,Mutelist:()=>xd,NWCWalletInfo:()=>Ld,NWCWalletRequest:()=>ta,NWCWalletResponse:()=>Cd,NostrConnect:()=>Od,OpenTimestamps:()=>od,Pinlist:()=>wd,PrivateDirectMessage:()=>Vc,ProblemTracker:()=>cd,ProfileBadges:()=>$d,PublicChatsList:()=>Ad,Reaction:()=>Fo,RecommendRelay:()=>Qu,RelayList:()=>vd,Relaysets:()=>Dd,Report:()=>ad,Reporting:()=>ld,Repost:()=>Go,Seal:()=>Wc,SearchRelaysList:()=>Td,ShortTextNote:()=>zc,Time:()=>th,UserEmojiList:()=>kd,UserStatuses:()=>Jd,Zap:()=>md,ZapGoal:()=>yd,ZapRequest:()=>gd,classifyKind:()=>Ju,isAddressableKind:()=>br,isEphemeralKind:()=>qc,isKind:()=>Xu,isParameterizedReplaceableKind:()=>Fu,isRegularKind:()=>jc,isReplaceableKind:()=>Zo});function jc(e){return 1e3<=e&&e<1e4||[1,2,4,5,6,7,8,16,40,41,42,43,44].includes(e)}function Zo(e){return[0,3].includes(e)||1e4<=e&&e<2e4}function qc(e){return 2e4<=e&&e<3e4}function br(e){return 3e4<=e&&e<4e4}var Fu=br;function Ju(e){return jc(e)?"regular":Zo(e)?"replaceable":qc(e)?"ephemeral":br(e)?"parameterized":"unknown"}function Xu(e,t){let n=t instanceof Array?t:[t];return qo(e)&&n.includes(e.kind)||!1}var Yu=0,zc=1,Qu=2,td=3,ed=4,nd=5,Go=6,Fo=7,rd=8,Wc=13,Vc=14,Jo=16,Zc=40,Gc=41,Fc=42,Jc=43,Xc=44,od=1040,Yc=1059,sd=1063,id=1311,cd=1971,ad=1984,ld=1984,fd=1985,ud=4550,dd=5999,hd=6999,pd=7e3,yd=9041,gd=9734,md=9735,bd=9802,xd=1e4,wd=10001,vd=10002,Ed=10003,Sd=10004,Ad=10005,Bd=10006,Td=10007,Id=10015,kd=10030,Ud=10050,_d=10096,Ld=13194,Rd=21e3,Qc=22242,ta=23194,Cd=23195,Od=24133,Xo=27235,Md=3e4,Pd=30001,Dd=30002,Hd=30003,Nd=30004,$d=30008,Kd=30009,jd=30015,qd=30017,zd=30018,Wd=30023,Vd=30024,Zd=30030,Gd=30078,Fd=30311,Jd=30315,Xd=30402,Yd=30403,Qd=31922,th=31923,eh=31924,nh=31925,rh=31989,oh=31990,sh=34550;var ih={};F(ih,{getHex64:()=>Yo,getInt:()=>ea,getSubscriptionId:()=>ch,matchEventId:()=>ah,matchEventKind:()=>fh,matchEventPubkey:()=>lh});function Yo(e,t){let n=t.length+3,r=e.indexOf(`"${t}":`)+n,o=e.slice(r).indexOf('"')+r+1;return e.slice(o,o+64)}function ea(e,t){let n=t.length,r=e.indexOf(`"${t}":`)+n+3,o=e.slice(r),s=Math.min(o.indexOf(","),o.indexOf("}"));return parseInt(o.slice(0,s),10)}function ch(e){let t=e.slice(0,22).indexOf('"EVENT"');if(t===-1)return null;let n=e.slice(t+7+1).indexOf('"');if(n===-1)return null;let r=t+7+1+n,o=e.slice(r+1,80).indexOf('"');if(o===-1)return null;let s=r+1+o;return e.slice(r+1,s)}function ah(e,t){return t===Yo(e,"id")}function lh(e,t){return t===Yo(e,"pubkey")}function fh(e,t){return t===ea(e,"kind")}var uh={};F(uh,{makeAuthEvent:()=>dh});function dh(e,t){return{kind:Qc,created_at:Math.floor(Date.now()/1e3),tags:[["relay",e],["challenge",t]],content:""}}var hh;try{hh=WebSocket}catch{}var ph;try{ph=WebSocket}catch{}var yh={};F(yh,{BECH32_REGEX:()=>na,Bech32MaxSize:()=>Qo,NostrTypeGuard:()=>gh,decode:()=>xr,decodeNostrURI:()=>bh,encodeBytes:()=>vr,naddrEncode:()=>Ah,neventEncode:()=>Sh,noteEncode:()=>vh,nprofileEncode:()=>Eh,npubEncode:()=>wh,nsecEncode:()=>xh});var gh={isNProfile:e=>/^nprofile1[a-z\d]+$/.test(e||""),isNEvent:e=>/^nevent1[a-z\d]+$/.test(e||""),isNAddr:e=>/^naddr1[a-z\d]+$/.test(e||""),isNSec:e=>/^nsec1[a-z\d]{58}$/.test(e||""),isNPub:e=>/^npub1[a-z\d]{58}$/.test(e||""),isNote:e=>/^note1[a-z\d]+$/.test(e||""),isNcryptsec:e=>/^ncryptsec1[a-z\d]+$/.test(e||"")},Qo=5e3,na=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function mh(e){let t=new Uint8Array(4);return t[0]=e>>24&255,t[1]=e>>16&255,t[2]=e>>8&255,t[3]=e&255,t}function bh(e){try{return e.startsWith("nostr:")&&(e=e.substring(6)),xr(e)}catch{return{type:"invalid",data:null}}}function xr(e){let{prefix:t,words:n}=ie.decode(e,Qo),r=new Uint8Array(ie.fromWords(n));switch(t){case"nprofile":{let o=jo(r);if(!o[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(o[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:Z(o[0][0]),relays:o[1]?o[1].map(s=>Zt.decode(s)):[]}}}case"nevent":{let o=jo(r);if(!o[0]?.[0])throw new Error("missing TLV 0 for nevent");if(o[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");if(o[2]&&o[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(o[3]&&o[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:Z(o[0][0]),relays:o[1]?o[1].map(s=>Zt.decode(s)):[],author:o[2]?.[0]?Z(o[2][0]):void 0,kind:o[3]?.[0]?parseInt(Z(o[3][0]),16):void 0}}}case"naddr":{let o=jo(r);if(!o[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!o[2]?.[0])throw new Error("missing TLV 2 for naddr");if(o[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(!o[3]?.[0])throw new Error("missing TLV 3 for naddr");if(o[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:Zt.decode(o[0][0]),pubkey:Z(o[2][0]),kind:parseInt(Z(o[3][0]),16),relays:o[1]?o[1].map(s=>Zt.decode(s)):[]}}}case"nsec":return{type:t,data:r};case"npub":case"note":return{type:t,data:Z(r)};default:throw new Error(`unknown prefix ${t}`)}}function jo(e){let t={},n=e;for(;n.length>0;){let r=n[0],o=n[1],s=n.slice(2,2+o);if(n=n.slice(2+o),s.length<o)throw new Error(`not enough data to read on TLV ${r}`);t[r]=t[r]||[],t[r].push(s)}return t}function xh(e){return vr("nsec",e)}function wh(e){return vr("npub",Be(e))}function vh(e){return vr("note",Be(e))}function wr(e,t){let n=ie.toWords(t);return ie.encode(e,n,Qo)}function vr(e,t){return wr(e,t)}function Eh(e){let t=ts({0:[Be(e.pubkey)],1:(e.relays||[]).map(n=>Tt.encode(n))});return wr("nprofile",t)}function Sh(e){let t;e.kind!==void 0&&(t=mh(e.kind));let n=ts({0:[Be(e.id)],1:(e.relays||[]).map(r=>Tt.encode(r)),2:e.author?[Be(e.author)]:[],3:t?[new Uint8Array(t)]:[]});return wr("nevent",n)}function Ah(e){let t=new ArrayBuffer(4);new DataView(t).setUint32(0,e.kind,!1);let n=ts({0:[Tt.encode(e.identifier)],1:(e.relays||[]).map(r=>Tt.encode(r)),2:[Be(e.pubkey)],3:[new Uint8Array(t)]});return wr("naddr",n)}function ts(e){let t=[];return Object.entries(e).reverse().forEach(([n,r])=>{r.forEach(o=>{let s=new Uint8Array(o.length+2);s.set([parseInt(n)],0),s.set([o.length],1),s.set(o,2),t.push(s)})}),$e(...t)}var Bh={};F(Bh,{decrypt:()=>Th,encrypt:()=>ra});function ra(e,t,n){let r=e instanceof Uint8Array?Z(e):e,o=ee.getSharedSecret(r,"02"+t),s=oa(o),i=Uint8Array.from(er(16)),c=Tt.encode(n),a=Do(s,i).encrypt(c),l=wt.encode(new Uint8Array(a)),u=wt.encode(new Uint8Array(i.buffer));return`${l}?iv=${u}`}function Th(e,t,n){let r=e instanceof Uint8Array?Z(e):e,[o,s]=n.split("?iv="),i=ee.getSharedSecret(r,"02"+t),c=oa(i),a=wt.decode(s),l=wt.decode(o),u=Do(c,a).decrypt(l);return Zt.decode(u)}function oa(e){return e.slice(1,33)}var Ih={};F(Ih,{NIP05_REGEX:()=>es,isNip05:()=>kh,isValid:()=>Lh,queryProfile:()=>sa,searchDomain:()=>_h,useFetchImplementation:()=>Uh});var es=/^(?:([\w.+-]+)@)?([\w_-]+(\.[\w_-]+)+)$/,kh=e=>es.test(e||""),Er;try{Er=fetch}catch{}function Uh(e){Er=e}function _h(e,t=""){return R(this,null,function*(){try{let n=`https://${e}/.well-known/nostr.json?name=${t}`,r=yield Er(n,{redirect:"manual"});if(r.status!==200)throw Error("Wrong response code");return(yield r.json()).names}catch{return{}}})}function sa(e){return R(this,null,function*(){let t=e.match(es);if(!t)return null;let[,n="_",r]=t;try{let o=`https://${r}/.well-known/nostr.json?name=${n}`,s=yield Er(o,{redirect:"manual"});if(s.status!==200)throw Error("Wrong response code");let i=yield s.json(),c=i.names[n];return c?{pubkey:c,relays:i.relays?.[c]}:null}catch{return null}})}function Lh(e,t){return R(this,null,function*(){let n=yield sa(t);return n?n.pubkey===e:!1})}var Rh={};F(Rh,{parse:()=>Ch});function Ch(e){let t={reply:void 0,root:void 0,mentions:[],profiles:[],quotes:[]},n,r;for(let o=e.tags.length-1;o>=0;o--){let s=e.tags[o];if(s[0]==="e"&&s[1]){let[i,c,a,l,u]=s,f={id:c,relays:a?[a]:[],author:u};if(l==="root"){t.root=f;continue}if(l==="reply"){t.reply=f;continue}if(l==="mention"){t.mentions.push(f);continue}n?r=f:n=f,t.mentions.push(f);continue}if(s[0]==="q"&&s[1]){let[i,c,a]=s;t.quotes.push({id:c,relays:a?[a]:[]})}if(s[0]==="p"&&s[1]){t.profiles.push({pubkey:s[1],relays:s[2]?[s[2]]:[]});continue}}return t.root||(t.root=r||n||t.reply),t.reply||(t.reply=n||t.root),[t.reply,t.root].forEach(o=>{if(!o)return;let s=t.mentions.indexOf(o);if(s!==-1&&t.mentions.splice(s,1),o.author){let i=t.profiles.find(c=>c.pubkey===o.author);i&&i.relays&&(o.relays||(o.relays=[]),i.relays.forEach(c=>{o.relays?.indexOf(c)===-1&&o.relays.push(c)}),i.relays=o.relays)}}),t.mentions.forEach(o=>{if(o.author){let s=t.profiles.find(i=>i.pubkey===o.author);s&&s.relays&&(o.relays||(o.relays=[]),s.relays.forEach(i=>{o.relays.indexOf(i)===-1&&o.relays.push(i)}),s.relays=o.relays)}}),t}var Oh={};F(Oh,{fetchRelayInformation:()=>Ph,useFetchImplementation:()=>Mh});var ia;try{ia=fetch}catch{}function Mh(e){ia=e}function Ph(e){return R(this,null,function*(){return yield(yield fetch(e.replace("ws://","http://").replace("wss://","https://"),{headers:{Accept:"application/nostr+json"}})).json()})}var Dh={};F(Dh,{fastEventHash:()=>aa,getPow:()=>ca,minePow:()=>Hh});function ca(e){let t=0;for(let n=0;n<64;n+=8){let r=parseInt(e.substring(n,n+8),16);if(r===0)t+=32;else{t+=Math.clz32(r);break}}return t}function Hh(e,t){let n=0,r=e,o=["nonce",n.toString(),t.toString()];for(r.tags.push(o);;){let s=Math.floor(new Date().getTime()/1e3);if(s!==r.created_at&&(n=0,r.created_at=s),o[1]=(++n).toString(),r.id=aa(r),ca(r.id)>=t)break}return r}function aa(e){return Z(xt(Tt.encode(JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content]))))}var Nh={};F(Nh,{unwrapEvent:()=>Xh,unwrapManyEvents:()=>Yh,wrapEvent:()=>va,wrapManyEvents:()=>Jh});var $h={};F($h,{createRumor:()=>ma,createSeal:()=>ba,createWrap:()=>xa,unwrapEvent:()=>is,unwrapManyEvents:()=>wa,wrapEvent:()=>yr,wrapManyEvents:()=>Gh});var Kh={};F(Kh,{decrypt:()=>ss,encrypt:()=>os,getConversationKey:()=>ns,v2:()=>Vh});var la=1,fa=65535;function ns(e,t){let n=ee.getSharedSecret(e,"02"+t).subarray(1,33);return Dc(xt,n,"nip44-v2")}function ua(e,t){let n=Hc(xt,e,t,76);return{chacha_key:n.subarray(0,32),chacha_nonce:n.subarray(32,44),hmac_key:n.subarray(44,76)}}function rs(e){if(!Number.isSafeInteger(e)||e<1)throw new Error("expected positive integer");if(e<=32)return 32;let t=1<<Math.floor(Math.log2(e-1))+1,n=t<=256?32:t/8;return n*(Math.floor((e-1)/n)+1)}function jh(e){if(!Number.isSafeInteger(e)||e<la||e>fa)throw new Error("invalid plaintext size: must be between 1 and 65535 bytes");let t=new Uint8Array(2);return new DataView(t.buffer).setUint16(0,e,!1),t}function qh(e){let t=Tt.encode(e),n=t.length,r=jh(n),o=new Uint8Array(rs(n)-n);return $e(r,t,o)}function zh(e){let t=new DataView(e.buffer).getUint16(0),n=e.subarray(2,2+t);if(t<la||t>fa||n.length!==t||e.length!==2+rs(t))throw new Error("invalid padding");return Zt.decode(n)}function da(e,t,n){if(n.length!==32)throw new Error("AAD associated data must be 32 bytes");let r=$e(n,t);return ze(xt,e,r)}function Wh(e){if(typeof e!="string")throw new Error("payload must be a valid string");let t=e.length;if(t<132||t>87472)throw new Error("invalid payload length: "+t);if(e[0]==="#")throw new Error("unknown encryption version");let n;try{n=wt.decode(e)}catch(s){throw new Error("invalid base64: "+s.message)}let r=n.length;if(r<99||r>65603)throw new Error("invalid data length: "+r);let o=n[0];if(o!==2)throw new Error("unknown encryption version "+o);return{nonce:n.subarray(1,33),ciphertext:n.subarray(33,-32),mac:n.subarray(-32)}}function os(e,t,n=er(32)){let{chacha_key:r,chacha_nonce:o,hmac_key:s}=ua(t,n),i=qh(e),c=dr(r,o,i),a=da(s,c,n);return wt.encode($e(new Uint8Array([2]),n,c,a))}function ss(e,t){let{nonce:n,ciphertext:r,mac:o}=Wh(e),{chacha_key:s,chacha_nonce:i,hmac_key:c}=ua(t,n),a=da(c,r,n);if(!Te(a,o))throw new Error("invalid MAC");let l=dr(s,i,r);return zh(l)}var Vh={utils:{getConversationKey:ns,calcPaddedLen:rs},encrypt:os,decrypt:ss},Zh=2*24*60*60,ha=()=>Math.round(Date.now()/1e3),pa=()=>Math.round(ha()-Math.random()*Zh),ya=(e,t)=>ns(e,t),ga=(e,t,n)=>os(JSON.stringify(e),ya(t,n)),Nc=(e,t)=>JSON.parse(ss(e.content,ya(t,e.pubkey)));function ma(e,t){let n=G(z({created_at:ha(),content:"",tags:[]},e),{pubkey:Wo(t)});return n.id=pr(n),n}function ba(e,t,n){return Ot({kind:Wc,content:ga(e,t,n),created_at:pa(),tags:[]},t)}function xa(e,t){let n=Gu();return Ot({kind:Yc,content:ga(e,n,t),created_at:pa(),tags:[["p",t]]},n)}function yr(e,t,n){let r=ma(e,t),o=ba(r,t,n);return xa(o,n)}function Gh(e,t,n){if(!n||n.length===0)throw new Error("At least one recipient is required.");let r=Wo(t),o=[yr(e,t,r)];return n.forEach(s=>{o.push(yr(e,t,s))}),o}function is(e,t){let n=Nc(e,t);return Nc(n,t)}function wa(e,t){let n=[];return e.forEach(r=>{n.push(is(r,t))}),n.sort((r,o)=>r.created_at-o.created_at),n}function Fh(e,t,n,r){let o={created_at:Math.ceil(Date.now()/1e3),kind:Vc,tags:[],content:t};return(Array.isArray(e)?e:[e]).forEach(({publicKey:i,relayUrl:c})=>{o.tags.push(c?["p",i,c]:["p",i])}),r&&o.tags.push(["e",r.eventId,r.relayUrl||"","reply"]),n&&o.tags.push(["subject",n]),o}function va(e,t,n,r,o){let s=Fh(t,n,r,o);return yr(s,e,t.publicKey)}function Jh(e,t,n,r,o){if(!t||t.length===0)throw new Error("At least one recipient is required.");return[{publicKey:Wo(e)},...t].map(i=>va(e,i,n,r,o))}var Xh=is,Yh=wa,Qh={};F(Qh,{finishRepostEvent:()=>t0,getRepostedEvent:()=>e0,getRepostedEventPointer:()=>Ea});function t0(e,t,n,r){let o,s=[...e.tags??[],["e",t.id,n],["p",t.pubkey]];return t.kind===zc?o=Go:(o=Jo,s.push(["k",String(t.kind)])),Ot({kind:o,tags:s,content:e.content===""||t.tags?.find(i=>i[0]==="-")?"":JSON.stringify(t),created_at:e.created_at},r)}function Ea(e){if(![Go,Jo].includes(e.kind))return;let t,n;for(let r=e.tags.length-1;r>=0&&(t===void 0||n===void 0);r--){let o=e.tags[r];o.length>=2&&(o[0]==="e"&&t===void 0?t=o:o[0]==="p"&&n===void 0&&(n=o))}if(t!==void 0)return{id:t[1],relays:[t[2],n?.[2]].filter(r=>typeof r=="string"),author:n?.[1]}}function e0(e,{skipVerification:t}={}){let n=Ea(e);if(n===void 0||e.content==="")return;let r;try{r=JSON.parse(e.content)}catch{return}if(r.id===n.id&&!(!t&&!Vo(r)))return r}var n0={};F(n0,{NOSTR_URI_REGEX:()=>cs,parse:()=>o0,test:()=>r0});var cs=new RegExp(`nostr:(${na.source})`);function r0(e){return typeof e=="string"&&new RegExp(`^${cs.source}$`).test(e)}function o0(e){let t=e.match(new RegExp(`^${cs.source}$`));if(!t)throw new Error(`Invalid Nostr URI: ${e}`);return{uri:t[0],value:t[1],decoded:xr(t[1])}}var s0={};F(s0,{finishReactionEvent:()=>i0,getReactedEventPointer:()=>c0});function i0(e,t,n){let r=t.tags.filter(o=>o.length>=2&&(o[0]==="e"||o[0]==="p"));return Ot(G(z({},e),{kind:Fo,tags:[...e.tags??[],...r,["e",t.id],["p",t.pubkey]],content:e.content??"+"}),n)}function c0(e){if(e.kind!==Fo)return;let t,n;for(let r=e.tags.length-1;r>=0&&(t===void 0||n===void 0);r--){let o=e.tags[r];o.length>=2&&(o[0]==="e"&&t===void 0?t=o:o[0]==="p"&&n===void 0&&(n=o))}if(!(t===void 0||n===void 0))return{id:t[1],relays:[t[2],n[2]].filter(r=>r!==void 0),author:n[1]}}var a0={};F(a0,{parse:()=>f0});var l0=/\W/m,$c=/\W |\W$|$|,| /m;function*f0(e){let t=e.length,n=0,r=0;for(;r<t;){let o=e.indexOf(":",r);if(o===-1)break;if(e.substring(o-5,o)==="nostr"){let s=e.substring(o+60).match(l0),i=s?o+60+s.index:t;try{let c,{data:a,type:l}=xr(e.substring(o+1,i));switch(l){case"npub":c={pubkey:a};break;case"nsec":case"note":r=i+1;continue;default:c=a}n!==o-5&&(yield{type:"text",text:e.substring(n,o-5)}),yield{type:"reference",pointer:c},r=i,n=r;continue}catch{r=o+1;continue}}else if(e.substring(o-5,o)==="https"||e.substring(o-4,o)==="http"){let s=e.substring(o+4).match($c),i=s?o+4+s.index:t,c=e[o-1]==="s"?5:4;try{let a=new URL(e.substring(o-c,i));if(a.hostname.indexOf(".")===-1)throw new Error("invalid url");if(n!==o-c&&(yield{type:"text",text:e.substring(n,o-c)}),a.pathname.endsWith(".png")||a.pathname.endsWith(".jpg")||a.pathname.endsWith(".jpeg")||a.pathname.endsWith(".gif")||a.pathname.endsWith(".webp")){yield{type:"image",url:a.toString()},r=i,n=r;continue}if(a.pathname.endsWith(".mp4")||a.pathname.endsWith(".avi")||a.pathname.endsWith(".webm")||a.pathname.endsWith(".mkv")){yield{type:"video",url:a.toString()},r=i,n=r;continue}if(a.pathname.endsWith(".mp3")||a.pathname.endsWith(".aac")||a.pathname.endsWith(".ogg")||a.pathname.endsWith(".opus")){yield{type:"audio",url:a.toString()},r=i,n=r;continue}yield{type:"url",url:a.toString()},r=i,n=r;continue}catch{r=i+1;continue}}else if(e.substring(o-3,o)==="wss"||e.substring(o-2,o)==="ws"){let s=e.substring(o+4).match($c),i=s?o+4+s.index:t,c=e[o-1]==="s"?3:2;try{let a=new URL(e.substring(o-c,i));if(a.hostname.indexOf(".")===-1)throw new Error("invalid ws url");n!==o-c&&(yield{type:"text",text:e.substring(n,o-c)}),yield{type:"relay",url:a.toString()},r=i,n=r;continue}catch{r=i+1;continue}}else{r=o+1;continue}}n!==t&&(yield{type:"text",text:e.substring(n)})}var u0={};F(u0,{channelCreateEvent:()=>d0,channelHideMessageEvent:()=>y0,channelMessageEvent:()=>p0,channelMetadataEvent:()=>h0,channelMuteUserEvent:()=>g0});var d0=(e,t)=>{let n;if(typeof e.content=="object")n=JSON.stringify(e.content);else if(typeof e.content=="string")n=e.content;else return;return Ot({kind:Zc,tags:[...e.tags??[]],content:n,created_at:e.created_at},t)},h0=(e,t)=>{let n;if(typeof e.content=="object")n=JSON.stringify(e.content);else if(typeof e.content=="string")n=e.content;else return;return Ot({kind:Gc,tags:[["e",e.channel_create_event_id],...e.tags??[]],content:n,created_at:e.created_at},t)},p0=(e,t)=>{let n=[["e",e.channel_create_event_id,e.relay_url,"root"]];return e.reply_to_channel_message_event_id&&n.push(["e",e.reply_to_channel_message_event_id,e.relay_url,"reply"]),Ot({kind:Fc,tags:[...n,...e.tags??[]],content:e.content,created_at:e.created_at},t)},y0=(e,t)=>{let n;if(typeof e.content=="object")n=JSON.stringify(e.content);else if(typeof e.content=="string")n=e.content;else return;return Ot({kind:Jc,tags:[["e",e.channel_message_event_id],...e.tags??[]],content:n,created_at:e.created_at},t)},g0=(e,t)=>{let n;if(typeof e.content=="object")n=JSON.stringify(e.content);else if(typeof e.content=="string")n=e.content;else return;return Ot({kind:Xc,tags:[["p",e.pubkey_to_mute],...e.tags??[]],content:n,created_at:e.created_at},t)},m0={};F(m0,{EMOJI_SHORTCODE_REGEX:()=>Sa,matchAll:()=>b0,regex:()=>as,replaceAll:()=>x0});var Sa=/:(\w+):/,as=()=>new RegExp(`\\B${Sa.source}\\B`,"g");function*b0(e){let t=e.matchAll(as());for(let n of t)try{let[r,o]=n;yield{shortcode:r,name:o,start:n.index,end:n.index+r.length}}catch{}}function x0(e,t){return e.replaceAll(as(),(n,r)=>t({shortcode:n,name:r}))}var w0={};F(w0,{useFetchImplementation:()=>v0,validateGithub:()=>E0});var ls;try{ls=fetch}catch{}function v0(e){ls=e}function E0(e,t,n){return R(this,null,function*(){try{return(yield(yield ls(`https://gist.github.com/${t}/${n}/raw`)).text())===`Verifying that I control the following Nostr public key: ${e}`}catch{return!1}})}var S0={};F(S0,{makeNwcRequestEvent:()=>B0,parseConnectionString:()=>A0});function A0(e){let{pathname:t,searchParams:n}=new URL(e),r=t,o=n.get("relay"),s=n.get("secret");if(!r||!o||!s)throw new Error("invalid connection string");return{pubkey:r,relay:o,secret:s}}function B0(e,t,n){return R(this,null,function*(){let o=yield ra(t,e,JSON.stringify({method:"pay_invoice",params:{invoice:n}})),s={kind:ta,created_at:Math.round(Date.now()/1e3),content:o,tags:[["p",e]]};return Ot(s,t)})}var T0={};F(T0,{normalizeIdentifier:()=>I0});function I0(e){return e=e.trim().toLowerCase(),e=e.normalize("NFKC"),Array.from(e).map(t=>new RegExp("\\p{Letter}","u").test(t)||new RegExp("\\p{Number}","u").test(t)?t:"-").join("")}var k0={};F(k0,{getZapEndpoint:()=>_0,makeZapReceipt:()=>C0,makeZapRequest:()=>L0,useFetchImplementation:()=>U0,validateZapRequest:()=>R0});var fs;try{fs=fetch}catch{}function U0(e){fs=e}function _0(e){return R(this,null,function*(){try{let t="",{lud06:n,lud16:r}=JSON.parse(e.content);if(n){let{words:i}=ie.decode(n,1e3),c=ie.fromWords(i);t=Zt.decode(c)}else if(r){let[i,c]=r.split("@");t=new URL(`/.well-known/lnurlp/${i}`,`https://${c}`).toString()}else return null;let s=yield(yield fs(t)).json();if(s.allowsNostr&&s.nostrPubkey)return s.callback}catch{}return null})}function L0({profile:e,event:t,amount:n,relays:r,comment:o=""}){if(!n)throw new Error("amount not given");if(!e)throw new Error("profile not given");let s={kind:9734,created_at:Math.round(Date.now()/1e3),content:o,tags:[["p",e],["amount",n.toString()],["relays",...r]]};if(t&&typeof t=="string"&&s.tags.push(["e",t]),t&&typeof t=="object"){if(Zo(t.kind)){let i=["a",`${t.kind}:${t.pubkey}:`];s.tags.push(i)}else if(br(t.kind)){let i=t.tags.find(([a,l])=>a==="d"&&l);if(!i)throw new Error("d tag not found or is empty");let c=["a",`${t.kind}:${t.pubkey}:${i[1]}`];s.tags.push(c)}}return s}function R0(e){let t;try{t=JSON.parse(e)}catch{return"Invalid zap request JSON."}if(!qo(t))return"Zap request is not a valid Nostr event.";if(!Vo(t))return"Invalid signature on zap request.";let n=t.tags.find(([s,i])=>s==="p"&&i);if(!n)return"Zap request doesn't have a 'p' tag.";if(!n[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let r=t.tags.find(([s,i])=>s==="e"&&i);return r&&!r[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":t.tags.find(([s,i])=>s==="relays"&&i)?null:"Zap request doesn't have a 'relays' tag."}function C0({zapRequest:e,preimage:t,bolt11:n,paidAt:r}){let o=JSON.parse(e),s=o.tags.filter(([c])=>c==="e"||c==="p"||c==="a"),i={kind:9735,created_at:Math.round(r.getTime()/1e3),content:"",tags:[...s,["P",o.pubkey],["bolt11",n],["description",e]]};return t&&i.tags.push(["preimage",t]),i}var O0={};F(O0,{getToken:()=>M0,hashPayload:()=>us,unpackEventFromToken:()=>Ba,validateEvent:()=>La,validateEventKind:()=>Ia,validateEventMethodTag:()=>Ua,validateEventPayloadTag:()=>_a,validateEventTimestamp:()=>Ta,validateEventUrlTag:()=>ka,validateToken:()=>P0});var Aa="Nostr ";function M0(e,t,n,r=!1,o){return R(this,null,function*(){let s={kind:Xo,tags:[["u",e],["method",t]],created_at:Math.round(new Date().getTime()/1e3),content:""};o&&s.tags.push(["payload",us(o)]);let i=yield n(s);return(r?Aa:"")+wt.encode(Tt.encode(JSON.stringify(i)))})}function P0(e,t,n){return R(this,null,function*(){let r=yield Ba(e).catch(s=>{throw s});return yield La(r,t,n).catch(s=>{throw s})})}function Ba(e){return R(this,null,function*(){if(!e)throw new Error("Missing token");e=e.replace(Aa,"");let t=Zt.decode(wt.decode(e));if(!t||t.length===0||!t.startsWith("{"))throw new Error("Invalid token");return JSON.parse(t)})}function Ta(e){return e.created_at?Math.round(new Date().getTime()/1e3)-e.created_at<60:!1}function Ia(e){return e.kind===Xo}function ka(e,t){let n=e.tags.find(r=>r[0]==="u");return n?n.length>0&&n[1]===t:!1}function Ua(e,t){let n=e.tags.find(r=>r[0]==="method");return n?n.length>0&&n[1].toLowerCase()===t.toLowerCase():!1}function us(e){let t=xt(Tt.encode(JSON.stringify(e)));return Z(t)}function _a(e,t){let n=e.tags.find(o=>o[0]==="payload");if(!n)return!1;let r=us(t);return n.length>0&&n[1]===r}function La(e,t,n,r){return R(this,null,function*(){if(!Vo(e))throw new Error("Invalid nostr event, signature invalid");if(!Ia(e))throw new Error("Invalid nostr event, kind invalid");if(!Ta(e))throw new Error("Invalid nostr event, created_at timestamp invalid");if(!ka(e,t))throw new Error("Invalid nostr event, url tag invalid");if(!Ua(e,n))throw new Error("Invalid nostr event, method tag invalid");if(r&&typeof r=="object"&&Object.keys(r).length>0&&!_a(e,r))throw new Error("Invalid nostr event, payload tag does not match request body hash");return!0})}var ke=Symbol("verified"),D0=e=>e instanceof Object;function H0(e){if(!D0(e)||typeof e.kind!="number"||typeof e.content!="string"||typeof e.created_at!="number"||typeof e.pubkey!="string"||!e.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(e.tags))return!1;for(let t=0;t<e.tags.length;t++){let n=e.tags[t];if(!Array.isArray(n))return!1;for(let r=0;r<n.length;r++)if(typeof n[r]=="object")return!1}return!0}var gb=new TextDecoder("utf-8"),N0=new TextEncoder;function Ve(e){e.indexOf("://")===-1&&(e="wss://"+e);let t=new URL(e);return t.pathname=t.pathname.replace(/\/+/g,"/"),t.pathname.endsWith("/")&&(t.pathname=t.pathname.slice(0,-1)),(t.port==="80"&&t.protocol==="ws:"||t.port==="443"&&t.protocol==="wss:")&&(t.port=""),t.searchParams.sort(),t.hash="",t.toString()}var $0=class{value;next=null;prev=null;constructor(e){this.value=e}},K0=class{first;last;constructor(){this.first=null,this.last=null}enqueue(e){let t=new $0(e);return this.last?this.last===this.first?(this.last=t,this.last.prev=this.first,this.first.next=t):(t.prev=this.last,this.last.next=t,this.last=t):(this.first=t,this.last=t),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){let t=this.first;return this.first=null,this.last=null,t.value}let e=this.first;return this.first=e.next,e.value}},j0=class{generateSecretKey(){return bt.utils.randomPrivateKey()}getPublicKey(e){return Z(bt.getPublicKey(e))}finalizeEvent(e,t){let n=e;return n.pubkey=Z(bt.getPublicKey(t)),n.id=ds(n),n.sig=Z(bt.sign(ds(n),t)),n[ke]=!0,n}verifyEvent(e){if(typeof e[ke]=="boolean")return e[ke];let t=ds(e);if(t!==e.id)return e[ke]=!1,!1;try{let n=bt.verify(e.sig,t,e.pubkey);return e[ke]=n,n}catch{return e[ke]=!1,!1}}};function q0(e){if(!H0(e))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content])}function ds(e){let t=xt(N0.encode(q0(e)));return Z(t)}var Sr=new j0,mb=Sr.generateSecretKey,bb=Sr.getPublicKey,xb=Sr.finalizeEvent,z0=Sr.verifyEvent,W0=22242;function V0(e,t){if(e.ids&&e.ids.indexOf(t.id)===-1||e.kinds&&e.kinds.indexOf(t.kind)===-1||e.authors&&e.authors.indexOf(t.pubkey)===-1)return!1;for(let n in e)if(n[0]==="#"){let r=n.slice(1),o=e[`#${r}`];if(o&&!t.tags.find(([s,i])=>s===n.slice(1)&&o.indexOf(i)!==-1))return!1}return!(e.since&&t.created_at<e.since||e.until&&t.created_at>e.until)}function Z0(e,t){for(let n=0;n<e.length;n++)if(V0(e[n],t))return!0;return!1}function G0(e,t){let n=t.length+3,r=e.indexOf(`"${t}":`)+n,o=e.slice(r).indexOf('"')+r+1;return e.slice(o,o+64)}function F0(e){let t=e.slice(0,22).indexOf('"EVENT"');if(t===-1)return null;let n=e.slice(t+7+1).indexOf('"');if(n===-1)return null;let r=t+7+1+n,o=e.slice(r+1,80).indexOf('"');if(o===-1)return null;let s=r+1+o;return e.slice(r+1,s)}function J0(e,t){return{kind:W0,created_at:Math.floor(Date.now()/1e3),tags:[["relay",e],["challenge",t]],content:""}}function X0(){return R(this,null,function*(){return new Promise(e=>{let t=new MessageChannel,n=()=>{t.port1.removeEventListener("message",n),e()};t.port1.addEventListener("message",n),t.port2.postMessage(0),t.port1.start()})})}var Y0=e=>(e[ke]=!0,!0),Ra=class{url;_connected=!1;onclose=null;onnotice=e=>console.debug(`NOTICE from ${this.url}: ${e}`);_onauth=null;baseEoseTimeout=4400;connectionTimeout=4400;publishTimeout=4400;openSubs=new Map;connectionTimeoutHandle;connectionPromise;openCountRequests=new Map;openEventPublishes=new Map;ws;incomingMessageQueue=new K0;queueRunning=!1;challenge;authPromise;serial=0;verifyEvent;_WebSocket;constructor(e,t){this.url=Ve(e),this.verifyEvent=t.verifyEvent,this._WebSocket=t.websocketImplementation||WebSocket}static connect(e,t){return R(this,null,function*(){let n=new Ra(e,t);return yield n.connect(),n})}closeAllSubscriptions(e){for(let[t,n]of this.openSubs)n.close(e);this.openSubs.clear();for(let[t,n]of this.openEventPublishes)n.reject(new Error(e));this.openEventPublishes.clear();for(let[t,n]of this.openCountRequests)n.reject(new Error(e));this.openCountRequests.clear()}get connected(){return this._connected}connect(){return R(this,null,function*(){return this.connectionPromise?this.connectionPromise:(this.challenge=void 0,this.authPromise=void 0,this.connectionPromise=new Promise((e,t)=>{this.connectionTimeoutHandle=setTimeout(()=>{t("connection timed out"),this.connectionPromise=void 0,this.onclose?.(),this.closeAllSubscriptions("relay connection timed out")},this.connectionTimeout);try{this.ws=new this._WebSocket(this.url)}catch(n){t(n);return}this.ws.onopen=()=>{clearTimeout(this.connectionTimeoutHandle),this._connected=!0,e()},this.ws.onerror=n=>{t(n.message||"websocket error"),this._connected&&(this._connected=!1,this.connectionPromise=void 0,this.onclose?.(),this.closeAllSubscriptions("relay connection errored"))},this.ws.onclose=()=>R(this,null,function*(){this._connected&&(this._connected=!1,this.connectionPromise=void 0,this.onclose?.(),this.closeAllSubscriptions("relay connection closed"))}),this.ws.onmessage=this._onmessage.bind(this)}),this.connectionPromise)})}runQueue(){return R(this,null,function*(){for(this.queueRunning=!0;this.handleNext()!==!1;)yield X0();this.queueRunning=!1})}handleNext(){let e=this.incomingMessageQueue.dequeue();if(!e)return!1;let t=F0(e);if(t){let n=this.openSubs.get(t);if(!n)return;let r=G0(e,"id"),o=n.alreadyHaveEvent?.(r);if(n.receivedEvent?.(this,r),o)return}try{let n=JSON.parse(e);switch(n[0]){case"EVENT":{let r=this.openSubs.get(n[1]),o=n[2];this.verifyEvent(o)&&Z0(r.filters,o)&&r.onevent(o);return}case"COUNT":{let r=n[1],o=n[2],s=this.openCountRequests.get(r);s&&(s.resolve(o.count),this.openCountRequests.delete(r));return}case"EOSE":{let r=this.openSubs.get(n[1]);if(!r)return;r.receivedEose();return}case"OK":{let r=n[1],o=n[2],s=n[3],i=this.openEventPublishes.get(r);i&&(clearTimeout(i.timeout),o?i.resolve(s):i.reject(new Error(s)),this.openEventPublishes.delete(r));return}case"CLOSED":{let r=n[1],o=this.openSubs.get(r);if(!o)return;o.closed=!0,o.close(n[2]);return}case"NOTICE":this.onnotice(n[1]);return;case"AUTH":{this.challenge=n[1],this.authPromise=void 0,this._onauth?.(n[1]);return}}}catch{return}}send(e){return R(this,null,function*(){if(!this.connectionPromise)throw new Error("sending on closed connection");this.connectionPromise.then(()=>{this.ws?.send(e)})})}auth(e){return R(this,null,function*(){if(!this.challenge)throw new Error("can't perform auth, no challenge was received");if(this.authPromise)return this.authPromise;let t=yield e(J0(this.url,this.challenge));return this.authPromise=new Promise((n,r)=>{let o=setTimeout(()=>{let s=this.openEventPublishes.get(t.id);s&&(s.reject(new Error("auth timed out")),this.openEventPublishes.delete(t.id))},this.publishTimeout);this.openEventPublishes.set(t.id,{resolve:n,reject:r,timeout:o})}),this.send('["AUTH",'+JSON.stringify(t)+"]"),this.authPromise})}publish(e){return R(this,null,function*(){let t=new Promise((n,r)=>{let o=setTimeout(()=>{let s=this.openEventPublishes.get(e.id);s&&(s.reject(new Error("publish timed out")),this.openEventPublishes.delete(e.id))},this.publishTimeout);this.openEventPublishes.set(e.id,{resolve:n,reject:r,timeout:o})});return this.send('["EVENT",'+JSON.stringify(e)+"]"),t})}count(e,t){return R(this,null,function*(){this.serial++;let n=t?.id||"count:"+this.serial,r=new Promise((o,s)=>{this.openCountRequests.set(n,{resolve:o,reject:s})});return this.send('["COUNT","'+n+'",'+JSON.stringify(e).substring(1)),r})}subscribe(e,t){let n=this.prepareSubscription(e,t);return n.fire(),n}prepareSubscription(e,t){this.serial++;let n=t.id||(t.label?t.label+":":"sub:")+this.serial,r=new Q0(this,n,e,t);return this.openSubs.set(n,r),r}close(){this.closeAllSubscriptions("relay connection closed by us"),this._connected=!1,this.ws?.close()}_onmessage(e){this.incomingMessageQueue.enqueue(e.data),this.queueRunning||this.runQueue()}},Q0=class{relay;id;closed=!1;eosed=!1;filters;alreadyHaveEvent;receivedEvent;onevent;oneose;onclose;eoseTimeout;eoseTimeoutHandle;constructor(e,t,n,r){this.relay=e,this.filters=n,this.id=t,this.alreadyHaveEvent=r.alreadyHaveEvent,this.receivedEvent=r.receivedEvent,this.eoseTimeout=r.eoseTimeout||e.baseEoseTimeout,this.oneose=r.oneose,this.onclose=r.onclose,this.onevent=r.onevent||(o=>{console.warn(`onevent() callback not defined for subscription '${this.id}' in relay ${this.relay.url}. event received:`,o)})}fire(){this.relay.send('["REQ","'+this.id+'",'+JSON.stringify(this.filters).substring(1)),this.eoseTimeoutHandle=setTimeout(this.receivedEose.bind(this),this.eoseTimeout)}receivedEose(){this.eosed||(clearTimeout(this.eoseTimeoutHandle),this.eosed=!0,this.oneose?.())}close(e="closed by caller"){!this.closed&&this.relay.connected&&(this.relay.send('["CLOSE",'+JSON.stringify(this.id)+"]"),this.closed=!0),this.relay.openSubs.delete(this.id),this.onclose?.(e)}},tp=class{relays=new Map;seenOn=new Map;trackRelays=!1;verifyEvent;trustedRelayURLs=new Set;_WebSocket;constructor(e){this.verifyEvent=e.verifyEvent,this._WebSocket=e.websocketImplementation}ensureRelay(e,t){return R(this,null,function*(){e=Ve(e);let n=this.relays.get(e);return n||(n=new Ra(e,{verifyEvent:this.trustedRelayURLs.has(e)?Y0:this.verifyEvent,websocketImplementation:this._WebSocket}),t?.connectionTimeout&&(n.connectionTimeout=t.connectionTimeout),this.relays.set(e,n)),yield n.connect(),n})}close(e){e.map(Ve).forEach(t=>{this.relays.get(t)?.close()})}subscribe(e,t,n){return this.subscribeMap(e.map(r=>({url:r,filter:t})),n)}subscribeMany(e,t,n){return this.subscribeMap(e.flatMap(r=>t.map(o=>({url:r,filter:o}))),n)}subscribeMap(e,t){this.trackRelays&&(t.receivedEvent=(f,d)=>{let y=this.seenOn.get(d);y||(y=new Set,this.seenOn.set(d,y)),y.add(f)});let n=new Set,r=[],o=[],s=f=>{o[f]||(o[f]=!0,o.filter(d=>d).length===e.length&&(t.oneose?.(),s=()=>{}))},i=[],c=(f,d)=>{i[f]||(s(f),i[f]=d,i.filter(y=>y).length===e.length&&(t.onclose?.(i),c=()=>{}))},a=f=>{if(t.alreadyHaveEvent?.(f))return!0;let d=n.has(f);return n.add(f),d},l=Promise.all(e.map((p,h)=>R(this,[p,h],function*({url:f,filter:d},y){f=Ve(f);let g;try{g=yield this.ensureRelay(f,{connectionTimeout:t.maxWait?Math.max(t.maxWait*.8,t.maxWait-1e3):void 0})}catch(b){c(y,b?.message||String(b));return}let m=g.subscribe([d],G(z({},t),{oneose:()=>s(y),onclose:b=>{b.startsWith("auth-required:")&&t.doauth?g.auth(t.doauth).then(()=>{g.subscribe([d],G(z({},t),{oneose:()=>s(y),onclose:x=>{c(y,x)},alreadyHaveEvent:a,eoseTimeout:t.maxWait}))}).catch(x=>{c(y,`auth was required and attempted, but failed with: ${x}`)}):c(y,b)},alreadyHaveEvent:a,eoseTimeout:t.maxWait}));r.push(m)})));return{close(){return R(this,null,function*(){yield l,r.forEach(f=>{f.close()})})}}}subscribeManyMap(e,t){this.trackRelays&&(t.receivedEvent=(d,y)=>{let p=this.seenOn.get(y);p||(p=new Set,this.seenOn.set(y,p)),p.add(d)});let n=new Set,r=[],o=Object.keys(e).length,s=[],i=d=>{s[d]||(s[d]=!0,s.filter(y=>y).length===o&&(t.oneose?.(),i=()=>{}))},c=[],a=(d,y)=>{c[d]||(i(d),c[d]=y,c.filter(p=>p).length===o&&(t.onclose?.(c),a=()=>{}))},l=d=>{if(t.alreadyHaveEvent?.(d))return!0;let y=n.has(d);return n.add(d),y},u=Promise.all(Object.entries(e).map((d,y,p)=>R(this,null,function*(){if(p.indexOf(d)!==y){a(y,"duplicate url");return}let[h,g]=d;h=Ve(h);let m;try{m=yield this.ensureRelay(h,{connectionTimeout:t.maxWait?Math.max(t.maxWait*.8,t.maxWait-1e3):void 0})}catch(x){a(y,x?.message||String(x));return}let b=m.subscribe(g,G(z({},t),{oneose:()=>i(y),onclose:x=>{x.startsWith("auth-required:")&&t.doauth?m.auth(t.doauth).then(()=>{m.subscribe(g,G(z({},t),{oneose:()=>i(y),onclose:w=>{a(y,w)},alreadyHaveEvent:l,eoseTimeout:t.maxWait}))}).catch(w=>{a(y,`auth was required and attempted, but failed with: ${w}`)}):a(y,x)},alreadyHaveEvent:l,eoseTimeout:t.maxWait}));r.push(b)})));return{close(){return R(this,null,function*(){yield u,r.forEach(d=>{d.close()})})}}}subscribeEose(e,t,n){let r=this.subscribe(e,t,G(z({},n),{oneose(){r.close()}}));return r}subscribeManyEose(e,t,n){let r=this.subscribeMany(e,t,G(z({},n),{oneose(){r.close()}}));return r}querySync(e,t,n){return R(this,null,function*(){return new Promise(r=>R(this,null,function*(){let o=[];this.subscribeEose(e,t,G(z({},n),{onevent(s){o.push(s)},onclose(s){r(o)}}))}))})}get(e,t,n){return R(this,null,function*(){t.limit=1;let r=yield this.querySync(e,t,n);return r.sort((o,s)=>s.created_at-o.created_at),r[0]||null})}publish(e,t){return e.map(Ve).map((n,r,o)=>R(this,null,function*(){if(o.indexOf(n)!==r)return Promise.reject("duplicate url");let s=yield this.ensureRelay(n);return s.publish(t).then(i=>{if(this.trackRelays){let c=this.seenOn.get(t.id);c||(c=new Set,this.seenOn.set(t.id,c)),c.add(s)}return i})}))}listConnectionStatus(){let e=new Map;return this.relays.forEach((t,n)=>e.set(n,t.connected)),e}destroy(){this.relays.forEach(e=>e.close()),this.relays=new Map}},Ca;try{Ca=WebSocket}catch{}var Oa=class extends tp{constructor(){super({verifyEvent:z0,websocketImplementation:Ca})}};var Ub=new Uint8Array(0);function Ma(e){if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function ep(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var o=0;o<e.length;o++){var s=e.charAt(o),i=s.charCodeAt(0);if(n[i]!==255)throw new TypeError(s+" is ambiguous");n[i]=o}var c=e.length,a=e.charAt(0),l=Math.log(c)/Math.log(256),u=Math.log(256)/Math.log(c);function f(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var h=0,g=0,m=0,b=p.length;m!==b&&p[m]===0;)m++,h++;for(var x=(b-m)*u+1>>>0,w=new Uint8Array(x);m!==b;){for(var A=p[m],v=0,S=x-1;(A!==0||v<g)&&S!==-1;S--,v++)A+=256*w[S]>>>0,w[S]=A%c>>>0,A=A/c>>>0;if(A!==0)throw new Error("Non-zero carry");g=v,m++}for(var B=x-g;B!==x&&w[B]===0;)B++;for(var C=a.repeat(h);B<x;++B)C+=e.charAt(w[B]);return C}function d(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var h=0;if(p[h]!==" "){for(var g=0,m=0;p[h]===a;)g++,h++;for(var b=(p.length-h)*l+1>>>0,x=new Uint8Array(b);p[h];){var w=n[p.charCodeAt(h)];if(w===255)return;for(var A=0,v=b-1;(w!==0||A<m)&&v!==-1;v--,A++)w+=c*x[v]>>>0,x[v]=w%256>>>0,w=w/256>>>0;if(w!==0)throw new Error("Non-zero carry");m=A,h++}if(p[h]!==" "){for(var S=b-m;S!==b&&x[S]===0;)S++;for(var B=new Uint8Array(g+(b-S)),C=g;S!==b;)B[C++]=x[S++];return B}}}function y(p){var h=d(p);if(h)return h;throw new Error(`Non-${t} character`)}return{encode:f,decodeUnsafe:d,decode:y}}var np=ep,rp=np,Pa=rp;var hs=class{name;prefix;baseEncode;constructor(t,n,r){this.name=t,this.prefix=n,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},ps=class{name;prefix;baseDecode;prefixCodePoint;constructor(t,n,r){this.name=t,this.prefix=n;let o=n.codePointAt(0);if(o===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=o,this.baseDecode=r}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Da(this,t)}},ys=class{decoders;constructor(t){this.decoders=t}or(t){return Da(this,t)}decode(t){let n=t[0],r=this.decoders[n];if(r!=null)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function Da(e,t){return new ys(z(z({},e.decoders??{[e.prefix]:e}),t.decoders??{[t.prefix]:t}))}var gs=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(t,n,r,o){this.name=t,this.prefix=n,this.baseEncode=r,this.baseDecode=o,this.encoder=new hs(t,n,r),this.decoder=new ps(t,n,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}};function op({name:e,prefix:t,encode:n,decode:r}){return new gs(e,t,n,r)}function ms({name:e,prefix:t,alphabet:n}){let{encode:r,decode:o}=Pa(n,e);return op({prefix:t,name:e,encode:r,decode:s=>Ma(o(s))})}var Ha=ms({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Db=ms({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});function Na(e){return new bs(e).build()}var bs=class{#t=["wss://relay.damus.io","wss://relay.primal.net","wss://nos.lol"];constructor(t){t&&(this.#t=t)}resolve(t,n,r,o){return R(this,null,function*(){if(n.method!=="nostr")return{didDocument:null,didResolutionMetadata:{error:"methodNotSupported"},didDocumentMetadata:{}};let s=new Oa,i=[],c=null,a=yield s.get(this.#t,{kinds:[mr.Metadata],authors:[n.id]}),l=yield s.get(this.#t,{kinds:[mr.RelayList],authors:[n.id]});if(s.close(this.#t),a?.content){c=JSON.parse(a.content);let d=c.website;d&&i.push({id:`${n.did}#linked-domain`,type:"LinkedDomains",serviceEndpoint:d})}if(l){let d=l.tags.filter(y=>y.length>=2&&y[0]==="r").map(y=>y[1]);for(let y=0;y<d.length;y++)i.push({id:`${n.did}#${y+1}`,type:"Relay",serviceEndpoint:d[y]})}return{didDocument:this.getDocument(n.did,i),didResolutionMetadata:{contentType:"application/did+ld+json",retrieved:new Date().toISOString()},didDocumentMetadata:{created:c?.created_at,updated:c?.created_at,deactivated:!1,profile:c}}})}build(){return{nostr:this.resolve.bind(this)}}publicKeyToMultibase(t){let n;if(typeof t=="string"){let o=t.startsWith("0x")?t.slice(2):t;n=new Uint8Array(o.match(/.{1,2}/g)?.map(s=>parseInt(s,16))||[])}else n=t;let r=new Uint8Array([231,1,...n]);return Ha.encode(r)}getDocument(t,n){let r=`${t}#0`,o=t.split(":")[2],s=this.publicKeyToMultibase(o),i=`{
            "@context": [
              "https://www.w3.org/ns/did/v1"
            ],
            "id": "${t}",
            "verificationMethod": [
              {
				        "@context": "https://www.w3.org/ns/cid/v1",
                "id": "${r}",
                "type": "Multikey",
                "controller": "${t}",
                "publicKeyMultibase": "${s}"
              }
            ],  
            "authentication": [
              "${r}"
            ],
            "assertionMethod": [
              "${r}"
            ],
            "capabilityDelegation": [
              "${r}"
            ],
            "capabilityInvocation": [
              "${r}"
            ],
			      "service": ${n.length>0?JSON.stringify(n,null,2):"[]"}
          }`;return JSON.parse(i)}};var $a={getResolver:Na};function sp(e,t){try{var n=e()}catch(r){return t(r)}return n&&n.then?n.then(void 0,t):n}function ip(){let e=new Map;return function(t,n){try{let s=function(c){if(o)return c;let a=e.get(t.didUrl);return a!==void 0?a:Promise.resolve(n()).then(function(l){var u;return((u=l.didResolutionMetadata)==null?void 0:u.error)!=="notFound"&&e.set(t.didUrl,l),l})};var r=s;let o,i=function(){if(t.params&&t.params["no-cache"]==="true")return Promise.resolve(n()).then(function(c){return o=1,c})}();return Promise.resolve(i&&i.then?i.then(s):s(i))}catch(o){return Promise.reject(o)}}}function cp(e,t){return t()}var ap="(?:%[0-9a-fA-F]{2})",Ka=`(?:[a-zA-Z0-9._-]|${ap})`,lp="([a-z0-9]+)",fp=`((?:${Ka}*:)*(${Ka}+))`,ja="[a-zA-Z0-9_.:%-]",up=`;${ja}+=${ja}*`,dp=`((${up})*)`,hp="(/[^#?]*)?",pp="([?][^#]*)?",yp="(#.*)?",gp=new RegExp(`^did:${lp}:${fp}${dp}${hp}${pp}${yp}$`);function mp(e){if(e===""||!e)return null;let t=e.match(gp);if(t){let n={did:`did:${t[1]}:${t[2]}`,method:t[1],id:t[2],didUrl:e};if(t[4]){let r=t[4].slice(1).split(";");n.params={};for(let o of r){let s=o.split("=");n.params[s[0]]=s[1]}}return t[6]&&(n.path=t[6]),t[7]&&(n.query=t[7].slice(1)),t[8]&&(n.fragment=t[8].slice(1)),n}return null}var Ar={didResolutionMetadata:{},didDocument:null,didDocumentMetadata:{}};function bp(e){return function(t,n,r){try{return Promise.resolve(sp(function(){return Promise.resolve(e(t,n,r)).then(function(o){return G(z({},Ar),{didResolutionMetadata:{contentType:"application/did+ld+json"},didDocument:o})})},function(o){return G(z({},Ar),{didResolutionMetadata:{error:"notFound",message:o.toString()}})}))}catch(o){return Promise.reject(o)}}}var dn=class{constructor(t={},n={}){this.registry=void 0,this.cache=void 0,this.registry=t,this.cache=n.cache===!0?ip():n.cache||cp,n.legacyResolvers&&Object.keys(n.legacyResolvers).map(r=>{this.registry[r]||(this.registry[r]=bp(n.legacyResolvers[r]))})}resolve(t,n={}){try{let r=this,o=mp(t);if(o===null)return Promise.resolve(G(z({},Ar),{didResolutionMetadata:{error:"invalidDid"}}));let s=r.registry[o.method];return s?Promise.resolve(r.cache(o,()=>s(o.did,o,r,n))):Promise.resolve(G(z({},Ar),{didResolutionMetadata:{error:"unsupportedDidMethod"}}))}catch(r){return Promise.reject(r)}}};var qa=class e{constructor(t){this.storageService=t;this.loadIdentities()}storageKey="identity-workbench-identities";identitiesSubject=new Es([]);identities$=this.identitiesSubject.asObservable();loadFromStorage(){this.loadIdentities()}loadIdentities(){let t=this.storageService.get(this.storageKey)||[];this.identitiesSubject.next(t)}saveIdentities(t){this.storageService.set(this.storageKey,t),this.identitiesSubject.next(t)}getAllIdentities(){return this.identities$}getIdentityById(t){return this.identitiesSubject.value.find(r=>r.id===t)}addIdentity(t){let n=new Date,r={id:t.id||`did:key:${Rr()}`,method:t.method||"key",publicKey:t.publicKey||"",privateKey:t.privateKey,name:t.name||`Identity ${this.identitiesSubject.value.length+1}`,description:t.description,created:n,updated:n,didDocument:t.didDocument},o=[...this.identitiesSubject.value,r];return this.saveIdentities(o),r}updateIdentity(t,n){let r=this.identitiesSubject.value,o=r.findIndex(c=>c.id===t);if(o===-1)throw new Error(`Identity with id ${t} not found`);let s=G(z(z({},r[o]),n),{updated:new Date}),i=[...r.slice(0,o),s,...r.slice(o+1)];return this.saveIdentities(i),s}deleteIdentity(t){let r=this.identitiesSubject.value.filter(o=>o.id!==t);this.saveIdentities(r)}importFromDIDString(t){return R(this,null,function*(){if(!t.startsWith("did:"))return null;try{let n=t.split(":");if(n.length<3)return null;let r=n[1];if(r==="key"){let o,s;return s=Xr.resolve(t),o=s.didDocument,this.addIdentity({id:t,method:"key",publicKey:n[2],name:`Imported Key DID (${n[2].startsWith("z6Mk")?"Ed25519":"Secp256k1"})`,description:`Imported on ${new Date().toLocaleString()}`,didDocument:o})}if(r==="stellar"){let s=me.resolve(t).didDocument;return this.addIdentity({id:t,method:r,publicKey:n[2],name:"Imported Stellar DID",description:`Imported on ${new Date().toLocaleString()}`,didDocument:s})}if(r==="is"){let i=(yield new dn(Ci.getResolver()).resolve(t)).didDocument;return this.addIdentity({id:t,method:r,publicKey:n[2],name:"Imported FreeID",description:`Imported on ${new Date().toLocaleString()}`,didDocument:i})}if(r==="nostr"){let s=yield new dn($a.getResolver()).resolve(t),i=s.didDocument,c="Imported Nostr DID",a=`Imported on ${new Date().toLocaleString()}`,l=s.didDocumentMetadata.profile;return console.log("didResolution",s),l&&(console.log("PROFILE FOUND!!"),c=l.display_name||l.name||c,a=l.about||a),this.addIdentity({id:t,method:r,publicKey:n[2],name:c,description:a,didDocument:i})}return this.addIdentity({id:t,method:r,publicKey:n.slice(2).join(":"),name:`Imported ${r.toUpperCase()} DID`,description:`Imported on ${new Date().toLocaleString()}`})}catch(n){return console.error("Error importing DID string:",n),null}})}importFromStellarKey(t,n=!1){try{if(!t||t.length<16)return null;let r,o,s,i;return n?(r=me.fromPrivateKey(t),i=r.id,o=i.split(":")[2],s=t):(r=me.fromPublicKey(t),i=r.id,o=t),this.addIdentity({id:i,method:"stellar",publicKey:o,privateKey:s,name:`Imported Stellar ${n?"Private":"Public"} Key`,description:`Imported on ${new Date().toLocaleString()}`,didDocument:r})}catch(r){return console.error("Error importing Stellar key:",r),null}}importFromJsonFile(t){if(!t||!t.id||!t.id.startsWith("did:"))return null;let n=t.id.split(":");if(n.length<3)return null;let r="";if(t.verificationMethod&&t.verificationMethod.length>0){for(let o of t.verificationMethod)if((o.type==="Ed25519VerificationKey2018"||o.type==="Ed25519VerificationKey2020")&&o.publicKeyBase58){r=o.publicKeyBase58;break}}return this.addIdentity({id:t.id,method:n[1],publicKey:r,name:`Imported ${n[1].toUpperCase()} DID Document`,description:`Imported on ${new Date().toLocaleString()}`,didDocument:t})}static \u0275fac=function(n){return new(n||e)(Ts(Ls))};static \u0275prov=Ss({token:e,factory:e.\u0275fac,providedIn:"root"})};export{Ip as a,kp as b,Up as c,_p as d,Lp as e,Rp as f,Cp as g,Op as h,Rr as i,he as j,Or as k,ai as l,Sn as m,Qp as n,$r as o,li as p,oy as q,sy as r,iy as s,cy as t,ay as u,Tn as v,ly as w,An as x,fi as y,fy as z,uy as A,gy as B,my as C,In as D,$l as E,Jl as F,Xl as G,Yl as H,Ql as I,Un as J,qa as K};
