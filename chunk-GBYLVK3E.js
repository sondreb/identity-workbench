import{a as me,b as pe,c as D}from"./chunk-PK5MDJEA.js";import{a as ge,b as _e}from"./chunk-NR6GGR4W.js";import{a as fe}from"./chunk-O4LCQTS6.js";import{a as T}from"./chunk-QYA5ZH4S.js";import{A as z,p as V,q as Ce,r as ue,u as L,v as A,x as W,y as R,z as J}from"./chunk-U65S6ADB.js";import{h as F,m as B,o as j,q as N}from"./chunk-LTNCO3OH.js";import{b as se}from"./chunk-WO2BSFFA.js";import{a as ie,b as ne,c as ae,d as re,e as oe,f as le,g as de,h as ce}from"./chunk-WRX7OGXN.js";import{d as ee}from"./chunk-F4ALP3Y4.js";import{Db as a,Eb as M,Fb as b,Hb as v,Ia as l,Ib as h,Jb as S,Lb as q,Ma as p,Nb as K,Ob as w,Pb as Q,Qb as Y,Ta as y,Xa as _,cb as u,ec as X,hb as C,ic as Z,jc as $,kb as G,lb as U,lc as E,ma as f,mb as t,na as g,nb as e,od as te,qb as x,sb as m,tb as s,td as I,wd as P,yd as O,zd as k}from"./chunk-PQBPDIQK.js";var H=class o{constructor(n,i,r){this.dialogRef=n;this.credentialService=i;this.snackBar=r}jsonContent="";importCredential(){if(!this.jsonContent){this.showError("Please enter valid JSON content");return}try{let n=JSON.parse(this.jsonContent);this.credentialService.importCredential(n)?(this.showSuccess("Credential imported successfully"),this.dialogRef.close(!0)):this.showError("Failed to import credential. Invalid format.")}catch{this.showError("Invalid JSON format")}}onFileSelected(n){let i=n.target.files?.[0];if(!i)return;let r=new FileReader;r.onload=d=>{this.jsonContent=d.target?.result},r.readAsText(i)}closeDialog(){this.dialogRef.close(!1)}showSuccess(n){this.snackBar.open(n,"Close",{duration:3e3,panelClass:"success-snackbar"})}showError(n){this.snackBar.open(n,"Close",{duration:5e3,panelClass:"error-snackbar"})}static \u0275fac=function(i){return new(i||o)(p(me),p(T),p(J))};static \u0275cmp=y({type:o,selectors:[["app-import-credential-dialog"]],decls:24,vars:2,consts:[[1,"import-dialog-container"],[1,"dialog-title","neon-text"],[1,"dialog-description"],[1,"file-input-wrapper"],["mat-stroked-button","","color","primary",1,"upload-btn"],["type","file","accept",".json",3,"change"],["appearance","outline",1,"full-width"],["matInput","","rows","10","placeholder","Paste verifiable credential JSON here...",3,"ngModelChange","ngModel"],[1,"action-buttons"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click","disabled"]],template:function(i,r){i&1&&(t(0,"div",0)(1,"h2",1),a(2,"Import Credential"),e(),t(3,"p",2),a(4," Import a Verifiable Credential from JSON data "),e(),t(5,"div",3)(6,"button",4)(7,"mat-icon"),a(8,"upload_file"),e(),a(9," Select JSON File "),e(),t(10,"input",5),m("change",function(c){return r.onFileSelected(c)}),e()(),t(11,"mat-form-field",6)(12,"mat-label"),a(13,"Credential JSON"),e(),t(14,"textarea",7),S("ngModelChange",function(c){return h(r.jsonContent,c)||(r.jsonContent=c),c}),e(),t(15,"mat-hint"),a(16," The credential must be in valid Verifiable Credential JSON format "),e()(),t(17,"div",8)(18,"button",9),m("click",function(){return r.closeDialog()}),a(19,"Cancel"),e(),t(20,"button",10),m("click",function(){return r.importCredential()}),t(21,"mat-icon"),a(22,"file_download"),e(),a(23," Import Credential "),e()()()),i&2&&(l(14),v("ngModel",r.jsonContent),l(6),u("disabled",!r.jsonContent))},dependencies:[E,N,F,B,j,D,P,I,A,L,V,Ce,R,W,k,O,z],styles:[".import-dialog-container[_ngcontent-%COMP%]{padding:16px;max-width:600px}.dialog-title[_ngcontent-%COMP%]{text-align:center;margin-bottom:10px}.dialog-description[_ngcontent-%COMP%]{text-align:center;color:var(--text-secondary);margin-bottom:20px}.full-width[_ngcontent-%COMP%]{width:100%}.action-buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px;margin-top:20px}.file-input-wrapper[_ngcontent-%COMP%]{position:relative;margin-bottom:20px;overflow:hidden}.file-input-wrapper[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;cursor:pointer}.upload-btn[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:center;gap:8px;padding:10px;border:1px dashed var(--primary-color)}textarea[_ngcontent-%COMP%]:focus, input[_ngcontent-%COMP%]:focus{box-shadow:0 0 8px #00c3ff99}"]})};var ke=(o,n,i)=>({valid:o,expired:n,revoked:i}),Te=o=>["/credential",o],Me=(o,n)=>n.id;function De(o,n){if(o&1&&(t(0,"mat-option",24),a(1),e()),o&2){let i=n.$implicit;u("value",i.id),l(),b(" ",i.name," ")}}function Fe(o,n){if(o&1){let i=x();t(0,"mat-form-field",9)(1,"mat-label"),a(2,"Issuer"),e(),t(3,"mat-select",13),S("ngModelChange",function(d){f(i);let c=s();return h(c.filterIssuer,d)||(c.filterIssuer=d),g(d)}),t(4,"mat-option",14),a(5,"All Issuers"),e(),G(6,De,2,2,"mat-option",24,Me),e()()}if(o&2){let i=s();l(3),v("ngModel",i.filterIssuer),l(3),U(i.identities)}}function Be(o,n){if(o&1){let i=x();t(0,"button",25),m("click",function(){f(i);let d=s();return g(d.clearFilters())}),t(1,"mat-icon"),a(2,"clear"),e(),a(3," Clear Filters "),e()}}function je(o,n){if(o&1){let i=x();t(0,"div",22)(1,"mat-icon"),a(2,"verified_user"),e(),t(3,"h2"),a(4,"No Credentials Found"),e(),t(5,"p"),a(6,"You haven't imported or issued any credentials yet."),e(),t(7,"div",26)(8,"button",5),a(9," Issue Credential "),e(),t(10,"button",6),m("click",function(){f(i);let d=s();return g(d.openImportDialog())}),a(11," Import Credential "),e(),t(12,"button",27),a(13," Verify Credential "),e()()()}}function Ne(o,n){if(o&1){let i=x();t(0,"div",22)(1,"mat-icon"),a(2,"search_off"),e(),t(3,"h2"),a(4,"No Results Found"),e(),t(5,"p"),a(6,"No credentials match your search criteria."),e(),t(7,"button",25),m("click",function(){f(i);let d=s();return g(d.clearFilters())}),a(8," Clear Filters "),e()()}}function Ve(o,n){if(o&1&&(t(0,"p",31),a(1),e()),o&2){let i=s().$implicit;l(),b(" ",i.description," ")}}function Le(o,n){if(o&1&&(t(0,"div",33)(1,"span",34),a(2,"Expires:"),e(),t(3,"span",35),a(4),w(5,"date"),e()()),o&2){let i=s().$implicit;l(4),M(Y(5,1,i.expirationDate,"shortDate"))}}function Ae(o,n){o&1&&(t(0,"mat-icon"),a(1,"check_circle"),e())}function We(o,n){o&1&&(t(0,"mat-icon"),a(1,"schedule"),e())}function Re(o,n){o&1&&(t(0,"mat-icon"),a(1,"cancel"),e())}function Je(o,n){if(o&1){let i=x();t(0,"mat-card",28)(1,"mat-card-header")(2,"div",29)(3,"mat-icon"),a(4,"verified_user"),e()(),t(5,"mat-card-title"),a(6),e(),t(7,"mat-card-subtitle")(8,"span",30),a(9),e()()(),t(10,"mat-card-content"),_(11,Ve,2,1,"p",31),t(12,"div",32)(13,"div",33)(14,"span",34),a(15,"Issuer:"),e(),t(16,"span",35),a(17),e()(),t(18,"div",33)(19,"span",34),a(20,"Issued:"),e(),t(21,"span",35),a(22),w(23,"date"),e()(),_(24,Le,6,4,"div",33),e(),t(25,"div",36),_(26,Ae,2,0,"mat-icon")(27,We,2,0,"mat-icon")(28,Re,2,0,"mat-icon"),a(29),w(30,"titlecase"),e()(),t(31,"mat-card-actions")(32,"button",37),a(33," VIEW "),e(),t(34,"button",38),m("click",function(){let d=f(i).$implicit,c=s(2);return g(c.deleteCredential(d.id))}),a(35," DELETE "),e()()()}if(o&2){let i=n.$implicit,r=s(2);l(2),u("ngClass",K(16,ke,r.getCredentialStatus(i)==="valid",r.getCredentialStatus(i)==="expired",r.getCredentialStatus(i)==="revoked")),l(4),M(i.name),l(3),M(i.type),l(2),C(i.description?11:-1),l(6),M(r.getIdentityName(i.issuer)),l(5),M(Y(23,11,i.issuanceDate,"shortDate")),l(2),C(i.expirationDate?24:-1),l(),u("ngClass",r.getCredentialStatus(i)),l(),C(r.getCredentialStatus(i)==="valid"?26:r.getCredentialStatus(i)==="expired"?27:28),l(3),b(" ",Q(30,14,r.getCredentialStatus(i))," "),l(3),u("routerLink",q(20,Te,i.id))}}function ze(o,n){if(o&1&&(t(0,"div",23),G(1,Je,36,22,"mat-card",28,Me),e()),o&2){let i=s();l(),U(i.filteredCredentials)}}var xe=class o{constructor(n,i,r,d){this.credentialService=n;this.identityService=i;this.dialog=r;this.snackBar=d;this.loadCredentials(),this.loadIdentities()}credentials=[];identities=[];searchTerm="";filterType="all";filterIssuer="all";loadCredentials(){this.credentialService.getAllCredentials().subscribe(n=>{this.credentials=n})}loadIdentities(){this.identityService.getAllIdentities().subscribe(n=>{this.identities=n})}get filteredCredentials(){return this.credentials.filter(n=>{let i=!this.searchTerm||n.name?.toLowerCase().includes(this.searchTerm.toLowerCase())||n.description?.toLowerCase().includes(this.searchTerm.toLowerCase())||n.id.toLowerCase().includes(this.searchTerm.toLowerCase())||n.type.toLowerCase().includes(this.searchTerm.toLowerCase()),r=this.filterType==="all"||n.type===this.filterType,d=this.filterIssuer==="all"||n.issuer===this.filterIssuer;return i&&r&&d})}getIdentityName(n){return this.identities.find(r=>r.id===n)?.name||"Unknown"}getCredentialStatus(n){return n.revoked?"revoked":n.expirationDate&&new Date(n.expirationDate)<new Date?"expired":"valid"}truncateId(n){return n.length<=30?n:n.substring(0,15)+"..."+n.substring(n.length-10)}openImportDialog(){this.dialog.open(H,{width:"600px"}).afterClosed().subscribe(i=>{i&&this.loadCredentials()})}deleteCredential(n){confirm("Are you sure you want to delete this credential?")&&(this.credentialService.deleteCredential(n),this.snackBar.open("Credential deleted","Close",{duration:3e3,panelClass:"success-snackbar"}))}clearFilters(){this.searchTerm="",this.filterType="all",this.filterIssuer="all"}static \u0275fac=function(i){return new(i||o)(p(T),p(se),p(pe),p(J))};static \u0275cmp=y({type:o,selectors:[["app-credentials"]],decls:48,vars:7,consts:[[1,"page-container"],[1,"page-header"],[1,"title-section"],[1,"neon-text"],[1,"actions-section"],["mat-raised-button","","color","primary","routerLink","/issue"],["mat-raised-button","","color","accent",3,"click"],[1,"filters-container"],[1,"search-container"],["appearance","outline"],["matInput","","placeholder","Search credentials",3,"ngModelChange","ngModel"],["matSuffix",""],[1,"filter-container"],[3,"ngModelChange","ngModel"],["value","all"],["value","VerifiableCredential"],["value","IdentityCredential"],["value","ProofOfAgeCredential"],["value","AgreementCredential"],["value","DocumentCredential"],["value","ContractCredential"],["mat-button","","color","primary"],[1,"empty-state"],[1,"credential-grid"],[3,"value"],["mat-button","","color","primary",3,"click"],[1,"empty-state-actions"],["mat-raised-button","","routerLink","/verify"],[1,"credential-card","neon-card"],["mat-card-avatar","",1,"credential-avatar",3,"ngClass"],[1,"credential-type"],[1,"credential-description"],[1,"credential-meta"],[1,"meta-item"],[1,"meta-label"],[1,"meta-value"],[1,"credential-status",3,"ngClass"],["mat-button","","color","primary",3,"routerLink"],["mat-button","","color","warn",3,"click"]],template:function(i,r){i&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),a(4,"Credentials"),e(),t(5,"p"),a(6,"Manage your verifiable credentials"),e()(),t(7,"div",4)(8,"button",5)(9,"mat-icon"),a(10,"send"),e(),a(11," Issue Credential "),e(),t(12,"button",6),m("click",function(){return r.openImportDialog()}),t(13,"mat-icon"),a(14,"file_upload"),e(),a(15," Import "),e()()(),t(16,"div",7)(17,"div",8)(18,"mat-form-field",9)(19,"mat-label"),a(20,"Search"),e(),t(21,"input",10),S("ngModelChange",function(c){return h(r.searchTerm,c)||(r.searchTerm=c),c}),e(),t(22,"mat-icon",11),a(23,"search"),e()()(),t(24,"div",12)(25,"mat-form-field",9)(26,"mat-label"),a(27,"Type"),e(),t(28,"mat-select",13),S("ngModelChange",function(c){return h(r.filterType,c)||(r.filterType=c),c}),t(29,"mat-option",14),a(30,"All Types"),e(),t(31,"mat-option",15),a(32,"Generic"),e(),t(33,"mat-option",16),a(34,"Identity"),e(),t(35,"mat-option",17),a(36,"Proof of Age"),e(),t(37,"mat-option",18),a(38,"Agreement"),e(),t(39,"mat-option",19),a(40,"Document"),e(),t(41,"mat-option",20),a(42,"Contract"),e()()(),_(43,Fe,8,1,"mat-form-field",9)(44,Be,4,0,"button",21),e()(),_(45,je,14,0,"div",22)(46,Ne,9,0,"div",22)(47,ze,3,0,"div",23),e()),i&2&&(l(21),v("ngModel",r.searchTerm),l(7),v("ngModel",r.filterType),l(15),C(r.identities.length>0?43:-1),l(),C(r.searchTerm||r.filterType!=="all"||r.filterIssuer!=="all"?44:-1),l(),C(r.credentials.length===0?45:-1),l(),C(r.credentials.length>0&&r.filteredCredentials.length===0?46:-1),l(),C(r.filteredCredentials.length>0?47:-1))},dependencies:[E,X,Z,$,N,F,B,j,ee,ce,ie,oe,de,ae,le,re,ne,P,I,k,O,fe,R,W,L,V,ue,A,_e,ge,te,D,z],styles:[".page-header[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;margin-bottom:30px}.title-section[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:5px}.title-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-secondary);margin:0}.actions-section[_ngcontent-%COMP%]{display:flex;gap:10px}.filters-container[_ngcontent-%COMP%]{margin-bottom:30px;display:flex;flex-direction:column;gap:15px}.search-container[_ngcontent-%COMP%]{width:100%}.filter-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:15px;align-items:center}.filter-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{flex:1;min-width:200px}.credential-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px}.credential-card[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.credential-avatar[_ngcontent-%COMP%]{background-color:#00c3ff33;display:flex;align-items:center;justify-content:center}.credential-avatar.valid[_ngcontent-%COMP%]{background-color:#00e67633}.credential-avatar.expired[_ngcontent-%COMP%]{background-color:#ffb30033}.credential-avatar.revoked[_ngcontent-%COMP%]{background-color:#ff408133}.credential-avatar[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--primary-color)}.credential-avatar.valid[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--success-color)}.credential-avatar.expired[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--warning-color)}.credential-avatar.revoked[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--error-color)}.credential-type[_ngcontent-%COMP%]{font-size:.85rem;color:var(--text-secondary)}.credential-description[_ngcontent-%COMP%]{color:var(--text-secondary);margin-bottom:15px;min-height:20px}.credential-meta[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;margin-bottom:15px}.meta-item[_ngcontent-%COMP%]{display:flex;font-size:.9rem}.meta-label[_ngcontent-%COMP%]{width:60px;font-weight:500;color:var(--text-secondary)}.meta-value[_ngcontent-%COMP%]{flex:1}.credential-status[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:.9rem;padding:4px 10px;border-radius:16px;width:fit-content;margin-top:10px}.credential-status[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;height:16px;width:16px;margin-right:5px}.credential-status.valid[_ngcontent-%COMP%]{background-color:#00e6761a;color:var(--success-color)}.credential-status.expired[_ngcontent-%COMP%]{background-color:#ffb3001a;color:var(--warning-color)}.credential-status.revoked[_ngcontent-%COMP%]{background-color:#ff40811a;color:var(--error-color)}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 0;text-align:center}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:5rem;height:5rem;width:5rem;margin-bottom:20px;color:var(--text-secondary)}.empty-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:10px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:20px;color:var(--text-secondary)}.empty-state-actions[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;justify-content:center}@media (max-width: 768px){.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.actions-section[_ngcontent-%COMP%]{margin-top:15px;width:100%}.credential-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};export{xe as CredentialsComponent};
