import{a as ue,b as Ce,c as F}from"./chunk-ZA65BCCN.js";import{a as xe,b as Me}from"./chunk-ZQ646CWT.js";import{a as _e}from"./chunk-HNBHWSKZ.js";import{a as D}from"./chunk-V4NAS4YT.js";import{b as L,c as ge,d as fe,g as A,h as W,j as R,k as J,l as z,m as H}from"./chunk-IMAXPIZZ.js";import{B as j,D as N,u as V,z as B}from"./chunk-YHCOEZBY.js";import{C as pe}from"./chunk-P6EO3XPU.js";import{a as re,b as ae,c as oe,d as le,e as ce,f as de,g as se,h as me}from"./chunk-RG545CFP.js";import{d as ie}from"./chunk-XEAJSTHP.js";import{Ad as ne,Fb as K,Fd as P,Gb as r,Hb as v,Ib as w,Id as O,Kb as h,Kd as k,La as l,Lb as S,Ld as T,Mb as y,Pa as C,Pb as Q,Rb as X,Sb as I,Tb as Z,Ub as q,Wa as b,_a as M,fb as x,kb as g,mc as $,nb as U,ob as Y,pa as s,pb as t,qa as m,qb as e,qc as ee,rc as te,tb as f,tc as E,vb as p,wb as u}from"./chunk-GFOZWZLX.js";var G=class o{constructor(n,i,a){this.dialogRef=n;this.credentialService=i;this.snackBar=a}jsonContent="";importCredential(){if(!this.jsonContent){this.showError("Please enter valid JSON content");return}try{let n=JSON.parse(this.jsonContent);this.credentialService.importCredential(n)?(this.showSuccess("Credential imported successfully"),this.dialogRef.close(!0)):this.showError("Failed to import credential. Invalid format.")}catch{this.showError("Invalid JSON format")}}onFileSelected(n){debugger;let i=n.target.files?.[0];if(!i)return;let a=new FileReader;a.onload=c=>{this.jsonContent=c.target?.result},a.readAsText(i)}closeDialog(){this.dialogRef.close(!1)}showSuccess(n){this.snackBar.open(n,"Close",{duration:3e3,panelClass:"success-snackbar"})}showError(n){this.snackBar.open(n,"Close",{duration:5e3,panelClass:"error-snackbar"})}static \u0275fac=function(i){return new(i||o)(C(ue),C(D),C(z))};static \u0275cmp=b({type:o,selectors:[["app-import-credential-dialog"]],decls:25,vars:2,consts:[["fileInput",""],[1,"import-dialog-container"],[1,"dialog-title","neon-text"],[1,"dialog-description"],[1,"file-input-wrapper"],["mat-stroked-button","","color","primary",1,"upload-btn",3,"click"],["type","file","accept",".json",2,"display","none",3,"change"],["appearance","outline",1,"full-width"],["matInput","","rows","10","placeholder","Paste verifiable credential JSON here...",3,"ngModelChange","ngModel"],[1,"action-buttons"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click","disabled"]],template:function(i,a){if(i&1){let c=f();t(0,"div",1)(1,"h2",2),r(2,"Import Credential"),e(),t(3,"p",3),r(4," Import a Verifiable Credential from JSON data "),e(),t(5,"div",4)(6,"button",5),p("click",function(){s(c);let _=K(11);return m(_.click())}),t(7,"mat-icon"),r(8,"upload_file"),e(),r(9," Select JSON File "),e(),t(10,"input",6,0),p("change",function(_){return s(c),m(a.onFileSelected(_))}),e()(),t(12,"mat-form-field",7)(13,"mat-label"),r(14,"Credential JSON"),e(),t(15,"textarea",8),y("ngModelChange",function(_){return s(c),S(a.jsonContent,_)||(a.jsonContent=_),m(_)}),e(),t(16,"mat-hint"),r(17," The credential must be in valid Verifiable Credential JSON format "),e()(),t(18,"div",9)(19,"button",10),p("click",function(){return s(c),m(a.closeDialog())}),r(20,"Cancel"),e(),t(21,"button",11),p("click",function(){return s(c),m(a.importCredential())}),t(22,"mat-icon"),r(23,"file_download"),e(),r(24," Import Credential "),e()()()}i&2&&(l(15),h("ngModel",a.jsonContent),l(6),x("disabled",!a.jsonContent))},dependencies:[E,N,V,B,j,F,O,P,W,A,L,ge,J,R,T,k,H],styles:[".import-dialog-container[_ngcontent-%COMP%]{padding:16px;max-width:600px}.dialog-title[_ngcontent-%COMP%]{text-align:center;margin-bottom:10px;color:var(--primary-color)}.dialog-description[_ngcontent-%COMP%]{text-align:center;color:var(--text-secondary);margin-bottom:20px}.full-width[_ngcontent-%COMP%]{width:100%}.action-buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px;margin-top:20px}.file-input-wrapper[_ngcontent-%COMP%]{position:relative;margin-bottom:20px;overflow:hidden}.file-input-wrapper[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;cursor:pointer}.upload-btn[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:center;gap:8px;padding:10px;border:1px dashed var(--primary-color)}textarea[_ngcontent-%COMP%]:focus, input[_ngcontent-%COMP%]:focus{outline:1px solid var(--primary-color)}"]})};var De=(o,n,i)=>({valid:o,expired:n,revoked:i}),Fe=o=>["/credential",o],he=(o,n)=>n.id;function Ve(o,n){if(o&1&&(t(0,"mat-option",24),r(1),e()),o&2){let i=n.$implicit;x("value",i.id),l(),w(" ",i.name," ")}}function Be(o,n){if(o&1){let i=f();t(0,"mat-form-field",9)(1,"mat-label"),r(2,"Issuer"),e(),t(3,"mat-select",13),y("ngModelChange",function(c){s(i);let d=u();return S(d.filterIssuer,c)||(d.filterIssuer=c),m(c)}),t(4,"mat-option",14),r(5,"All Issuers"),e(),U(6,Ve,2,2,"mat-option",24,he),e()()}if(o&2){let i=u();l(3),h("ngModel",i.filterIssuer),l(3),Y(i.identities)}}function je(o,n){if(o&1){let i=f();t(0,"button",25),p("click",function(){s(i);let c=u();return m(c.clearFilters())}),t(1,"mat-icon"),r(2,"clear"),e(),r(3," Clear Filters "),e()}}function Ne(o,n){if(o&1){let i=f();t(0,"div",22)(1,"mat-icon"),r(2,"verified_user"),e(),t(3,"h2"),r(4,"No Credentials Found"),e(),t(5,"p"),r(6,"You haven't imported or issued any credentials yet."),e(),t(7,"div",26)(8,"button",5),r(9," Issue Credential "),e(),t(10,"button",6),p("click",function(){s(i);let c=u();return m(c.openImportDialog())}),r(11," Import Credential "),e(),t(12,"button",27),r(13," Verify Credential "),e()()()}}function Le(o,n){if(o&1){let i=f();t(0,"div",22)(1,"mat-icon"),r(2,"search_off"),e(),t(3,"h2"),r(4,"No Results Found"),e(),t(5,"p"),r(6,"No credentials match your search criteria."),e(),t(7,"button",25),p("click",function(){s(i);let c=u();return m(c.clearFilters())}),r(8," Clear Filters "),e()()}}function Ae(o,n){if(o&1&&(t(0,"p",31),r(1),e()),o&2){let i=u().$implicit;l(),w(" ",i.description," ")}}function We(o,n){if(o&1&&(t(0,"div",33)(1,"span",34),r(2,"Expires:"),e(),t(3,"span",35),r(4),I(5,"date"),e()()),o&2){let i=u().$implicit;l(4),v(q(5,1,i.expirationDate,"shortDate"))}}function Re(o,n){o&1&&(t(0,"mat-icon"),r(1,"check_circle"),e())}function Je(o,n){o&1&&(t(0,"mat-icon"),r(1,"schedule"),e())}function ze(o,n){o&1&&(t(0,"mat-icon"),r(1,"cancel"),e())}function He(o,n){if(o&1){let i=f();t(0,"mat-card",28)(1,"mat-card-header")(2,"div",29)(3,"mat-icon"),r(4,"verified_user"),e()(),t(5,"mat-card-title"),r(6),e(),t(7,"mat-card-subtitle")(8,"span",30),r(9),e()()(),t(10,"mat-card-content"),M(11,Ae,2,1,"p",31),t(12,"div",32)(13,"div",33)(14,"span",34),r(15,"Issuer:"),e(),t(16,"span",35),r(17),e()(),t(18,"div",33)(19,"span",34),r(20,"Issued:"),e(),t(21,"span",35),r(22),I(23,"date"),e()(),M(24,We,6,4,"div",33),e(),t(25,"div",36),M(26,Re,2,0,"mat-icon")(27,Je,2,0,"mat-icon")(28,ze,2,0,"mat-icon"),r(29),I(30,"titlecase"),e()(),t(31,"mat-card-actions")(32,"button",37),r(33," VIEW "),e(),t(34,"button",38),p("click",function(){let c=s(i).$implicit,d=u(2);return m(d.deleteCredential(c.id))}),r(35," DELETE "),e()()()}if(o&2){let i=n.$implicit,a=u(2);l(2),x("ngClass",X(16,De,a.getCredentialStatus(i)==="valid",a.getCredentialStatus(i)==="expired",a.getCredentialStatus(i)==="revoked")),l(4),v(i.name),l(3),v(i.type),l(2),g(i.description?11:-1),l(6),v(a.getIdentityName(i.issuer)),l(5),v(q(23,11,i.issuanceDate,"shortDate")),l(2),g(i.expirationDate?24:-1),l(),x("ngClass",a.getCredentialStatus(i)),l(),g(a.getCredentialStatus(i)==="valid"?26:a.getCredentialStatus(i)==="expired"?27:28),l(3),w(" ",Z(30,14,a.getCredentialStatus(i))," "),l(3),x("routerLink",Q(20,Fe,i.id))}}function Ge(o,n){if(o&1&&(t(0,"div",23),U(1,He,36,22,"mat-card",28,he),e()),o&2){let i=u();l(),Y(i.filteredCredentials)}}var ve=class o{constructor(n,i,a,c){this.credentialService=n;this.identityService=i;this.dialog=a;this.snackBar=c;this.loadCredentials(),this.loadIdentities()}credentials=[];identities=[];searchTerm="";filterType="all";filterIssuer="all";loadCredentials(){this.credentialService.getAllCredentials().subscribe(n=>{this.credentials=n})}loadIdentities(){this.identityService.getAllIdentities().subscribe(n=>{this.identities=n})}get filteredCredentials(){return this.credentials.filter(n=>{let i=!this.searchTerm||n.name?.toLowerCase().includes(this.searchTerm.toLowerCase())||n.description?.toLowerCase().includes(this.searchTerm.toLowerCase())||n.id.toLowerCase().includes(this.searchTerm.toLowerCase())||n.type.toLowerCase().includes(this.searchTerm.toLowerCase()),a=this.filterType==="all"||n.type===this.filterType,c=this.filterIssuer==="all"||n.issuer===this.filterIssuer;return i&&a&&c})}getIdentityName(n){return this.identities.find(a=>a.id===n)?.name||"Unknown"}getCredentialStatus(n){return n.revoked?"revoked":n.expirationDate&&new Date(n.expirationDate)<new Date?"expired":"valid"}truncateId(n){return n.length<=30?n:n.substring(0,15)+"..."+n.substring(n.length-10)}openImportDialog(){this.dialog.open(G,{width:"600px"}).afterClosed().subscribe(i=>{i&&this.loadCredentials()})}deleteCredential(n){confirm("Are you sure you want to delete this credential?")&&(this.credentialService.deleteCredential(n),this.snackBar.open("Credential deleted","Close",{duration:3e3,panelClass:"success-snackbar"}))}clearFilters(){this.searchTerm="",this.filterType="all",this.filterIssuer="all"}static \u0275fac=function(i){return new(i||o)(C(D),C(pe),C(Ce),C(z))};static \u0275cmp=b({type:o,selectors:[["app-credentials"]],decls:48,vars:7,consts:[[1,"page-container"],[1,"page-header"],[1,"title-section"],[1,"neon-text"],[1,"actions-section"],["mat-raised-button","","color","primary","routerLink","/issue"],["mat-raised-button","","color","accent",3,"click"],[1,"filters-container"],[1,"search-container"],["appearance","outline"],["matInput","","placeholder","Search credentials",3,"ngModelChange","ngModel"],["matSuffix",""],[1,"filter-container"],[3,"ngModelChange","ngModel"],["value","all"],["value","VerifiableCredential"],["value","IdentityCredential"],["value","ProofOfAgeCredential"],["value","AgreementCredential"],["value","DocumentCredential"],["value","ContractCredential"],["mat-button","","color","primary"],[1,"empty-state"],[1,"credential-grid"],[3,"value"],["mat-button","","color","primary",3,"click"],[1,"empty-state-actions"],["mat-raised-button","","routerLink","/verify"],[1,"credential-card","neon-card"],["mat-card-avatar","",1,"credential-avatar",3,"ngClass"],[1,"credential-type"],[1,"credential-description"],[1,"credential-meta"],[1,"meta-item"],[1,"meta-label"],[1,"meta-value"],[1,"credential-status",3,"ngClass"],["mat-button","","color","primary",3,"routerLink"],["mat-button","","color","warn",3,"click"]],template:function(i,a){i&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),r(4,"Credentials"),e(),t(5,"p"),r(6,"Manage your verifiable credentials"),e()(),t(7,"div",4)(8,"button",5)(9,"mat-icon"),r(10,"send"),e(),r(11," Issue Credential "),e(),t(12,"button",6),p("click",function(){return a.openImportDialog()}),t(13,"mat-icon"),r(14,"file_upload"),e(),r(15," Import "),e()()(),t(16,"div",7)(17,"div",8)(18,"mat-form-field",9)(19,"mat-label"),r(20,"Search"),e(),t(21,"input",10),y("ngModelChange",function(d){return S(a.searchTerm,d)||(a.searchTerm=d),d}),e(),t(22,"mat-icon",11),r(23,"search"),e()()(),t(24,"div",12)(25,"mat-form-field",9)(26,"mat-label"),r(27,"Type"),e(),t(28,"mat-select",13),y("ngModelChange",function(d){return S(a.filterType,d)||(a.filterType=d),d}),t(29,"mat-option",14),r(30,"All Types"),e(),t(31,"mat-option",15),r(32,"Generic"),e(),t(33,"mat-option",16),r(34,"Identity"),e(),t(35,"mat-option",17),r(36,"Proof of Age"),e(),t(37,"mat-option",18),r(38,"Agreement"),e(),t(39,"mat-option",19),r(40,"Document"),e(),t(41,"mat-option",20),r(42,"Contract"),e()()(),M(43,Be,8,1,"mat-form-field",9)(44,je,4,0,"button",21),e()(),M(45,Ne,14,0,"div",22)(46,Le,9,0,"div",22)(47,Ge,3,0,"div",23),e()),i&2&&(l(21),h("ngModel",a.searchTerm),l(7),h("ngModel",a.filterType),l(15),g(a.identities.length>0?43:-1),l(),g(a.searchTerm||a.filterType!=="all"||a.filterIssuer!=="all"?44:-1),l(),g(a.credentials.length===0?45:-1),l(),g(a.credentials.length>0&&a.filteredCredentials.length===0?46:-1),l(),g(a.filteredCredentials.length>0?47:-1))},dependencies:[E,$,ee,te,N,V,B,j,ie,me,re,ce,se,oe,de,le,ae,O,P,T,k,_e,J,R,A,L,fe,W,Me,xe,ne,F,H],styles:[".page-header[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;margin-bottom:30px}.title-section[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:5px;color:var(--primary-color)}.title-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-secondary);margin:0}.actions-section[_ngcontent-%COMP%]{display:flex;gap:10px}.filters-container[_ngcontent-%COMP%]{margin-bottom:30px;display:flex;flex-direction:column;gap:15px}.search-container[_ngcontent-%COMP%]{width:100%}.filter-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:15px;align-items:center}.filter-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{flex:1;min-width:200px}.credential-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px}.credential-card[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.credential-avatar[_ngcontent-%COMP%]{background-color:#0078d41a;display:flex;align-items:center;justify-content:center}.credential-avatar.valid[_ngcontent-%COMP%]{background-color:#00e67633}.credential-avatar.expired[_ngcontent-%COMP%]{background-color:#ffb30033}.credential-avatar.revoked[_ngcontent-%COMP%]{background-color:#ff408133}.credential-avatar[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--primary-color)}.credential-avatar.valid[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--success-color)}.credential-avatar.expired[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--warning-color)}.credential-avatar.revoked[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--error-color)}.credential-type[_ngcontent-%COMP%]{font-size:.85rem;color:var(--text-secondary)}.credential-description[_ngcontent-%COMP%]{color:var(--text-secondary);margin-bottom:15px;min-height:20px}.credential-meta[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;margin-bottom:15px}.meta-item[_ngcontent-%COMP%]{display:flex;font-size:.9rem}.meta-label[_ngcontent-%COMP%]{width:60px;font-weight:500;color:var(--text-secondary)}.meta-value[_ngcontent-%COMP%]{flex:1}.credential-status[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:.9rem;padding:4px 10px;border-radius:16px;width:fit-content;margin-top:10px}.credential-status[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;height:16px;width:16px;margin-right:5px}.credential-status.valid[_ngcontent-%COMP%]{background-color:#00e6761a;color:var(--success-color)}.credential-status.expired[_ngcontent-%COMP%]{background-color:#ffb3001a;color:var(--warning-color)}.credential-status.revoked[_ngcontent-%COMP%]{background-color:#ff40811a;color:var(--error-color)}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 0;text-align:center}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:5rem;height:5rem;width:5rem;margin-bottom:20px;color:var(--text-secondary)}.empty-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:10px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:20px;color:var(--text-secondary)}.empty-state-actions[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;justify-content:center}@media (max-width: 768px){.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.actions-section[_ngcontent-%COMP%]{margin-top:15px;width:100%}.credential-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};export{ve as CredentialsComponent};
