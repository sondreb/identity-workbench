import{a as ue,b as fe}from"./chunk-SLUFEPBK.js";import{a as le,b as me,c as T}from"./chunk-4BHK3JB6.js";import{a as de,b as se,c as O}from"./chunk-FQMU6435.js";import{A as ye,p as L,q as pe,r as B,u as R,v as ce,x as J,y as V,z as ge}from"./chunk-MQR7L55N.js";import{h as F,m as N,o as W,q as j}from"./chunk-CDN4SK7S.js";import{b as K}from"./chunk-FKVQ3YOM.js";import{a as $,b as ee,c as te,d as ie,e as ne,f as oe,g as re,h as ae}from"./chunk-D6JINR2S.js";import{d as Z}from"./chunk-DVP3NVYZ.js";import{Ad as D,Bd as P,Fb as i,Gb as u,Hb as x,Jb as c,Ka as d,Kb as g,Lb as y,Nb as b,Oa as f,Qb as G,Sb as Y,Va as v,Za as h,eb as _,gc as q,ic as Q,jb as C,lc as X,mb as H,nb as U,nc as E,oa as I,ob as t,pa as S,pb as e,sb as M,ub as s,vb as p,vd as w,yd as k}from"./chunk-OXWMXC6C.js";var ke=l=>({detected:l});function De(l,o){if(l&1&&(t(0,"div",27),i(1),e()),l&2){let r=p();_("ngClass",b(2,ke,r.stellarKeyType==="Public Key"||r.stellarKeyType==="Private Key")),d(),x(" Detected: ",r.stellarKeyType," ")}}function Pe(l,o){l&1&&(t(0,"div",28),i(1," Private keys enable credential signing and can be used to derive the public key "),e())}var A=class l{constructor(o,r,n){this.dialogRef=o;this.identityService=r;this.snackBar=n}didString="";stellarKey="";jsonContent="";privateKey="";privateKeyName="";isStellarPrivateKey=!1;stellarKeyType="Unknown Key Type";importDID(){if(!this.didString){this.showError("Please enter a valid DID");return}this.identityService.importFromDIDString(this.didString)?(this.showSuccess("DID imported successfully"),this.dialogRef.close(!0)):this.showError("Failed to import DID. Please check the format.")}importStellar(){if(!this.stellarKey){this.showError("Please enter a valid Stellar key");return}this.identityService.importFromStellarKey(this.stellarKey,this.isStellarPrivateKey)?(this.showSuccess(`Stellar ${this.isStellarPrivateKey?"private":"public"} key imported successfully`),this.dialogRef.close(!0)):this.showError(`Failed to import Stellar ${this.isStellarPrivateKey?"private":"public"} key. Please check the format.`)}importJSON(){if(!this.jsonContent){this.showError("Please enter valid JSON content");return}try{let o=JSON.parse(this.jsonContent);this.identityService.importFromJsonFile(o)?(this.showSuccess("DID document imported successfully"),this.dialogRef.close(!0)):this.showError("Failed to import DID document. Invalid format.")}catch{this.showError("Invalid JSON format")}}importPrivateKey(){if(!this.privateKey||!this.privateKeyName){this.showError("Please provide both a name and private key");return}this.identityService.addIdentity({method:"key",publicKey:"generated-from-private-key",privateKey:this.privateKey,name:this.privateKeyName,description:"Identity with imported private key"})?(this.showSuccess("Private key imported successfully"),this.dialogRef.close(!0)):this.showError("Failed to import private key")}onFileSelected(o,r){let n=o.target.files?.[0];if(!n)return;let m=new FileReader;m.onload=a=>{let z=a.target?.result;r==="json"?this.jsonContent=z:r==="privateKey"&&(this.privateKey=z)},m.readAsText(n)}onStellarKeyInput(){let o=this.stellarKey.trim();if(!o){this.stellarKeyType="Unknown Key Type";return}o.startsWith("S")&&o.length===56?(this.isStellarPrivateKey=!0,this.stellarKeyType="Private Key"):o.startsWith("G")&&o.length===56?(this.isStellarPrivateKey=!1,this.stellarKeyType="Public Key"):this.stellarKeyType="Invalid Key Format"}closeDialog(){this.dialogRef.close(!1)}showSuccess(o){this.snackBar.open(o,"Close",{duration:3e3,panelClass:"success-snackbar"})}showError(o){this.snackBar.open(o,"Close",{duration:5e3,panelClass:"error-snackbar"})}static \u0275fac=function(r){return new(r||l)(f(le),f(K),f(ge))};static \u0275cmp=v({type:l,selectors:[["app-import-identity-dialog"]],decls:93,vars:10,consts:[[1,"import-dialog-container"],[1,"dialog-title","neon-text"],["dynamicHeight","","animationDuration","300ms"],["label","DID String"],[1,"tab-content"],[1,"tab-description"],["appearance","outline",1,"full-width"],["matInput","","placeholder","did:method:identifier",3,"ngModelChange","ngModel"],["matSuffix",""],[1,"action-buttons"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click"],["label","Stellar Key"],["matInput","","placeholder","Enter Stellar public or private key",3,"ngModelChange","input","ngModel"],[1,"key-type-selector"],["color","primary",3,"ngModelChange","ngModel","disabled"],["class","key-type-hint",3,"ngClass",4,"ngIf"],["class","key-type-hint",4,"ngIf"],["label","JSON File"],[1,"file-input-wrapper"],["mat-stroked-button","","color","primary",1,"upload-btn"],["type","file","accept",".json",3,"change"],["matInput","","rows","8","placeholder","Paste JSON content here...",3,"ngModelChange","ngModel"],["label","Private Key"],["matInput","","placeholder","Signing Key Name",3,"ngModelChange","ngModel"],["type","file",3,"change"],["matInput","","rows","4","placeholder","Paste private key here...",3,"ngModelChange","ngModel"],[1,"key-type-hint",3,"ngClass"],[1,"key-type-hint"]],template:function(r,n){r&1&&(t(0,"div",0)(1,"h2",1),i(2,"Import Identity"),e(),t(3,"mat-tab-group",2)(4,"mat-tab",3)(5,"div",4)(6,"p",5),i(7,"Enter a DID string to import (e.g., did:key:z6Mk...)"),e(),t(8,"mat-form-field",6)(9,"mat-label"),i(10,"DID String"),e(),t(11,"input",7),y("ngModelChange",function(a){return g(n.didString,a)||(n.didString=a),a}),e(),t(12,"mat-icon",8),i(13,"contact_page"),e()(),t(14,"div",9)(15,"button",10),s("click",function(){return n.closeDialog()}),i(16,"Cancel"),e(),t(17,"button",11),s("click",function(){return n.importDID()}),t(18,"mat-icon"),i(19,"add"),e(),i(20," Import DID "),e()()()(),t(21,"mat-tab",12)(22,"div",4)(23,"p",5),i(24,"Enter a Stellar key to import"),e(),t(25,"mat-form-field",6)(26,"mat-label"),i(27,"Stellar Key"),e(),t(28,"input",13),y("ngModelChange",function(a){return g(n.stellarKey,a)||(n.stellarKey=a),a}),s("input",function(){return n.onStellarKeyInput()}),e(),t(29,"mat-icon",8),i(30,"star"),e(),t(31,"mat-hint"),i(32),e()(),t(33,"div",14)(34,"mat-slide-toggle",15),y("ngModelChange",function(a){return g(n.isStellarPrivateKey,a)||(n.isStellarPrivateKey=a),a}),i(35," This is a private key "),e(),h(36,De,2,4,"div",16)(37,Pe,2,0,"div",17),e(),t(38,"div",9)(39,"button",10),s("click",function(){return n.closeDialog()}),i(40,"Cancel"),e(),t(41,"button",11),s("click",function(){return n.importStellar()}),t(42,"mat-icon"),i(43,"add"),e(),i(44," Import Stellar Key "),e()()()(),t(45,"mat-tab",18)(46,"div",4)(47,"p",5),i(48,"Import a DID Document from JSON"),e(),t(49,"div",19)(50,"button",20)(51,"mat-icon"),i(52,"upload_file"),e(),i(53," Select JSON File "),e(),t(54,"input",21),s("change",function(a){return n.onFileSelected(a,"json")}),e()(),t(55,"mat-form-field",6)(56,"mat-label"),i(57,"JSON Content"),e(),t(58,"textarea",22),y("ngModelChange",function(a){return g(n.jsonContent,a)||(n.jsonContent=a),a}),e()(),t(59,"div",9)(60,"button",10),s("click",function(){return n.closeDialog()}),i(61,"Cancel"),e(),t(62,"button",11),s("click",function(){return n.importJSON()}),t(63,"mat-icon"),i(64,"add"),e(),i(65," Import JSON "),e()()()(),t(66,"mat-tab",23)(67,"div",4)(68,"p",5),i(69,"Import a private key for signing credentials"),e(),t(70,"mat-form-field",6)(71,"mat-label"),i(72,"Name"),e(),t(73,"input",24),y("ngModelChange",function(a){return g(n.privateKeyName,a)||(n.privateKeyName=a),a}),e()(),t(74,"div",19)(75,"button",20)(76,"mat-icon"),i(77,"upload_file"),e(),i(78," Select Private Key File "),e(),t(79,"input",25),s("change",function(a){return n.onFileSelected(a,"privateKey")}),e()(),t(80,"mat-form-field",6)(81,"mat-label"),i(82,"Private Key"),e(),t(83,"textarea",26),y("ngModelChange",function(a){return g(n.privateKey,a)||(n.privateKey=a),a}),e(),t(84,"mat-hint"),i(85,"This key will be stored securely and used for signing credentials"),e()(),t(86,"div",9)(87,"button",10),s("click",function(){return n.closeDialog()}),i(88,"Cancel"),e(),t(89,"button",11),s("click",function(){return n.importPrivateKey()}),t(90,"mat-icon"),i(91,"vpn_key"),e(),i(92," Import Private Key "),e()()()()()()),r&2&&(d(11),c("ngModel",n.didString),d(17),c("ngModel",n.stellarKey),d(4),u(n.stellarKeyType),d(2),c("ngModel",n.isStellarPrivateKey),_("disabled",n.stellarKey&&(n.stellarKeyType==="Public Key"||n.stellarKeyType==="Private Key")),d(2),_("ngIf",n.stellarKey&&n.stellarKeyType!=="Unknown Key Type"),d(),_("ngIf",!n.stellarKey||n.stellarKeyType==="Unknown Key Type"),d(21),c("ngModel",n.jsonContent),d(15),c("ngModel",n.privateKeyName),d(10),c("ngModel",n.privateKey))},dependencies:[E,q,Q,j,F,N,W,T,ce,R,L,pe,B,V,J,k,w,O,de,se,P,D,ye,fe,ue],styles:[".import-dialog-container[_ngcontent-%COMP%]{padding:16px;max-width:600px}.dialog-title[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}.tab-content[_ngcontent-%COMP%]{padding:20px 0}.tab-description[_ngcontent-%COMP%]{color:var(--text-secondary);margin-bottom:20px}.full-width[_ngcontent-%COMP%]{width:100%}.action-buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px;margin-top:20px}.file-input-wrapper[_ngcontent-%COMP%]{position:relative;margin-bottom:20px;overflow:hidden}.file-input-wrapper[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;cursor:pointer}.upload-btn[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:center;gap:8px;padding:10px;border:1px dashed var(--primary-color)}textarea[_ngcontent-%COMP%]:focus, input[_ngcontent-%COMP%]:focus{box-shadow:0 0 8px #00c3ff99}.key-type-selector[_ngcontent-%COMP%]{margin-bottom:20px}.key-type-hint[_ngcontent-%COMP%]{font-size:.85rem;color:var(--text-secondary);margin-top:8px;margin-left:4px}.key-type-hint.detected[_ngcontent-%COMP%]{color:var(--success-color);font-weight:500}"]})};var Ke=l=>["/identity",l],Te=(l,o)=>o.id;function Oe(l,o){if(l&1){let r=M();t(0,"div",10)(1,"mat-icon"),i(2,"person_off"),e(),t(3,"h2"),i(4,"No Identities Found"),e(),t(5,"p"),i(6,"You haven't imported any identities yet."),e(),t(7,"button",5),s("click",function(){I(r);let m=p();return S(m.openImportDialog())}),i(8," Import Your First Identity "),e()()}}function Fe(l,o){if(l&1){let r=M();t(0,"div",10)(1,"mat-icon"),i(2,"search_off"),e(),t(3,"h2"),i(4,"No Results Found"),e(),t(5,"p"),i(6,"No identities match your search criteria."),e(),t(7,"button",12),s("click",function(){I(r);let m=p();return S(m.searchTerm="")}),i(8," Clear Search "),e()()}}function Ne(l,o){if(l&1&&(t(0,"p",15),i(1),e()),l&2){let r=p().$implicit;d(),u(r.description)}}function We(l,o){l&1&&(t(0,"p",17)(1,"mat-icon"),i(2,"vpn_key"),e(),i(3," Private Key Available "),e())}function je(l,o){if(l&1){let r=M();t(0,"mat-card",13)(1,"mat-card-header")(2,"div",14)(3,"mat-icon"),i(4),e()(),t(5,"mat-card-title"),i(6),e(),t(7,"mat-card-subtitle"),i(8),e()(),t(9,"mat-card-content"),h(10,Ne,2,1,"p",15),t(11,"p",16),i(12,"Method: "),t(13,"span",3),i(14),e()(),t(15,"p",16),i(16),G(17,"date"),e(),h(18,We,4,0,"p",17),e(),t(19,"mat-card-actions")(20,"button",18),i(21," DETAILS "),e(),t(22,"button",19),s("click",function(){let m=I(r).$implicit,a=p(2);return S(a.deleteIdentity(m.id))}),i(23," DELETE "),e()()()}if(l&2){let r=o.$implicit,n=p(2);d(4),u(n.getMethodLogo(r.method)),d(2),u(r.name),d(2),u(n.truncateId(r.id)),d(2),C(r.description?10:-1),d(4),u(r.method),d(2),x("Created: ",Y(17,8,r.created,"medium"),""),d(2),C(r.privateKey?18:-1),d(2),_("routerLink",b(11,Ke,r.id))}}function Le(l,o){if(l&1&&(t(0,"div",11),H(1,je,24,13,"mat-card",13,Te),e()),l&2){let r=p();d(),U(r.filteredIdentities)}}var _e=class l{constructor(o,r){this.identityService=o;this.dialog=r;this.loadIdentities()}identities=[];searchTerm="";loadIdentities(){this.identityService.getAllIdentities().subscribe(o=>{this.identities=o})}get filteredIdentities(){if(!this.searchTerm)return this.identities;let o=this.searchTerm.toLowerCase();return this.identities.filter(r=>r.id.toLowerCase().includes(o)||r.name?.toLowerCase().includes(o)||r.description?.toLowerCase().includes(o))}openImportDialog(){this.dialog.open(A,{width:"600px"}).afterClosed().subscribe(r=>{r&&this.loadIdentities()})}deleteIdentity(o){confirm("Are you sure you want to delete this identity?")&&this.identityService.deleteIdentity(o)}getMethodLogo(o){switch(o){case"key":return"vpn_key";case"web":return"language";case"stellar":return"star";case"is":return"public";default:return"person"}}truncateId(o){return o.length<=30?o:o.substring(0,15)+"..."+o.substring(o.length-10)}static \u0275fac=function(r){return new(r||l)(f(K),f(me))};static \u0275cmp=v({type:l,selectors:[["app-identities"]],decls:22,vars:4,consts:[[1,"page-container"],[1,"page-header"],[1,"title-section"],[1,"neon-text"],[1,"actions-section"],["mat-raised-button","","color","primary",3,"click"],[1,"search-container"],["appearance","outline",1,"search-field"],["matInput","","placeholder","Search by name or DID",3,"ngModelChange","ngModel"],["matSuffix",""],[1,"empty-state"],[1,"identities-grid"],["mat-button","","color","primary",3,"click"],[1,"identity-card","neon-card"],["mat-card-avatar","",1,"identity-avatar"],[1,"identity-description"],[1,"identity-meta"],[1,"private-key-indicator"],["mat-button","","color","primary",3,"routerLink"],["mat-button","","color","warn",3,"click"]],template:function(r,n){r&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),i(4,"Identities"),e(),t(5,"p"),i(6,"Manage your decentralized identifiers (DIDs)"),e()(),t(7,"div",4)(8,"button",5),s("click",function(){return n.openImportDialog()}),t(9,"mat-icon"),i(10,"add"),e(),i(11," Import Identity "),e()()(),t(12,"div",6)(13,"mat-form-field",7)(14,"mat-label"),i(15,"Search"),e(),t(16,"input",8),y("ngModelChange",function(a){return g(n.searchTerm,a)||(n.searchTerm=a),a}),e(),t(17,"mat-icon",9),i(18,"search"),e()()(),h(19,Oe,9,0,"div",10)(20,Fe,9,0,"div",10)(21,Le,3,0,"div",11),e()),r&2&&(d(16),c("ngModel",n.searchTerm),d(3),C(n.identities.length===0?19:-1),d(),C(n.filteredIdentities.length===0&&n.searchTerm?20:-1),d(),C(n.filteredIdentities.length>0?21:-1))},dependencies:[E,X,Z,ae,$,ne,re,te,oe,ie,ee,k,w,P,D,T,O,V,J,R,L,B,j,F,N,W],styles:[".page-header[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;margin-bottom:30px}.title-section[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:5px}.title-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-secondary);margin:0}.search-container[_ngcontent-%COMP%]{margin-bottom:20px}.search-field[_ngcontent-%COMP%]{width:100%}.identities-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px}.identity-card[_ngcontent-%COMP%]{margin-bottom:20px}.identity-avatar[_ngcontent-%COMP%]{background-color:#00c3ff33;display:flex;align-items:center;justify-content:center}.identity-avatar[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--primary-color)}.identity-description[_ngcontent-%COMP%]{color:var(--text-secondary);margin-bottom:15px;min-height:40px}.identity-meta[_ngcontent-%COMP%]{font-size:.9rem;margin:5px 0;color:var(--text-secondary)}.private-key-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--success-color);margin-top:10px}.private-key-indicator[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:5px;font-size:1rem;height:1rem;width:1rem}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 0;text-align:center}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:5rem;height:5rem;width:5rem;margin-bottom:20px;color:var(--text-secondary)}.empty-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:10px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:20px;color:var(--text-secondary)}@media (max-width: 768px){.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.actions-section[_ngcontent-%COMP%]{margin-top:15px;width:100%}.identities-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};export{_e as IdentitiesComponent};
