import{a as he,b as Ce}from"./chunk-LVVONWMV.js";import{a as se,b as pe,c as F}from"./chunk-JC3SLJ7S.js";import{a as ce,b as ge,c as N}from"./chunk-66MR4OIR.js";import{b as R,c as ye,d as J,g as V,h as ue,j as A,k as z,l as fe,m as _e}from"./chunk-QKM7KKRN.js";import{B as L,D as B,u as j,z as W}from"./chunk-2N6EGSYQ.js";import{K as O,a as ie,b as ne,c as oe,d as re,e as ae,f as le,g as de,h as me}from"./chunk-N2EBPQD7.js";import{d as te}from"./chunk-7BHHVVNY.js";import{$a as h,Gd as k,Hb as i,Ib as f,Jb as b,Ka as Y,Kd as w,Lb as g,Ma as d,Mb as y,Md as K,Nb as u,Nd as T,Qa as _,Qb as D,Tb as Q,Vb as X,Xa as M,g as G,gb as c,lb as C,nc as $,ob as Z,pa as v,pb as q,pc as P,qa as S,qb as t,rb as e,sb as I,sc as ee,ub as x,uc as E,wb as s,xb as p}from"./chunk-ONE5RFGK.js";var Ke=a=>({detected:a});function Te(a,o){if(a&1&&(t(0,"div",28),i(1),e()),a&2){let r=p();c("ngClass",D(2,Ke,r.stellarKeyType==="Public Key"||r.stellarKeyType==="Private Key")),d(),b(" Detected: ",r.stellarKeyType," ")}}function Oe(a,o){a&1&&(t(0,"div",29),i(1," Private keys enable credential signing and can be used to derive the public key "),e())}var U=class a{constructor(o,r,n){this.dialogRef=o;this.identityService=r;this.snackBar=n}didString="";stellarKey="";jsonContent="";privateKey="";privateKeyName="";isStellarPrivateKey=!1;stellarKeyType="Unknown Key Type";freeIdDid="";freeIdPrivateKey="";freeIdImportType="did";importDID(){return G(this,null,function*(){if(!this.didString){this.showError("Please enter a valid DID");return}let o=yield this.identityService.importFromDIDString(this.didString);console.log("Result:",o),o?(this.showSuccess("DID imported successfully"),this.dialogRef.close(!0)):this.showError("Failed to import DID. Please check the format.")})}importStellar(){if(!this.stellarKey){this.showError("Please enter a valid Stellar key");return}this.identityService.importFromStellarKey(this.stellarKey,this.isStellarPrivateKey)?(this.showSuccess(`Stellar ${this.isStellarPrivateKey?"private":"public"} key imported successfully`),this.dialogRef.close(!0)):this.showError(`Failed to import Stellar ${this.isStellarPrivateKey?"private":"public"} key. Please check the format.`)}importJSON(){if(!this.jsonContent){this.showError("Please enter valid JSON content");return}try{let o=JSON.parse(this.jsonContent);this.identityService.importFromJsonFile(o)?(this.showSuccess("DID document imported successfully"),this.dialogRef.close(!0)):this.showError("Failed to import DID document. Invalid format.")}catch{this.showError("Invalid JSON format")}}importPrivateKey(){if(!this.privateKey||!this.privateKeyName){this.showError("Please provide both a name and private key");return}this.identityService.addIdentity({method:"key",publicKey:"generated-from-private-key",privateKey:this.privateKey,name:this.privateKeyName,description:"Identity with imported private key"})?(this.showSuccess("Private key imported successfully"),this.dialogRef.close(!0)):this.showError("Failed to import private key")}onFileSelected(o,r){let n=o.target.files?.[0];if(!n)return;let m=new FileReader;m.onload=l=>{let H=l.target?.result;r==="json"?this.jsonContent=H:r==="privateKey"&&(this.privateKey=H)},m.readAsText(n)}onStellarKeyInput(){let o=this.stellarKey.trim();if(!o){this.stellarKeyType="Unknown Key Type";return}o.startsWith("S")&&o.length===56?(this.isStellarPrivateKey=!0,this.stellarKeyType="Private Key"):o.startsWith("G")&&o.length===56?(this.isStellarPrivateKey=!1,this.stellarKeyType="Public Key"):this.stellarKeyType="Invalid Key Format"}closeDialog(){this.dialogRef.close(!1)}showSuccess(o){this.snackBar.open(o,"Close",{duration:3e3,panelClass:"success-snackbar"})}showError(o){this.snackBar.open(o,"Close",{duration:5e3,panelClass:"error-snackbar"})}static \u0275fac=function(r){return new(r||a)(_(se),_(O),_(fe))};static \u0275cmp=M({type:a,selectors:[["app-import-identity-dialog"]],decls:96,vars:10,consts:[[1,"import-dialog-container"],[1,"dialog-title"],["dynamicHeight","","animationDuration","300ms"],["label","DID String"],[1,"tab-content"],[1,"tab-description"],["appearance","outline",1,"full-width"],["matInput","","placeholder","did:method:identifier",3,"ngModelChange","ngModel"],["matSuffix",""],[1,"action-buttons"],["mat-button","",3,"click"],["mat-flat-button","","color","primary",3,"click"],["label","Stellar Key"],["matInput","","placeholder","Enter Stellar public or private key",3,"ngModelChange","input","ngModel"],[1,"key-type-selector"],["color","primary",3,"ngModelChange","ngModel","disabled"],["class","key-type-hint",3,"ngClass",4,"ngIf"],["class","key-type-hint",4,"ngIf"],["mat-raised-button","","color","primary",3,"click"],["label","JSON File"],[1,"file-input-wrapper"],["mat-stroked-button","","color","primary",1,"upload-btn"],["type","file","accept",".json",3,"change"],["matInput","","rows","8","placeholder","Paste JSON content here...",3,"ngModelChange","ngModel"],["label","Private Key"],["matInput","","placeholder","Signing Key Name",3,"ngModelChange","ngModel"],["type","file",3,"change"],["matInput","","rows","4","placeholder","Paste private key here...",3,"ngModelChange","ngModel"],[1,"key-type-hint",3,"ngClass"],[1,"key-type-hint"]],template:function(r,n){r&1&&(t(0,"div",0)(1,"h2",1),i(2,"Import Identity"),e(),t(3,"mat-tab-group",2)(4,"mat-tab",3)(5,"div",4)(6,"p",5),i(7,"Supported methods: DID Key (did:key), FreeID (did:is), DID Stellar (did:stellar)"),I(8,"br")(9,"br"),i(10," Enter a DID identifier to import (e.g., did:key:z6Mk..., did:stellar:SOZ..., did:is:0f254...) "),e(),t(11,"mat-form-field",6)(12,"mat-label"),i(13,"DID String"),e(),t(14,"input",7),u("ngModelChange",function(l){return y(n.didString,l)||(n.didString=l),l}),e(),t(15,"mat-icon",8),i(16,"contact_page"),e()(),t(17,"div",9)(18,"button",10),s("click",function(){return n.closeDialog()}),i(19,"Cancel"),e(),t(20,"button",11),s("click",function(){return n.importDID()}),t(21,"mat-icon"),i(22,"add"),e(),i(23," Import DID "),e()()()(),t(24,"mat-tab",12)(25,"div",4)(26,"p",5),i(27,"Enter a Stellar key to import"),e(),t(28,"mat-form-field",6)(29,"mat-label"),i(30,"Stellar Key"),e(),t(31,"input",13),u("ngModelChange",function(l){return y(n.stellarKey,l)||(n.stellarKey=l),l}),s("input",function(){return n.onStellarKeyInput()}),e(),t(32,"mat-icon",8),i(33,"star"),e(),t(34,"mat-hint"),i(35),e()(),t(36,"div",14)(37,"mat-slide-toggle",15),u("ngModelChange",function(l){return y(n.isStellarPrivateKey,l)||(n.isStellarPrivateKey=l),l}),i(38," This is a private key "),e(),h(39,Te,2,4,"div",16)(40,Oe,2,0,"div",17),e(),t(41,"div",9)(42,"button",10),s("click",function(){return n.closeDialog()}),i(43,"Cancel"),e(),t(44,"button",18),s("click",function(){return n.importStellar()}),t(45,"mat-icon"),i(46,"add"),e(),i(47," Import Stellar Key "),e()()()(),t(48,"mat-tab",19)(49,"div",4)(50,"p",5),i(51,"Import a DID Document from JSON"),e(),t(52,"div",20)(53,"button",21)(54,"mat-icon"),i(55,"upload_file"),e(),i(56," Select JSON File "),e(),t(57,"input",22),s("change",function(l){return n.onFileSelected(l,"json")}),e()(),t(58,"mat-form-field",6)(59,"mat-label"),i(60,"JSON Content"),e(),t(61,"textarea",23),u("ngModelChange",function(l){return y(n.jsonContent,l)||(n.jsonContent=l),l}),e()(),t(62,"div",9)(63,"button",10),s("click",function(){return n.closeDialog()}),i(64,"Cancel"),e(),t(65,"button",18),s("click",function(){return n.importJSON()}),t(66,"mat-icon"),i(67,"add"),e(),i(68," Import JSON "),e()()()(),t(69,"mat-tab",24)(70,"div",4)(71,"p",5),i(72,"Import a private key for signing credentials"),e(),t(73,"mat-form-field",6)(74,"mat-label"),i(75,"Name"),e(),t(76,"input",25),u("ngModelChange",function(l){return y(n.privateKeyName,l)||(n.privateKeyName=l),l}),e()(),t(77,"div",20)(78,"button",21)(79,"mat-icon"),i(80,"upload_file"),e(),i(81," Select Private Key File "),e(),t(82,"input",26),s("change",function(l){return n.onFileSelected(l,"privateKey")}),e()(),t(83,"mat-form-field",6)(84,"mat-label"),i(85,"Private Key"),e(),t(86,"textarea",27),u("ngModelChange",function(l){return y(n.privateKey,l)||(n.privateKey=l),l}),e(),t(87,"mat-hint"),i(88,"This key will be stored securely and used for signing credentials"),e()(),t(89,"div",9)(90,"button",10),s("click",function(){return n.closeDialog()}),i(91,"Cancel"),e(),t(92,"button",18),s("click",function(){return n.importPrivateKey()}),t(93,"mat-icon"),i(94,"vpn_key"),e(),i(95," Import Private Key "),e()()()()()()),r&2&&(d(14),g("ngModel",n.didString),d(17),g("ngModel",n.stellarKey),d(4),f(n.stellarKeyType),d(2),g("ngModel",n.isStellarPrivateKey),c("disabled",n.stellarKey&&(n.stellarKeyType==="Public Key"||n.stellarKeyType==="Private Key")),d(2),c("ngIf",n.stellarKey&&n.stellarKeyType!=="Unknown Key Type"),d(),c("ngIf",!n.stellarKey||n.stellarKeyType==="Unknown Key Type"),d(21),g("ngModel",n.jsonContent),d(15),g("ngModel",n.privateKeyName),d(10),g("ngModel",n.privateKey))},dependencies:[E,$,P,B,j,W,L,F,ue,V,R,ye,J,z,A,w,k,N,ce,ge,T,K,_e,Ce,he],styles:[".import-dialog-container[_ngcontent-%COMP%]{padding:16px;max-width:600px}.dialog-title[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px;color:var(--primary-color)}.tab-content[_ngcontent-%COMP%]{padding:20px 0}.tab-description[_ngcontent-%COMP%]{color:var(--text-secondary);margin-bottom:20px}.full-width[_ngcontent-%COMP%]{width:100%}.action-buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px;margin-top:20px}.file-input-wrapper[_ngcontent-%COMP%]{position:relative;margin-bottom:20px;overflow:hidden}.file-input-wrapper[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;cursor:pointer}.upload-btn[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:center;gap:8px;padding:10px;border:1px dashed var(--primary-color)}textarea[_ngcontent-%COMP%]:focus, input[_ngcontent-%COMP%]:focus{outline:1px solid var(--primary-color);box-shadow:none}.key-type-selector[_ngcontent-%COMP%]{margin-bottom:20px}.key-type-hint[_ngcontent-%COMP%]{font-size:.85rem;color:var(--text-secondary);margin-top:8px;margin-left:4px}.key-type-hint.detected[_ngcontent-%COMP%]{color:var(--success-color);font-weight:500}"]})};var Fe=a=>["/identity",a],Ne=(a,o)=>o.id;function je(a,o){if(a&1){let r=x();t(0,"div",9)(1,"mat-icon"),i(2,"person_off"),e(),t(3,"h2"),i(4,"No Identities Found"),e(),t(5,"p"),i(6,"You haven't imported any identities yet."),e(),t(7,"button",4),s("click",function(){v(r);let m=p();return S(m.openImportDialog())}),i(8," Import Your First Identity "),e()()}}function We(a,o){if(a&1){let r=x();t(0,"div",9)(1,"mat-icon"),i(2,"search_off"),e(),t(3,"h2"),i(4,"No Results Found"),e(),t(5,"p"),i(6,"No identities match your search criteria."),e(),t(7,"button",11),s("click",function(){v(r);let m=p();return S(m.searchTerm="")}),i(8," Clear Search "),e()()}}function Le(a,o){if(a&1&&I(0,"img",22),a&2){let r=p().$implicit;c("src",r.picture,Y)}}function Be(a,o){if(a&1&&(t(0,"mat-icon"),i(1),e()),a&2){let r=p().$implicit,n=p(2);d(),f(n.getMethodLogo(r.method))}}function Re(a,o){if(a&1&&(t(0,"p",16),i(1),e()),a&2){let r=p().$implicit;d(),f(r.description)}}function Je(a,o){a&1&&(t(0,"p",18)(1,"mat-icon"),i(2,"vpn_key"),e(),i(3," Private Key Available "),e())}function Ve(a,o){if(a&1){let r=x();t(0,"mat-card",12)(1,"mat-card-header")(2,"div",13),h(3,Le,1,1,"img",14)(4,Be,2,1,"mat-icon",15),e(),t(5,"mat-card-title"),i(6),e(),t(7,"mat-card-subtitle"),i(8),e()(),t(9,"mat-card-content"),h(10,Re,2,1,"p",16),t(11,"p",17),i(12,"Method: "),t(13,"span"),i(14),e()(),t(15,"p",17),i(16),Q(17,"date"),e(),h(18,Je,4,0,"p",18),e(),t(19,"mat-card-actions")(20,"button",19),i(21," DETAILS "),e(),I(22,"span",20),t(23,"button",21),s("click",function(){let m=v(r).$implicit,l=p(2);return S(l.deleteIdentity(m.id))}),i(24," DELETE "),e()()()}if(a&2){let r=o.$implicit,n=p(2);d(3),c("ngIf",r.picture),d(),c("ngIf",!r.picture),d(2),f(r.name),d(2),f(n.truncateId(r.id)),d(2),C(r.description?10:-1),d(4),f(r.method),d(2),b("Created: ",X(17,9,r.created,"medium"),""),d(2),C(r.privateKey?18:-1),d(2),c("routerLink",D(12,Fe,r.id))}}function Ae(a,o){if(a&1&&(t(0,"div",10),Z(1,Ve,25,14,"mat-card",12,Ne),e()),a&2){let r=p();d(),q(r.filteredIdentities)}}var Ie=class a{constructor(o,r){this.identityService=o;this.dialog=r;this.loadIdentities()}identities=[];searchTerm="";loadIdentities(){this.identityService.getAllIdentities().subscribe(o=>{this.identities=o})}get filteredIdentities(){if(!this.searchTerm)return this.identities;let o=this.searchTerm.toLowerCase();return this.identities.filter(r=>r.id.toLowerCase().includes(o)||r.name?.toLowerCase().includes(o)||r.description?.toLowerCase().includes(o))}openImportDialog(){this.dialog.open(U,{width:"600px"}).afterClosed().subscribe(r=>{r&&this.loadIdentities()})}deleteIdentity(o){confirm("Are you sure you want to delete this identity?")&&this.identityService.deleteIdentity(o)}getMethodLogo(o){switch(o){case"key":return"vpn_key";case"web":return"language";case"stellar":return"star";case"is":return"public";default:return"person"}}truncateId(o){return o.length<=30?o:o.substring(0,15)+"..."+o.substring(o.length-10)}static \u0275fac=function(r){return new(r||a)(_(O),_(pe))};static \u0275cmp=M({type:a,selectors:[["app-identities"]],decls:22,vars:4,consts:[[1,"page-container"],[1,"page-header"],[1,"title-section"],[1,"actions-section"],["mat-flat-button","","color","primary",3,"click"],[1,"search-container"],["appearance","outline",1,"search-field"],["matInput","","placeholder","Search by name or DID",3,"ngModelChange","ngModel"],["matSuffix",""],[1,"empty-state"],[1,"identities-grid"],["mat-button","","color","primary",3,"click"],[1,"identity-card","neon-card"],["mat-card-avatar","",1,"identity-avatar"],["alt","Profile picture","class","profile-picture",3,"src",4,"ngIf"],[4,"ngIf"],[1,"identity-description"],[1,"identity-meta"],[1,"private-key-indicator"],["mat-button","",1,"action-left",3,"routerLink"],[1,"flex-spacer"],["mat-button","",1,"warn",3,"click"],["alt","Profile picture",1,"profile-picture",3,"src"]],template:function(r,n){r&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),i(4,"Identities"),e(),t(5,"p"),i(6,"Manage your decentralized identifiers (DIDs)"),e()(),t(7,"div",3)(8,"button",4),s("click",function(){return n.openImportDialog()}),t(9,"mat-icon"),i(10,"add"),e(),i(11," Import Identity "),e()()(),t(12,"div",5)(13,"mat-form-field",6)(14,"mat-label"),i(15,"Search"),e(),t(16,"input",7),u("ngModelChange",function(l){return y(n.searchTerm,l)||(n.searchTerm=l),l}),e(),t(17,"mat-icon",8),i(18,"search"),e()()(),h(19,je,9,0,"div",9)(20,We,9,0,"div",9)(21,Ae,3,0,"div",10),e()),r&2&&(d(16),g("ngModel",n.searchTerm),d(3),C(n.identities.length===0?19:-1),d(),C(n.filteredIdentities.length===0&&n.searchTerm?20:-1),d(),C(n.filteredIdentities.length>0?21:-1))},dependencies:[E,P,ee,te,me,ie,ae,de,oe,le,re,ne,w,k,T,K,F,N,z,A,V,R,J,B,j,W,L],styles:[".page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.title-section[_ngcontent-%COMP%]{flex:1}.actions-section[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.title-section[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:5px;color:var(--primary-color)}.title-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-secondary);margin:0}.search-container[_ngcontent-%COMP%]{margin-bottom:20px}.search-field[_ngcontent-%COMP%]{width:100%}.identities-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px}.identity-card[_ngcontent-%COMP%]{margin-bottom:20px}.identity-avatar[_ngcontent-%COMP%]{background-color:#0078d41a;display:flex;align-items:center;justify-content:center}.identity-avatar[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--primary-color)}.identity-description[_ngcontent-%COMP%]{color:var(--text-secondary);margin-bottom:15px;min-height:40px}.identity-meta[_ngcontent-%COMP%]{font-size:.9rem;margin:5px 0;color:var(--text-secondary)}.private-key-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--success-color);margin-top:10px}.private-key-indicator[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:5px;font-size:1rem;height:1rem;width:1rem}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 0;text-align:center}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:5rem;height:5rem;width:5rem;margin-bottom:20px;color:var(--text-secondary)}.empty-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:10px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:20px;color:var(--text-secondary)}.profile-picture[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:50%;object-fit:cover}@media (max-width: 768px){.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.actions-section[_ngcontent-%COMP%]{margin-top:15px;width:100%}.identities-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};export{Ie as IdentitiesComponent};
