import{i as Gt}from"./chunk-D6JINR2S.js";import{a as At,b as Rt,ba as Ot,d as M,e as jt,f as St,ga as _t,m as Mt}from"./chunk-OXWMXC6C.js";var $t=M(D=>{"use strict";var dt=function(e,t){return t||(t={}),e.split("").forEach(function(n,r){n in t||(t[n]=r)}),t},N={alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",charmap:{0:14,1:8}};N.charmap=dt(N.alphabet,N.charmap);var ct={alphabet:"0123456789ABCDEFGHJKMNPQRSTVWXYZ",charmap:{O:0,I:1,L:1}};ct.charmap=dt(ct.alphabet,ct.charmap);var at={alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",charmap:{}};at.charmap=dt(at.alphabet,at.charmap);function X(e){if(this.buf=[],this.shift=8,this.carry=0,e){switch(e.type){case"rfc4648":this.charmap=D.rfc4648.charmap;break;case"crockford":this.charmap=D.crockford.charmap;break;case"base32hex":this.charmap=D.base32hex.charmap;break;default:throw new Error("invalid type")}e.charmap&&(this.charmap=e.charmap)}}X.prototype.charmap=N.charmap;X.prototype.write=function(e){var t=this.charmap,n=this.buf,r=this.shift,o=this.carry;return e.toUpperCase().split("").forEach(function(s){if(s!="="){var i=t[s]&255;r-=5,r>0?o|=i<<r:r<0?(n.push(o|i>>-r),r+=8,o=i<<r&255):(n.push(o|i),r=8,o=0)}}),this.shift=r,this.carry=o,this};X.prototype.finalize=function(e){return e&&this.write(e),this.shift!==8&&this.carry!==0&&(this.buf.push(this.carry),this.shift=8,this.carry=0),this.buf};function W(e){if(this.buf="",this.shift=3,this.carry=0,e){switch(e.type){case"rfc4648":this.alphabet=D.rfc4648.alphabet;break;case"crockford":this.alphabet=D.crockford.alphabet;break;case"base32hex":this.alphabet=D.base32hex.alphabet;break;default:throw new Error("invalid type")}e.alphabet?this.alphabet=e.alphabet:e.lc&&(this.alphabet=this.alphabet.toLowerCase())}}W.prototype.alphabet=N.alphabet;W.prototype.write=function(e){var t=this.shift,n=this.carry,r,o,s;for(s=0;s<e.length;s++)o=e[s],r=n|o>>t,this.buf+=this.alphabet[r&31],t>5&&(t-=5,r=o>>t,this.buf+=this.alphabet[r&31]),t=5-t,n=o<<t,t=8-t;return this.shift=t,this.carry=n,this};W.prototype.finalize=function(e){return e&&this.write(e),this.shift!==3&&(this.buf+=this.alphabet[this.carry&31],this.shift=3,this.carry=0),this.buf};D.encode=function(e,t){return new W(t).finalize(e)};D.decode=function(e,t){return new X(t).finalize(e)};D.Decoder=X;D.Encoder=W;D.charmap=dt;D.crockford=ct;D.rfc4648=N;D.base32hex=at});var Zt=M((Jn,qt)=>{"use strict";function He(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var r=0;r<e.length;r++){var o=e.charAt(r),s=o.charCodeAt(0);if(t[s]!==255)throw new TypeError(o+" is ambiguous");t[s]=r}var i=e.length,c=e.charAt(0),f=Math.log(i)/Math.log(256),l=Math.log(256)/Math.log(i);function x(h){if(h instanceof Uint8Array||(ArrayBuffer.isView(h)?h=new Uint8Array(h.buffer,h.byteOffset,h.byteLength):Array.isArray(h)&&(h=Uint8Array.from(h))),!(h instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(h.length===0)return"";for(var y=0,m=0,g=0,w=h.length;g!==w&&h[g]===0;)g++,y++;for(var A=(w-g)*l+1>>>0,b=new Uint8Array(A);g!==w;){for(var v=h[g],S=0,E=A-1;(v!==0||S<m)&&E!==-1;E--,S++)v+=256*b[E]>>>0,b[E]=v%i>>>0,v=v/i>>>0;if(v!==0)throw new Error("Non-zero carry");m=S,g++}for(var L=A-m;L!==A&&b[L]===0;)L++;for(var H=c.repeat(y);L<A;++L)H+=e.charAt(b[L]);return H}function a(h){if(typeof h!="string")throw new TypeError("Expected String");if(h.length===0)return new Uint8Array;var y=0;if(h[y]!==" "){for(var m=0,g=0;h[y]===c;)m++,y++;for(var w=(h.length-y)*f+1>>>0,A=new Uint8Array(w);h[y];){var b=t[h.charCodeAt(y)];if(b===255)return;for(var v=0,S=w-1;(b!==0||v<g)&&S!==-1;S--,v++)b+=i*A[S]>>>0,A[S]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");g=v,y++}if(h[y]!==" "){for(var E=w-g;E!==w&&A[E]===0;)E++;for(var L=new Uint8Array(m+(w-E)),H=m;E!==w;)L[H++]=A[E++];return L}}}function p(h){var y=a(h);if(y)return y;throw new Error("Non-base"+i+" character")}return{encode:x,decodeUnsafe:a,decode:p}}qt.exports=He});var lt=M((Qn,Xt)=>{"use strict";var Te=new TextDecoder,ke=e=>Te.decode(e),Pe=new TextEncoder,Ce=e=>Pe.encode(e);function Fe(e,t){let n=new Uint8Array(t),r=0;for(let o of e)n.set(o,r),r+=o.length;return n}Xt.exports={decodeText:ke,encodeText:Ce,concat:Fe}});var Yt=M((tr,Wt)=>{"use strict";var{encodeText:Ve}=lt(),Ut=class{constructor(t,n,r,o){this.name=t,this.code=n,this.codeBuf=Ve(this.code),this.alphabet=o,this.codec=r(o)}encode(t){return this.codec.encode(t)}decode(t){for(let n of t)if(this.alphabet&&this.alphabet.indexOf(n)<0)throw new Error(`invalid character '${n}' in '${t}'`);return this.codec.decode(t)}};Wt.exports=Ut});var Qt=M((er,Jt)=>{"use strict";var Re=(e,t,n)=>{let r={};for(let l=0;l<t.length;++l)r[t[l]]=l;let o=e.length;for(;e[o-1]==="=";)--o;let s=new Uint8Array(o*n/8|0),i=0,c=0,f=0;for(let l=0;l<o;++l){let x=r[e[l]];if(x===void 0)throw new SyntaxError("Invalid character "+e[l]);c=c<<n|x,i+=n,i>=8&&(i-=8,s[f++]=255&c>>i)}if(i>=n||255&c<<8-i)throw new SyntaxError("Unexpected end of data");return s},je=(e,t,n)=>{let r=t[t.length-1]==="=",o=(1<<n)-1,s="",i=0,c=0;for(let f=0;f<e.length;++f)for(c=c<<8|e[f],i+=8;i>n;)i-=n,s+=t[o&c>>i];if(i&&(s+=t[o&c<<n-i]),r)for(;s.length*n&7;)s+="=";return s},Me=e=>t=>({encode(n){return je(n,t,e)},decode(n){return Re(n,t,e)}});Jt.exports={rfc4648:Me}});var re=M((nr,ne)=>{"use strict";var J=Zt(),Oe=Yt(),{rfc4648:I}=Qt(),{decodeText:_e,encodeText:Ge}=lt(),ze=()=>({encode:_e,decode:Ge}),te=[["identity","\0",ze,""],["base2","0",I(1),"01"],["base8","7",I(3),"01234567"],["base10","9",J,"0123456789"],["base16","f",I(4),"0123456789abcdef"],["base16upper","F",I(4),"0123456789ABCDEF"],["base32hex","v",I(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",I(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",I(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",I(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",I(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",I(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",I(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",I(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",I(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",J,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",J,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",J,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",J,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",I(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",I(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",I(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",I(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],ee=te.reduce((e,t)=>(e[t[0]]=new Oe(t[0],t[1],t[2],t[3]),e),{}),$e=te.reduce((e,t)=>(e[t[1]]=ee[t[0]],e),{});ne.exports={names:ee,codes:$e}});var se=M((P,ie)=>{"use strict";var q=re(),{encodeText:Ne,decodeText:ut,concat:oe}=lt();function qe(e,t){if(!t)throw new Error("requires an encoded Uint8Array");let{name:n,codeBuf:r}=G(e);return Ye(n,t),oe([r,t],r.length+t.length)}function Ze(e,t){let n=G(e),r=Ne(n.encode(t));return oe([n.codeBuf,r],n.codeBuf.length+r.length)}function Xe(e){e instanceof Uint8Array&&(e=ut(e));let t=e[0];return["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(t)&&(e=e.toLowerCase()),G(e[0]).decode(e.substring(1))}function We(e){if(e instanceof Uint8Array&&(e=ut(e)),Object.prototype.toString.call(e)!=="[object String]")return!1;try{return G(e[0]).name}catch{return!1}}function Ye(e,t){G(e).decode(ut(t))}function G(e){if(Object.prototype.hasOwnProperty.call(q.names,e))return q.names[e];if(Object.prototype.hasOwnProperty.call(q.codes,e))return q.codes[e];throw new Error(`Unsupported encoding: ${e}`)}function Je(e){return e instanceof Uint8Array&&(e=ut(e)),G(e[0])}P=ie.exports=qe;P.encode=Ze;P.decode=Xe;P.isEncoded=We;P.encoding=G;P.encodingFromData=Je;var Qe=Object.freeze(q.names),tn=Object.freeze(q.codes);P.names=Qe;P.codes=tn});var Ie=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Et={randomUUID:Ie};var st,Ue=new Uint8Array(16);function Bt(){if(!st&&(st=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!st))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return st(Ue)}var B=[];for(let e=0;e<256;++e)B.push((e+256).toString(16).slice(1));function zt(e,t=0){return B[e[t+0]]+B[e[t+1]]+B[e[t+2]]+B[e[t+3]]+"-"+B[e[t+4]]+B[e[t+5]]+"-"+B[e[t+6]]+B[e[t+7]]+"-"+B[e[t+8]]+B[e[t+9]]+"-"+B[e[t+10]]+B[e[t+11]]+B[e[t+12]]+B[e[t+13]]+B[e[t+14]]+B[e[t+15]]}function Ke(e,t,n){if(Et.randomUUID&&!t&&!e)return Et.randomUUID();e=e||{};let r=e.random||(e.rng||Bt)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){n=n||0;for(let o=0;o<16;++o)t[n+o]=r[o];return t}return zt(r)}var It=Ke;var ft=jt($t(),1);function Le(e,t){if(e.length!==t.length)return!1;if(e.length===0)return!0;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0}var ht={ed25519PublicKey:48,ed25519SecretSeed:144,med25519PublicKey:96,preAuthTx:152,sha256Hash:184,signedPayload:120,contract:16},De={G:"ed25519PublicKey",S:"ed25519SecretSeed",M:"med25519PublicKey",T:"preAuthTx",X:"sha256Hash",P:"signedPayload",C:"contract"},_=class{static encodeEd25519PublicKey(t){return O("ed25519PublicKey",t)}static decodeEd25519PublicKey(t){return F("ed25519PublicKey",t)}static isValidEd25519PublicKey(t){return Y("ed25519PublicKey",t)}static encodeEd25519SecretSeed(t){return O("ed25519SecretSeed",t)}static decodeEd25519SecretSeed(t){return F("ed25519SecretSeed",t)}static isValidEd25519SecretSeed(t){return Y("ed25519SecretSeed",t)}static encodeMed25519PublicKey(t){return O("med25519PublicKey",t)}static decodeMed25519PublicKey(t){return F("med25519PublicKey",t)}static isValidMed25519PublicKey(t){return Y("med25519PublicKey",t)}static encodePreAuthTx(t){return O("preAuthTx",t)}static decodePreAuthTx(t){return F("preAuthTx",t)}static encodeSha256Hash(t){return O("sha256Hash",t)}static decodeSha256Hash(t){return F("sha256Hash",t)}static encodeSignedPayload(t){return O("signedPayload",t)}static decodeSignedPayload(t){return F("signedPayload",t)}static isValidSignedPayload(t){return Y("signedPayload",t)}static encodeContract(t){return O("contract",t)}static decodeContract(t){return F("contract",t)}static isValidContract(t){return Y("contract",t)}static getVersionByteForPrefix(t){return De[t[0]]}};function Y(e,t){if(typeof t!="string")return!1;switch(e){case"ed25519PublicKey":case"ed25519SecretSeed":case"preAuthTx":case"sha256Hash":case"contract":if(t.length!==56)return!1;break;case"med25519PublicKey":if(t.length!==69)return!1;break;case"signedPayload":if(t.length<56||t.length>165)return!1;break;default:return!1}let n="";try{n=F(e,t)}catch{return!1}switch(e){case"ed25519PublicKey":case"ed25519SecretSeed":case"preAuthTx":case"sha256Hash":case"contract":return n.length===32;case"med25519PublicKey":return n.length===40;case"signedPayload":return n.length>=40&&n.length<=100;default:return!1}}function F(e,t){if(typeof t!="string")throw new TypeError("encoded argument must be of type String");let n=ft.default.decode(t),r=n[0],o=n.slice(0,-2),s=o.slice(1),i=n.slice(-2);if(t!==ft.default.encode(n))throw new Error("invalid encoded string");let c=ht[e];if(c===void 0)throw new Error(`${e} is not a valid version byte name. Expected one of ${Object.keys(ht).join(", ")}`);if(r!==c)throw new Error(`invalid version byte. expected ${c}, got ${r}`);let f=Nt(o);if(!Le(f,i))throw new Error("invalid checksum");return new Uint8Array(s)}function O(e,t){if(t==null)throw new Error("cannot encode null data");let n=ht[e];if(n===void 0)throw new Error(`${e} is not a valid version byte name. Expected one of ${Object.keys(ht).join(", ")}`);t=new Uint8Array(t);let r=new Uint8Array([n]),o=new Uint8Array(r.length+t.length);o.set(r,0),o.set(t,r.length);let s=new Uint8Array(Nt(o)),i=new Uint8Array(o.length+s.length);return i.set(o,0),i.set(s,o.length),ft.default.encode(i)}function Nt(e){let t=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920],n=0;for(let o=0;o<e.length;o+=1){let s=e[o],i=n>>8^s;n=n<<8^t[i],n&=65535}let r=new Uint8Array(2);return r[0]=n&255,r[1]=n>>8&255,r}var Se=jt(se(),1);var U=2n**255n-19n,tt=2n**252n+27742317777372353535851937790883648493n,Kt=0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51an,Lt=0x6666666666666666666666666666666666666666666666666666666666666658n,en=37095705934669439343138083508754565189542113879843219016388785533085940283555n,xt={a:-1n,d:en,p:U,n:tt,h:8,Gx:Kt,Gy:Lt},K=(e="")=>{throw new Error(e)},ue=e=>typeof e=="string",nn=e=>e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array",nt=(e,t)=>!nn(e)||typeof t=="number"&&t>0&&e.length!==t?K("Uint8Array of valid length expected"):e,Z=e=>new Uint8Array(e),xe=(e,t)=>nt(ue(e)?Ht(e):Z(nt(e)),t),d=(e,t=U)=>{let n=e%t;return n>=0n?n:t+n},ce=e=>e instanceof V?e:K("Point expected"),V=class e{constructor(t,n,r,o){this.ex=t,this.ey=n,this.ez=r,this.et=o}static fromAffine(t){return new e(t.x,t.y,1n,d(t.x*t.y))}static fromHex(t,n=!1){let{d:r}=xt;t=xe(t,32);let o=t.slice(),s=t[31];o[31]=s&-129;let i=pe(o);n&&!(0n<=i&&i<2n**256n)&&K("bad y coord 1"),!n&&!(0n<=i&&i<U)&&K("bad y coord 2");let c=d(i*i),f=d(c-1n),l=d(r*c+1n),{isValid:x,value:a}=sn(f,l);x||K("bad y coordinate 3");let p=(a&1n)===1n,h=(s&128)!==0;return!n&&a===0n&&h&&K("bad y coord 3"),h!==p&&(a=d(-a)),new e(a,i,1n,d(a*i))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}equals(t){let{ex:n,ey:r,ez:o}=this,{ex:s,ey:i,ez:c}=ce(t),f=d(n*c),l=d(s*o),x=d(r*c),a=d(i*o);return f===l&&x===a}is0(){return this.equals(Q)}negate(){return new e(d(-this.ex),this.ey,this.ez,d(-this.et))}double(){let{ex:t,ey:n,ez:r}=this,{a:o}=xt,s=d(t*t),i=d(n*n),c=d(2n*d(r*r)),f=d(o*s),l=t+n,x=d(d(l*l)-s-i),a=f+i,p=a-c,h=f-i,y=d(x*p),m=d(a*h),g=d(x*h),w=d(p*a);return new e(y,m,w,g)}add(t){let{ex:n,ey:r,ez:o,et:s}=this,{ex:i,ey:c,ez:f,et:l}=ce(t),{a:x,d:a}=xt,p=d(n*i),h=d(r*c),y=d(s*a*l),m=d(o*f),g=d((n+r)*(i+c)-p-h),w=d(m-y),A=d(m+y),b=d(h-x*p),v=d(g*w),S=d(A*b),E=d(g*b),L=d(w*A);return new e(v,S,L,E)}mul(t,n=!0){if(t===0n)return n===!0?K("cannot multiply by 0"):Q;if(typeof t=="bigint"&&0n<t&&t<tt||K("invalid scalar, must be < L"),!n&&this.is0()||t===1n)return this;if(this.equals(rt))return ln(t).p;let r=Q,o=rt;for(let s=this;t>0n;s=s.double(),t>>=1n)t&1n?r=r.add(s):n&&(o=o.add(s));return r}multiply(t){return this.mul(t)}clearCofactor(){return this.mul(BigInt(xt.h),!1)}isSmallOrder(){return this.clearCofactor().is0()}isTorsionFree(){let t=this.mul(tt/2n,!1).double();return tt%2n&&(t=t.add(this)),t.is0()}toAffine(){let{ex:t,ey:n,ez:r}=this;if(this.equals(Q))return{x:0n,y:1n};let o=ye(r,U);return d(r*o)!==1n&&K("invalid inverse"),{x:d(t*o),y:d(n*o)}}toRawBytes(){let{x:t,y:n}=this.toAffine(),r=rn(n);return r[31]|=t&1n?128:0,r}toHex(){return Dt(this.toRawBytes())}};V.BASE=new V(Kt,Lt,1n,d(Kt*Lt));V.ZERO=new V(0n,1n,1n,0n);var{BASE:rt,ZERO:Q}=V,be=(e,t)=>e.toString(16).padStart(t,"0"),Dt=e=>Array.from(nt(e)).map(t=>be(t,2)).join(""),C={_0:48,_9:57,A:65,F:70,a:97,f:102},ae=e=>{if(e>=C._0&&e<=C._9)return e-C._0;if(e>=C.A&&e<=C.F)return e-(C.A-10);if(e>=C.a&&e<=C.f)return e-(C.a-10)},Ht=e=>{let t="hex invalid";if(!ue(e))return K(t);let n=e.length,r=n/2;if(n%2)return K(t);let o=Z(r);for(let s=0,i=0;s<r;s++,i+=2){let c=ae(e.charCodeAt(i)),f=ae(e.charCodeAt(i+1));if(c===void 0||f===void 0)return K(t);o[s]=c*16+f}return o},rn=e=>Ht(be(e,32*2)).reverse(),pe=e=>BigInt("0x"+Dt(Z(nt(e)).reverse())),de=(...e)=>{let t=Z(e.reduce((r,o)=>r+nt(o).length,0)),n=0;return e.forEach(r=>{t.set(r,n),n+=r.length}),t},ye=(e,t)=>{(e===0n||t<=0n)&&K("no inverse n="+e+" mod="+t);let n=d(e,t),r=t,o=0n,s=1n,i=1n,c=0n;for(;n!==0n;){let f=r/n,l=r%n,x=o-i*f,a=s-c*f;r=n,n=l,o=i,s=c,i=x,c=a}return r===1n?d(o,t):K("no inverse")},T=(e,t)=>{let n=e;for(;t-- >0n;)n*=n,n%=U;return n},on=e=>{let n=e*e%U*e%U,r=T(n,2n)*n%U,o=T(r,1n)*e%U,s=T(o,5n)*o%U,i=T(s,10n)*s%U,c=T(i,20n)*i%U,f=T(c,40n)*c%U,l=T(f,80n)*f%U,x=T(l,80n)*f%U,a=T(x,10n)*s%U;return{pow_p_5_8:T(a,2n)*e%U,b2:n}},fe=19681161376707505956807079304988542015446066515923890162744021073123829784752n,sn=(e,t)=>{let n=d(t*t*t),r=d(n*n*t),o=on(e*r).pow_p_5_8,s=d(e*n*o),i=d(t*s*s),c=s,f=d(s*fe),l=i===e,x=i===d(-e),a=i===d(-e*fe);return l&&(s=c),(x||a)&&(s=f),(d(s)&1n)===1n&&(s=d(-s)),{isValid:l||x,value:s}},cn=e=>d(pe(e),tt),et;var an=(...e)=>typeof et=="function"?et(...e):K("etc.sha512Sync not set"),dn=e=>{let t=e.slice(0,32);t[0]&=248,t[31]&=127,t[31]|=64;let n=e.slice(32,64),r=cn(t),o=rt.mul(r),s=o.toRawBytes();return{head:t,prefix:n,scalar:r,point:o,pointBytes:s}};var fn=e=>dn(an(xe(e,32)));var ge=e=>fn(e).pointBytes;var he=()=>typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0,bt={bytesToHex:Dt,hexToBytes:Ht,concatBytes:de,mod:d,invert:ye,randomBytes:(e=32)=>{let t=he();return(!t||!t.getRandomValues)&&K("crypto.getRandomValues must be defined"),t.getRandomValues(Z(e))},sha512Async:(...e)=>St(void 0,null,function*(){let t=he(),n=t&&t.subtle;n||K("etc.sha512Async or crypto.subtle must be defined");let r=de(...e);return Z(yield n.digest("SHA-512",r.buffer))}),sha512Sync:void 0};Object.defineProperties(bt,{sha512Sync:{configurable:!1,get(){return et},set(e){et||(et=e)}}});var z=8,hn=()=>{let e=[],t=256/z+1,n=rt,r=n;for(let o=0;o<t;o++){r=n,e.push(r);for(let s=1;s<2**(z-1);s++)r=r.add(n),e.push(r);n=r.double()}return e},le,ln=e=>{let t=le||(le=hn()),n=(x,a)=>{let p=a.negate();return x?p:a},r=Q,o=rt,s=1+256/z,i=2**(z-1),c=BigInt(2**z-1),f=2**z,l=BigInt(z);for(let x=0;x<s;x++){let a=x*i,p=Number(e&c);e>>=l,p>i&&(p-=f,e+=1n);let h=a,y=a+Math.abs(p)-1,m=x%2!==0,g=p<0;p===0?o=o.add(n(m,t[h])):r=r.add(n(g,t[y]))}return{p:r,f:o}};function xn(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Tt(e,...t){if(!xn(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function kt(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function me(e,t){Tt(e);let n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function yt(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function bn(e){if(typeof e!="string")throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}function Pt(e){return typeof e=="string"&&(e=bn(e)),Tt(e),e}var pt=class{clone(){return this._cloneInto()}};function we(e){let t=r=>e().update(Pt(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function pn(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),c=Number(n&s),f=r?4:0,l=r?0:4;e.setUint32(t+f,i,r),e.setUint32(t+l,c,r)}var gt=class extends pt{constructor(t,n,r,o){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=yt(this.buffer)}update(t){kt(this);let{view:n,buffer:r,blockLen:o}=this;t=Pt(t);let s=t.length;for(let i=0;i<s;){let c=Math.min(o-this.pos,s-i);if(c===o){let f=yt(t);for(;o<=s-i;i+=o)this.process(f,i);continue}r.set(t.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){kt(this),me(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:o,isLE:s}=this,{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>o-i&&(this.process(r,0),i=0);for(let a=i;a<o;a++)n[a]=0;pn(r,o-8,BigInt(this.length*8),s),this.process(r,0);let c=yt(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=f/4,x=this.get();if(l>x.length)throw new Error("_sha2: outputLen bigger than state");for(let a=0;a<l;a++)c.setUint32(4*a,x[a],s)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:n,buffer:r,length:o,finished:s,destroyed:i,pos:c}=this;return t.length=o,t.pos=c,t.finished=s,t.destroyed=i,o%n&&t.buffer.set(r),t}};var mt=BigInt(4294967295),Ct=BigInt(32);function ve(e,t=!1){return t?{h:Number(e&mt),l:Number(e>>Ct&mt)}:{h:Number(e>>Ct&mt)|0,l:Number(e&mt)|0}}function yn(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let o=0;o<e.length;o++){let{h:s,l:i}=ve(e[o],t);[n[o],r[o]]=[s,i]}return[n,r]}var gn=(e,t)=>BigInt(e>>>0)<<Ct|BigInt(t>>>0),mn=(e,t,n)=>e>>>n,wn=(e,t,n)=>e<<32-n|t>>>n,vn=(e,t,n)=>e>>>n|t<<32-n,An=(e,t,n)=>e<<32-n|t>>>n,Sn=(e,t,n)=>e<<64-n|t>>>n-32,En=(e,t,n)=>e>>>n-32|t<<64-n,Bn=(e,t)=>t,In=(e,t)=>e,Un=(e,t,n)=>e<<n|t>>>32-n,Kn=(e,t,n)=>t<<n|e>>>32-n,Ln=(e,t,n)=>t<<n-32|e>>>64-n,Dn=(e,t,n)=>e<<n-32|t>>>64-n;function Hn(e,t,n,r){let o=(t>>>0)+(r>>>0);return{h:e+n+(o/2**32|0)|0,l:o|0}}var Tn=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),kn=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,Pn=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),Cn=(e,t,n,r,o)=>t+n+r+o+(e/2**32|0)|0,Fn=(e,t,n,r,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(o>>>0),Vn=(e,t,n,r,o,s)=>t+n+r+o+s+(e/2**32|0)|0;var Rn={fromBig:ve,split:yn,toBig:gn,shrSH:mn,shrSL:wn,rotrSH:vn,rotrSL:An,rotrBH:Sn,rotrBL:En,rotr32H:Bn,rotr32L:In,rotlSH:Un,rotlSL:Kn,rotlBH:Ln,rotlBL:Dn,add:Hn,add3L:Tn,add3H:kn,add4L:Pn,add4H:Cn,add5H:Vn,add5L:Fn},u=Rn;var[jn,Mn]=u.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),R=new Uint32Array(80),j=new Uint32Array(80),Ft=class extends gt{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:n,Bh:r,Bl:o,Ch:s,Cl:i,Dh:c,Dl:f,Eh:l,El:x,Fh:a,Fl:p,Gh:h,Gl:y,Hh:m,Hl:g}=this;return[t,n,r,o,s,i,c,f,l,x,a,p,h,y,m,g]}set(t,n,r,o,s,i,c,f,l,x,a,p,h,y,m,g){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=o|0,this.Ch=s|0,this.Cl=i|0,this.Dh=c|0,this.Dl=f|0,this.Eh=l|0,this.El=x|0,this.Fh=a|0,this.Fl=p|0,this.Gh=h|0,this.Gl=y|0,this.Hh=m|0,this.Hl=g|0}process(t,n){for(let b=0;b<16;b++,n+=4)R[b]=t.getUint32(n),j[b]=t.getUint32(n+=4);for(let b=16;b<80;b++){let v=R[b-15]|0,S=j[b-15]|0,E=u.rotrSH(v,S,1)^u.rotrSH(v,S,8)^u.shrSH(v,S,7),L=u.rotrSL(v,S,1)^u.rotrSL(v,S,8)^u.shrSL(v,S,7),H=R[b-2]|0,k=j[b-2]|0,ot=u.rotrSH(H,k,19)^u.rotrBH(H,k,61)^u.shrSH(H,k,6),wt=u.rotrSL(H,k,19)^u.rotrBL(H,k,61)^u.shrSL(H,k,6),it=u.add4L(L,wt,j[b-7],j[b-16]),vt=u.add4H(it,E,ot,R[b-7],R[b-16]);R[b]=vt|0,j[b]=it|0}let{Ah:r,Al:o,Bh:s,Bl:i,Ch:c,Cl:f,Dh:l,Dl:x,Eh:a,El:p,Fh:h,Fl:y,Gh:m,Gl:g,Hh:w,Hl:A}=this;for(let b=0;b<80;b++){let v=u.rotrSH(a,p,14)^u.rotrSH(a,p,18)^u.rotrBH(a,p,41),S=u.rotrSL(a,p,14)^u.rotrSL(a,p,18)^u.rotrBL(a,p,41),E=a&h^~a&m,L=p&y^~p&g,H=u.add5L(A,S,L,Mn[b],j[b]),k=u.add5H(H,w,v,E,jn[b],R[b]),ot=H|0,wt=u.rotrSH(r,o,28)^u.rotrBH(r,o,34)^u.rotrBH(r,o,39),it=u.rotrSL(r,o,28)^u.rotrBL(r,o,34)^u.rotrBL(r,o,39),vt=r&s^r&c^s&c,Be=o&i^o&f^i&f;w=m|0,A=g|0,m=h|0,g=y|0,h=a|0,y=p|0,{h:a,l:p}=u.add(l|0,x|0,k|0,ot|0),l=c|0,x=f|0,c=s|0,f=i|0,s=r|0,i=o|0;let Vt=u.add3L(ot,it,Be);r=u.add3H(Vt,k,wt,vt),o=Vt|0}({h:r,l:o}=u.add(this.Ah|0,this.Al|0,r|0,o|0)),{h:s,l:i}=u.add(this.Bh|0,this.Bl|0,s|0,i|0),{h:c,l:f}=u.add(this.Ch|0,this.Cl|0,c|0,f|0),{h:l,l:x}=u.add(this.Dh|0,this.Dl|0,l|0,x|0),{h:a,l:p}=u.add(this.Eh|0,this.El|0,a|0,p|0),{h,l:y}=u.add(this.Fh|0,this.Fl|0,h|0,y|0),{h:m,l:g}=u.add(this.Gh|0,this.Gl|0,m|0,g|0),{h:w,l:A}=u.add(this.Hh|0,this.Hl|0,w|0,A|0),this.set(r,o,s,i,c,f,l,x,a,p,h,y,m,g,w,A)}roundClean(){R.fill(0),j.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var Ae=we(()=>new Ft);bt.sha512Sync=(...e)=>Ae(bt.concatBytes(...e));var $=class e{static publicKeyToMultibase(t){let n=new Uint8Array([0,...t]),r=Se.encode("base58btc",n);return new TextDecoder().decode(r)}static resolve(t){let n=e.getDocument(t);return{didResolutionMetadata:{contentType:"application/did+ld+json",retrieved:new Date().toISOString()},didDocument:n,didDocumentMetadata:{}}}static fromPublicKey(t){let n=`did:stellar:${t}`;return e.getDocument(n)}static fromPrivateKey(t){let r=`did:stellar:${e.getPublicKey(t)}`;return e.getDocument(r)}static getPublicKey(t){let n=_.decodeEd25519SecretSeed(t),r=ge(n);return _.encodeEd25519PublicKey(r)}static getDocument(t){let n=`${t}#0`,r=t.split(":")[2],o=_.decodeEd25519PublicKey(r),s=e.publicKeyToMultibase(o),i=`{
            "@context": [
              "https://www.w3.org/ns/did/v1",
              "https://w3id.org/security/suites/ed25519-2020/v1"
            ],
            "id": "${t}",
            "verificationMethod": [
              {
                "id": "${n}",
                "type": "Ed25519VerificationKey2020",
                "controller": "${t}",
                "publicKeyMultibase": "${s}"
              }
            ],
            "authentication": [
              "${n}"
            ],
            "assertionMethod": [
              "${n}"
            ],
            "capabilityDelegation": [
              "${n}"
            ],
            "capabilityInvocation": [
              "${n}"
            ],
            "keyAgreement": [
              "${n}"
            ]
          }`;return JSON.parse(i)}};var Ee=class e{constructor(t){this.storageService=t;this.loadIdentities()}storageKey="identity-workbench-identities";identitiesSubject=new Mt([]);identities$=this.identitiesSubject.asObservable();loadIdentities(){let t=this.storageService.get(this.storageKey)||[];this.identitiesSubject.next(t)}saveIdentities(t){this.storageService.set(this.storageKey,t),this.identitiesSubject.next(t)}getAllIdentities(){return this.identities$}getIdentityById(t){return this.identitiesSubject.value.find(r=>r.id===t)}addIdentity(t){let n=new Date,r={id:t.id||`did:key:${It()}`,method:t.method||"key",publicKey:t.publicKey||"",privateKey:t.privateKey,name:t.name||`Identity ${this.identitiesSubject.value.length+1}`,description:t.description,created:n,updated:n,didDocument:t.didDocument},o=[...this.identitiesSubject.value,r];return this.saveIdentities(o),r}updateIdentity(t,n){let r=this.identitiesSubject.value,o=r.findIndex(c=>c.id===t);if(o===-1)throw new Error(`Identity with id ${t} not found`);let s=Rt(At(At({},r[o]),n),{updated:new Date}),i=[...r.slice(0,o),s,...r.slice(o+1)];return this.saveIdentities(i),s}deleteIdentity(t){let r=this.identitiesSubject.value.filter(o=>o.id!==t);this.saveIdentities(r)}importFromDIDString(t){if(!t.startsWith("did:"))return null;try{let n=t.split(":");if(n.length<3)return null;let r=n[1];if(r==="stellar"){let o=$.resolve(t);return this.addIdentity({id:t,method:"stellar",publicKey:n[2],name:"Imported Stellar DID",description:`Imported on ${new Date().toLocaleString()}`,didDocument:o})}return this.addIdentity({id:t,method:r,publicKey:n.slice(2).join(":"),name:`Imported ${r.toUpperCase()} DID`,description:`Imported on ${new Date().toLocaleString()}`})}catch(n){return console.error("Error importing DID string:",n),null}}importFromStellarKey(t,n=!1){try{if(!t||t.length<16)return null;let r,o,s,i;return n?(r=$.fromPrivateKey(t),i=r.id,o=i.split(":")[2],s=t):(r=$.fromPublicKey(t),i=r.id,o=t),this.addIdentity({id:i,method:"stellar",publicKey:o,privateKey:s,name:`Imported Stellar ${n?"Private":"Public"} Key`,description:`Imported on ${new Date().toLocaleString()}`,didDocument:r})}catch(r){return console.error("Error importing Stellar key:",r),null}}importFromJsonFile(t){if(!t||!t.id||!t.id.startsWith("did:"))return null;let n=t.id.split(":");if(n.length<3)return null;let r="";if(t.verificationMethod&&t.verificationMethod.length>0){for(let o of t.verificationMethod)if((o.type==="Ed25519VerificationKey2018"||o.type==="Ed25519VerificationKey2020")&&o.publicKeyBase58){r=o.publicKeyBase58;break}}return this.addIdentity({id:t.id,method:n[1],publicKey:r,name:`Imported ${n[1].toUpperCase()} DID Document`,description:`Imported on ${new Date().toLocaleString()}`,didDocument:t})}static \u0275fac=function(n){return new(n||e)(_t(Gt))};static \u0275prov=Ot({token:e,factory:e.\u0275fac,providedIn:"root"})};export{It as a,Ee as b};
